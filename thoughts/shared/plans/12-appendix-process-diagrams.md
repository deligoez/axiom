# Chorus Process Diagrams (Appendix)

**Module:** 12-appendix-process-diagrams.md
**Parent:** [00-index.md](./00-index.md)
**Purpose:** Comprehensive visual diagrams of all Chorus processes

---

## Table of Contents

1. [End-to-End Lifecycle](#1-end-to-end-chorus-lifecycle)
2. [App Routing & Mode Detection](#2-app-routing--mode-detection)
3. [Planning Dialogue Flow](#3-planning-dialogue-flow)
4. [Task Lifecycle](#4-task-lifecycle)
5. [Agent Spawn & Execution](#5-agent-spawn--execution-flow)
6. [Ralph Loop (Autopilot)](#6-ralph-loop-autopilot)
7. [Merge Service](#7-merge-service-flow)
8. [Memory & Learning System](#8-memory--learning-system)
9. [Review System](#9-review-system-flow)
10. [Intervention & Rollback](#10-intervention--rollback)
11. [Agent Persona Interactions](#11-agent-persona-interactions)
12. [Event Flow Summary](#12-event-flow-summary)

---

## 1. End-to-End Chorus Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               CHORUS END-TO-END LIFECYCLE                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   USER RUNS
   $ chorus
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    INIT     â”‚â”€â”€â”€â”€â–¶â”‚  PLANNING   â”‚â”€â”€â”€â”€â–¶â”‚   REVIEW    â”‚â”€â”€â”€â”€â–¶â”‚  IMPLEMENTATION  â”‚
â”‚    MODE     â”‚     â”‚    MODE     â”‚     â”‚    MODE     â”‚     â”‚      MODE        â”‚
â”‚             â”‚     â”‚             â”‚     â”‚             â”‚     â”‚                  â”‚
â”‚ ğŸ” Ace      â”‚     â”‚ ğŸ“Š Pat      â”‚     â”‚ Validation  â”‚     â”‚ âš™ï¸ Ed (workers)   â”‚
â”‚ analyzes    â”‚     â”‚ generates   â”‚     â”‚ Ralph Loop  â”‚     â”‚ execute tasks    â”‚
â”‚ project     â”‚     â”‚ tasks       â”‚     â”‚ fixes tasks â”‚     â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                      â”‚
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚                            â”‚                    â”‚
                                         â–¼                            â–¼                    â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚   MERGE     â”‚              â”‚   MEMORY    â”‚      â”‚  REVIEW   â”‚
                                  â”‚   QUEUE     â”‚              â”‚   SYSTEM    â”‚      â”‚  (HITL)   â”‚
                                  â”‚             â”‚              â”‚             â”‚      â”‚           â”‚
                                  â”‚ ğŸ”§ Finn     â”‚              â”‚ ğŸ’¡ Lou      â”‚      â”‚ Human     â”‚
                                  â”‚ resolves    â”‚              â”‚ extracts    â”‚      â”‚ approves  â”‚
                                  â”‚ conflicts   â”‚              â”‚ learnings   â”‚      â”‚ or redo   â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚                            â”‚                    â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                      â”‚
                                                                      â–¼
                                                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                               â”‚  COMPLETE   â”‚
                                                               â”‚             â”‚
                                                               â”‚ All tasks   â”‚
                                                               â”‚ merged to   â”‚
                                                               â”‚ main branch â”‚
                                                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   SUPPORTING SYSTEMS (always running):
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                                           â”‚
   â”‚  ğŸ˜ Dan (Director)     â”‚  ğŸ‘ï¸ Will (Watcher)      â”‚  ğŸ“ˆ Carl (Counter)                    â”‚
   â”‚  XState orchestration  â”‚  Health monitoring      â”‚  Metrics & agent IDs                 â”‚
   â”‚  User interaction      â”‚  Stuck detection        â”‚  Token/cost tracking                 â”‚
   â”‚                                                                                           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. App Routing & Mode Detection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              APP ROUTING & MODE DETECTION                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  $ chorus                                 $ chorus --help
       â”‚                                        â”‚
       â–¼                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLI Parser  â”‚                          â”‚ Show help    â”‚
â”‚    (F90)    â”‚                          â”‚ and exit     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ App Router  â”‚
â”‚    (F89)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Does .chorus/ directory     â”‚
â”‚  exist?                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        No     â”‚     Yes
        â”‚      â”‚      â”‚
        â–¼      â”‚      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  INIT MODE  â”‚â”‚  â”‚  Load planning-state.json  â”‚
â”‚             â”‚â”‚  â”‚                            â”‚
â”‚ Create      â”‚â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ .chorus/    â”‚â”‚                â”‚
â”‚ directory   â”‚â”‚                â–¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚  â”‚  Check status field        â”‚
               â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                â”‚
               â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚    â”‚           â”‚           â”‚           â”‚
               â”‚    â–¼           â–¼           â–¼           â–¼
               â”‚"planning"  "reviewing"  "ready"  "implementation"
               â”‚    â”‚           â”‚           â”‚           â”‚
               â”‚    â–¼           â–¼           â–¼           â–¼
               â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚â”‚PLANNINGâ”‚ â”‚ REVIEW â”‚  â”‚ Check tasks.jsonl   â”‚
               â”‚â”‚ MODE   â”‚ â”‚  MODE  â”‚  â”‚ has tasks?          â”‚
               â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                             Yes  â”‚  No
               â”‚                              â”‚   â”‚   â”‚
               â”‚                              â–¼   â”‚   â–¼
               â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚                       â”‚IMPLEMENT â”‚ â”‚PLANNINGâ”‚
               â”‚                       â”‚  MODE    â”‚ â”‚  MODE  â”‚
               â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â””â”€â”€(after init complete)â”€â”€â–¶ PLANNING MODE
```

---

## 3. Planning Dialogue Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           PLANNING DIALOGUE MODEL (5 PHASES)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                               â”‚
â”‚  PHASE 1          PHASE 2          PHASE 3          PHASE 4          PHASE 5                â”‚
â”‚  UNDERSTAND       ANALYZE          PROPOSE          DECOMPOSE        VALIDATE               â”‚
â”‚  (Q&A)            (Explore)        (Approval)       (Generate)       (Ralph Loop)           â”‚
â”‚      â”‚                â”‚                â”‚                â”‚                â”‚                   â”‚
â”‚      â–¼                â–¼                â–¼                â–¼                â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ ğŸ“Š Pat â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ ğŸ“Š Pat â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ ğŸ“Š Pat â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ ğŸ“Š Pat â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ ğŸ“Š Pat â”‚            â”‚
â”‚  â”‚ asks   â”‚       â”‚ scans  â”‚       â”‚proposesâ”‚       â”‚ createsâ”‚       â”‚validatesâ”‚            â”‚
â”‚  â”‚ Qs     â”‚       â”‚ code   â”‚       â”‚ arch   â”‚       â”‚ tasks  â”‚       â”‚ tasks   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚      â”‚                â”‚                â”‚                â”‚                â”‚                   â”‚
â”‚      â–¼                â–¼                â–¼                â–¼                â–¼                   â”‚
â”‚  User answers     Context          User approves    Tasks saved      All valid?             â”‚
â”‚  or "you decide"  gathered         or modifies      to TaskStore         â”‚                  â”‚
â”‚                                                                      Yes â”‚  No              â”‚
â”‚                                                                          â”‚   â”‚              â”‚
â”‚                                                                          â–¼   â–¼              â”‚
â”‚                                                                      READY  Auto-fix       â”‚
â”‚                                                                          â”‚   & retry       â”‚
â”‚                                                                          â”‚      â”‚          â”‚
â”‚                                                                          â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                          â–¼                  â”‚
â”‚                                                                   MODE SELECTION           â”‚
â”‚                                                                   Semi-auto or Autopilot   â”‚
â”‚                                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PHASE DETAILS:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: UNDERSTAND                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  User Request â”€â”€â–¶ Pat analyzes â”€â”€â–¶ Ambiguities? â”€â”€â–¶ Ask questions       â”‚
â”‚                                        â”‚                                 â”‚
â”‚                                        No â”€â”€â–¶ Skip to Phase 2            â”‚
â”‚                                                                          â”‚
â”‚  User can respond:                                                       â”‚
â”‚  â€¢ Direct answer                                                        â”‚
â”‚  â€¢ "You decide" (Pat chooses)                                           â”‚
â”‚  â€¢ "Skip" (proceed without)                                             â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: ANALYZE                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Pat explores codebase:                                                  â”‚
â”‚  â”œâ”€â”€ File structure                                                     â”‚
â”‚  â”œâ”€â”€ Existing patterns                                                  â”‚
â”‚  â”œâ”€â”€ Tech stack detection                                               â”‚
â”‚  â”œâ”€â”€ Similar past work                                                  â”‚
â”‚  â”œâ”€â”€ Test patterns                                                      â”‚
â”‚  â””â”€â”€ Naming conventions                                                 â”‚
â”‚                                                                          â”‚
â”‚  Output: CodebaseContext object                                          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: PROPOSE                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Pat creates proposal:                  User actions:                    â”‚
â”‚  â”œâ”€â”€ High-level components              â”œâ”€â”€ Approve â†’ Phase 4           â”‚
â”‚  â”œâ”€â”€ Data flow diagram                  â”œâ”€â”€ Modify â†’ Pat revises        â”‚
â”‚  â”œâ”€â”€ Key decisions                      â”œâ”€â”€ Reject â†’ New proposal       â”‚
â”‚  â”œâ”€â”€ Trade-offs                         â””â”€â”€ Ask question â†’ Pat explains â”‚
â”‚  â””â”€â”€ Estimated task count                                               â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 5: VALIDATE (Ralph Loop)                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚        â”‚ Validate against rules  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚                    â”‚
â”‚                    â”‚                               â”‚                    â”‚
â”‚              Issues? No â”€â”€â–¶ ALL PASS â”€â”€â–¶ READY     â”‚                    â”‚
â”‚                    â”‚                               â”‚                    â”‚
â”‚                   Yes                              â”‚                    â”‚
â”‚                    â”‚                               â”‚                    â”‚
â”‚              Auto-fixable?                   iteration++                â”‚
â”‚                    â”‚                               â”‚                    â”‚
â”‚              Yes   â”‚   No                          â”‚                    â”‚
â”‚               â”‚    â”‚    â”‚                          â”‚                    â”‚
â”‚               â–¼    â”‚    â–¼                          â”‚                    â”‚
â”‚         Auto-fix   â”‚  Manual â”€â”€â–¶ User input        â”‚                    â”‚
â”‚               â”‚    â”‚    â”‚                          â”‚                    â”‚
â”‚               â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Task Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    TASK STATUS LIFECYCLE                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚                                          â”‚
                              â”‚                 CREATE                    â”‚
                              â”‚           (Pat generates task)            â”‚
                              â”‚                                          â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                                                â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚              TODO (â†’)                     â”‚
                              â”‚         Ready to be assigned              â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                           â”‚                           â”‚
                    â–¼                           â–¼                           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   DOING (â—)      â”‚        â”‚   LATER (â—‹)      â”‚        â”‚   STUCK (âŠ—)      â”‚
        â”‚  Agent working   â”‚        â”‚   Deferred       â”‚        â”‚   Blocked by     â”‚
        â”‚                  â”‚        â”‚   Not for now    â”‚        â”‚   dependencies   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                           â–²                           â–²
                 â”‚                           â”‚ undefer                   â”‚ deps satisfied
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                           â”‚
     â”‚           â”‚           â”‚           â”‚   â”‚                           â”‚
     â–¼           â–¼           â–¼           â–¼   â”‚                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  DONE   â”‚ â”‚ FAILED  â”‚ â”‚ TIMEOUT â”‚ â”‚ REVIEW  â”‚                          â”‚
â”‚  (âœ“)    â”‚ â”‚  (âœ—)    â”‚ â”‚  (â±)    â”‚ â”‚  (â—)    â”‚                          â”‚
â”‚Complete â”‚ â”‚ Error   â”‚ â”‚Max iter â”‚ â”‚ Awaits  â”‚                          â”‚
â”‚         â”‚ â”‚occurred â”‚ â”‚ reached â”‚ â”‚ human   â”‚                          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                          â”‚
     â”‚           â”‚           â”‚           â”‚                               â”‚
     â”‚           â”‚           â”‚           â”‚ (approve)                     â”‚
     â”‚           â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                               â”‚
     â”‚                 â”‚                 â”‚ (redo with feedback)          â”‚
     â”‚            (retry)                â”‚                               â”‚
     â”‚                 â”‚                 â–¼                               â”‚
     â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ TODO â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MERGE QUEUE                  â”‚
â”‚         (if approved or auto-approved)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STATUS INDICATORS IN TUI:

  Symbol â”‚ Status      â”‚ Color        â”‚ Description
  â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â†’    â”‚ todo        â”‚ White        â”‚ Ready to work
    â—    â”‚ doing       â”‚ Blue (pulse) â”‚ Agent working
    âœ“    â”‚ done        â”‚ Green        â”‚ Completed
    âŠ—    â”‚ stuck       â”‚ Yellow       â”‚ Has blockers
    âœ—    â”‚ failed      â”‚ Red          â”‚ Agent error
    â±    â”‚ timeout     â”‚ Orange       â”‚ Max iterations reached
    â—‹    â”‚ later       â”‚ Gray         â”‚ Deferred
    â—    â”‚ review      â”‚ Cyan         â”‚ Awaiting human review
```

---

## 5. Agent Spawn & Execution Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AGENT SPAWN & EXECUTION FLOW                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AGENT ID ASSIGNMENT (Carl's responsibility)                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   Orchestrator (Dan)                    ğŸ“ˆ Counter Carl                                     â”‚
â”‚        â”‚                                      â”‚                                              â”‚
â”‚        â”‚ AGENT_SPAWN_REQUEST                  â”‚                                              â”‚
â”‚        â”‚ { persona: 'ed' }                    â”‚                                              â”‚
â”‚        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                                              â”‚
â”‚        â”‚                                      â”‚ Reads .chorus/metrics/counters.json         â”‚
â”‚        â”‚                                      â”‚ ed: 47 â†’ 48                                  â”‚
â”‚        â”‚                                      â”‚                                              â”‚
â”‚        â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Returns agentId: "ed-048"                   â”‚
â”‚        â”‚                                      â”‚                                              â”‚
â”‚        â”‚ Spawns agent ed-048                  â”‚                                              â”‚
â”‚        â”‚                                      â”‚ AGENT_SPAWNED event logged                   â”‚
â”‚        â–¼                                      â–¼                                              â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AGENT EXECUTION FLOW                                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   TASK CLAIM                        WORKTREE SETUP                    ITERATION LOOP        â”‚
â”‚       â”‚                                   â”‚                                â”‚                 â”‚
â”‚       â–¼                                   â–¼                                â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ TaskStore  â”‚                    â”‚  Create    â”‚                    â”‚  Agent     â”‚         â”‚
â”‚  â”‚ .claim(id) â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  worktree  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  runs      â”‚         â”‚
â”‚  â”‚            â”‚                    â”‚  branch    â”‚                    â”‚  iteration â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                             â”‚                â”‚
â”‚  Task status:                      .worktrees/ed-048-ch-xxx/              Check              â”‚
â”‚  todo â†’ doing                      branch: agent/ed-048/ch-xxx           output              â”‚
â”‚                                                                             â”‚                â”‚
â”‚                                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                                                                   â”‚                 â”‚       â”‚
â”‚                                                                   â–¼                 â–¼       â”‚
â”‚                                                              Has signal?      No signal     â”‚
â”‚                                                                   â”‚                 â”‚       â”‚
â”‚                                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚       â”‚
â”‚                                                         â”‚                 â”‚        â”‚       â”‚
â”‚                                                         â–¼                 â–¼        â”‚       â”‚
â”‚                                                    COMPLETE          BLOCKED       â”‚       â”‚
â”‚                                                         â”‚                 â”‚        â”‚       â”‚
â”‚                                                         â”‚                 â”‚        â”‚       â”‚
â”‚                                                         â–¼                 â–¼        â”‚       â”‚
â”‚                                                  Quality checks     Stop agent    â”‚       â”‚
â”‚                                                  pass?                     â”‚       â”‚       â”‚
â”‚                                                    â”‚                       â”‚       â”‚       â”‚
â”‚                                                Yes â”‚ No                    â”‚       â”‚       â”‚
â”‚                                                    â”‚  â”‚                    â”‚       â”‚       â”‚
â”‚                                                    â–¼  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                               Task DONE                    â”‚                â”‚
â”‚                                               â†’ Review/Merge               â”‚                â”‚
â”‚                                                                     iteration++             â”‚
â”‚                                                                            â”‚                â”‚
â”‚                                                                      < max? â”€â”€â”€Noâ”€â”€â–¶ TIMEOUTâ”‚
â”‚                                                                            â”‚                â”‚
â”‚                                                                           Yes               â”‚
â”‚                                                                            â”‚                â”‚
â”‚                                                                            â””â”€â”€â–¶ Next iter   â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONTEXT INJECTION                                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   Agent prompt is composed of:                                                               â”‚
â”‚                                                                                              â”‚
â”‚   1. .chorus/rules/*.md           â”€â”€â”€â”€â”€â”€â–¶  Shared rules (ALL agents)                        â”‚
â”‚   2. .chorus/agents/{persona}/rules.md â”€â–¶  Persona-specific rules                           â”‚
â”‚   3. .chorus/agents/{persona}/prompt.md â”€â–¶  Persona system prompt                           â”‚
â”‚   4. .chorus/agents/{persona}/skills/ â”€â”€â”€â–¶  Persona skills                                  â”‚
â”‚   5. .chorus/learnings.md         â”€â”€â”€â”€â”€â”€â–¶  Project learnings                                â”‚
â”‚   6. .chorus/agents/{persona}/learnings.md â–¶ Agent learnings                                â”‚
â”‚   7. Task description + acceptance criteria                                                  â”‚
â”‚   8. Feedback (if redo)           â”€â”€â”€â”€â”€â”€â–¶  Previous review feedback                         â”‚
â”‚   9. Recovery context (if crashed) â”€â”€â”€â”€â”€â–¶  Previous attempt audit log                       â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Ralph Loop (Autopilot)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               RALPH WIGGUM LOOP (AUTOPILOT)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   START AUTOPILOT    â”‚
                              â”‚  (user selects mode) â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ Get ready tasks      â”‚
                              â”‚ from TaskStore       â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                                   â”‚ No tasks? â”‚
                                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                                    Yes  â”‚  No
                                     â”‚   â”‚
                                     â–¼   â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
                              â”‚  DONE!   â”‚â”‚
                              â”‚  Exit    â”‚â”‚
                              â”‚autopilot â”‚â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
                                         â”‚
                                         â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ ğŸ¯ Sam selects task  â”‚
                              â”‚ (intelligent algo)   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚ Spawn âš™ï¸ Ed agent    â”‚
                              â”‚ with selected task   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                              â”‚                              â”‚
          â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
          â”‚                    â”‚  ITERATION LOOP   â”‚                    â”‚
          â”‚                    â”‚                   â”‚                    â”‚
          â”‚                    â”‚   Agent runs      â”‚                    â”‚
          â”‚                    â”‚   Check output    â”‚                    â”‚
          â”‚                    â”‚                   â”‚                    â”‚
          â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
          â”‚                              â”‚                              â”‚
          â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
          â”‚            â”‚                 â”‚                 â”‚            â”‚
          â”‚            â–¼                 â–¼                 â–¼            â”‚
          â”‚       COMPLETE           BLOCKED          NO SIGNAL         â”‚
          â”‚            â”‚                 â”‚                 â”‚            â”‚
          â”‚            â”‚                 â”‚          iteration++         â”‚
          â”‚            â”‚                 â”‚                 â”‚            â”‚
          â”‚            â”‚                 â”‚           â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”      â”‚
          â”‚            â”‚                 â”‚           â”‚ < max?    â”‚      â”‚
          â”‚            â”‚                 â”‚           â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â”‚
          â”‚            â”‚                 â”‚            Yes  â”‚  No        â”‚
          â”‚            â”‚                 â”‚             â”‚   â”‚            â”‚
          â”‚            â”‚                 â”‚             â”‚   â–¼            â”‚
          â”‚            â”‚                 â”‚             â”‚ TIMEOUT        â”‚
          â”‚            â”‚                 â”‚             â”‚   â”‚            â”‚
          â”‚            â”‚                 â”‚             â””â”€â”€â”€â”¤            â”‚
          â”‚            â”‚                 â”‚                 â”‚            â”‚
          â”‚            â–¼                 â–¼                 â”‚            â”‚
          â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚            â”‚
          â”‚     â”‚ Close task â”‚    â”‚ Block task â”‚          â”‚            â”‚
          â”‚     â”‚ â†’ Review   â”‚    â”‚ Alert user â”‚          â”‚            â”‚
          â”‚     â”‚ or Merge   â”‚    â”‚            â”‚          â”‚            â”‚
          â”‚     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚            â”‚
          â”‚           â”‚                                    â”‚            â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                      â”‚                                                 â”‚
                      â–¼                                                 â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
               â”‚ Agent slot     â”‚                                       â”‚
               â”‚ now free       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                 â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
                 â”‚More tasks?â”‚
                 â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                  Yes  â”‚  No
                   â”‚   â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                   â”‚
           â–¼                   â–¼
    [Pick next task]    [All done!]


PARALLEL AGENTS (maxAgents > 1):

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                                                                          â”‚
  â”‚   âš™ï¸ ED-001          âš™ï¸ ED-002          âš™ï¸ ED-003          [empty slot]   â”‚
  â”‚   ch-004            ch-006            ch-009                            â”‚
  â”‚   iter 7/50         iter 3/50         iter 1/50                         â”‚
  â”‚   â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘        â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘        â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                        â”‚
  â”‚                                                                          â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                 â”‚                 â”‚
           â”‚                 â”‚                 â”‚
           â–¼                 â–¼                 â–¼
    Promise.race() waits for ANY agent to complete
           â”‚
           â–¼
    Handle result, spawn next task in empty slot
```

---

## 7. Merge Service Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   MERGE SERVICE FLOW                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MERGE QUEUE (FIFO)                                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   Task complete                                                                              â”‚
â”‚   (review approved or auto-approved)                                                         â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚                          MERGE QUEUE                                        â”‚            â”‚
â”‚   â”‚                                                                             â”‚            â”‚
â”‚   â”‚   ch-004 â”€â”€â–¶ ch-006 â”€â”€â–¶ ch-009 â”€â”€â–¶ ch-012 â”€â”€â–¶ [waiting...]                â”‚            â”‚
â”‚   â”‚                                                                             â”‚            â”‚
â”‚   â”‚   FIFO order: first approved = first merged                                 â”‚            â”‚
â”‚   â”‚                                                                             â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â”‚ Pop next                                                                            â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ MERGE ATTEMPT                                                                        â”‚   â”‚
â”‚   â”‚                                                                                      â”‚   â”‚
â”‚   â”‚   1. Checkout main branch                                                           â”‚   â”‚
â”‚   â”‚   2. git merge agent/ed-XXX/ch-XXX                                                 â”‚   â”‚
â”‚   â”‚   3. Run quality commands                                                           â”‚   â”‚
â”‚   â”‚                                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                               â”‚                                              â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                              â”‚                                 â”‚                            â”‚
â”‚                         No conflict                       CONFLICT!                         â”‚
â”‚                              â”‚                                 â”‚                            â”‚
â”‚                              â–¼                                 â–¼                            â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                        â”‚  MERGED  â”‚                    â”‚  CLASSIFY    â”‚                     â”‚
â”‚                        â”‚  to main â”‚                    â”‚  CONFLICT    â”‚                     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                               â”‚                             â”‚
â”‚                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚                                                   â”‚           â”‚           â”‚                 â”‚
â”‚                                                   â–¼           â–¼           â–¼                 â”‚
â”‚                                               SIMPLE      MEDIUM      COMPLEX               â”‚
â”‚                                                   â”‚           â”‚           â”‚                 â”‚
â”‚                                                   â–¼           â–¼           â–¼                 â”‚
â”‚                                              Auto-resolve  ğŸ”§ Finn    Human                 â”‚
â”‚                                              (git rebase)   resolves   review               â”‚
â”‚                                                   â”‚           â”‚           â”‚                 â”‚
â”‚                                                   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â”‚                 â”‚
â”‚                                                         â”‚                 â”‚                 â”‚
â”‚                                                    Resolved?              â”‚                 â”‚
â”‚                                                         â”‚                 â”‚                 â”‚
â”‚                                                    Yes  â”‚  No             â”‚                 â”‚
â”‚                                                     â”‚   â”‚   â”‚             â”‚                 â”‚
â”‚                                                     â–¼   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                               [Re-merge]â”‚         â”‚                         â”‚
â”‚                                                         â”‚         â–¼                         â”‚
â”‚                                                         â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                                                         â”‚   â”‚ ESCALATE TO   â”‚              â”‚
â”‚                                                         â”‚   â”‚ HUMAN REVIEW  â”‚              â”‚
â”‚                                                         â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                         â”‚                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CONFLICT CLASSIFICATION                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   Level      â”‚ Files â”‚ Type            â”‚ Resolution                                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”‚
â”‚   SIMPLE     â”‚ 1     â”‚ Text, whitespaceâ”‚ Auto-resolve (git rerere, rebase --ours)          â”‚
â”‚   MEDIUM     â”‚ 1-3   â”‚ Code changes    â”‚ ğŸ”§ Finn tries semantic merge                       â”‚
â”‚   COMPLEX    â”‚ 3+    â”‚ Semantic, arch  â”‚ Human review required                              â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”§ FINN'S RESOLUTION FLOW                                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   Conflict detected                                                                          â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                   â”‚
â”‚   â”‚ Finn reads both     â”‚                                                                   â”‚
â”‚   â”‚ versions + context  â”‚                                                                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                   â”‚
â”‚              â”‚                                                                               â”‚
â”‚              â–¼                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                   â”‚
â”‚   â”‚ Finn proposes       â”‚                                                                   â”‚
â”‚   â”‚ resolution          â”‚                                                                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                   â”‚
â”‚              â”‚                                                                               â”‚
â”‚              â–¼                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                   â”‚
â”‚   â”‚ Run quality checks  â”‚                                                                   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                                   â”‚
â”‚              â”‚                                                                               â”‚
â”‚         Pass â”‚ Fail                                                                          â”‚
â”‚              â”‚                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                   â”‚
â”‚   â–¼                     â–¼                                                                   â”‚
â”‚ RESOLVED             ESCALATE                                                               â”‚
â”‚ <chorus>RESOLVED     to human                                                               â”‚
â”‚ </chorus>                                                                                    â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. Memory & Learning System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              MEMORY & LEARNING SYSTEM                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LEARNING SIGNAL CAPTURE                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   âš™ï¸ Ed completes task                                                                      â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â”‚ Agent output may contain learning signals:                                          â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â”‚   <chorus>LEARNING_LOCAL:This function needs memoization</chorus>                  â”‚
â”‚        â”‚   <chorus>LEARNING_GLOBAL:All API endpoints require auth middleware</chorus>       â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                           ğŸ’¡ LOGGER LOU                                              â”‚   â”‚
â”‚   â”‚                                                                                      â”‚   â”‚
â”‚   â”‚   Lou's Queue (FIFO, serialized processing):                                        â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚   â”‚   â”‚ TASK_COMPLETED ch-004 â†’ TASK_COMPLETED ch-006 â†’ TASK_COMPLETED ch-009  â”‚       â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚   â”‚                                                                                      â”‚   â”‚
â”‚   â”‚   Processing:                                                                        â”‚   â”‚
â”‚   â”‚   1. Parse agent logs for LEARNING_LOCAL and LEARNING_GLOBAL signals               â”‚   â”‚
â”‚   â”‚   2. Categorize (performance, testing, debugging, patterns, etc.)                  â”‚   â”‚
â”‚   â”‚   3. Check for duplicates (SHA-256 hash of content)                                â”‚   â”‚
â”‚   â”‚   4. Check for outdated learnings (new info supersedes old)                        â”‚   â”‚
â”‚   â”‚   5. Write to appropriate file                                                      â”‚   â”‚
â”‚   â”‚                                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                               â”‚                                              â”‚
â”‚                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                               â”‚                               â”‚                             â”‚
â”‚                               â–¼                               â–¼                             â”‚
â”‚                        LEARNING_LOCAL                  LEARNING_GLOBAL                      â”‚
â”‚                               â”‚                               â”‚                             â”‚
â”‚                               â–¼                               â–¼                             â”‚
â”‚              .chorus/agents/{persona}/          .chorus/learnings.md                        â”‚
â”‚                     learnings.md                 (all agents see this)                      â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LEARNING STORAGE STRUCTURE                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   .chorus/                                                                                   â”‚
â”‚   â”œâ”€â”€ learnings.md              â—€â”€â”€ GLOBAL learnings (all agents read)                      â”‚
â”‚   â”‚   â”‚                                                                                      â”‚
â”‚   â”‚   â”‚ # Project Learnings                                                                 â”‚
â”‚   â”‚   â”‚                                                                                      â”‚
â”‚   â”‚   â”‚ ## Testing Patterns                                                                 â”‚
â”‚   â”‚   â”‚ - [2026-01-13] Vitest parallel mode causes flaky tests with shared state           â”‚
â”‚   â”‚   â”‚                                                                                      â”‚
â”‚   â”‚   â”‚ ## Architecture                                                                     â”‚
â”‚   â”‚   â”‚ - [2026-01-13] All API endpoints require rate limiting middleware                  â”‚
â”‚   â”‚   â”‚                                                                                      â”‚
â”‚   â”‚                                                                                          â”‚
â”‚   â””â”€â”€ agents/                                                                                â”‚
â”‚       â”œâ”€â”€ ed/                                                                                â”‚
â”‚       â”‚   â””â”€â”€ learnings.md      â—€â”€â”€ LOCAL learnings (only Ed reads)                        â”‚
â”‚       â”‚       â”‚                                                                              â”‚
â”‚       â”‚       â”‚ # Ed's Learnings                                                            â”‚
â”‚       â”‚       â”‚                                                                              â”‚
â”‚       â”‚       â”‚ ## TDD Workflow                                                             â”‚
â”‚       â”‚       â”‚ - [2026-01-13] This function needs memoization for performance             â”‚
â”‚       â”‚       â”‚                                                                              â”‚
â”‚       â”‚                                                                                      â”‚
â”‚       â””â”€â”€ pat/                                                                               â”‚
â”‚           â””â”€â”€ learnings.md      â—€â”€â”€ LOCAL learnings (only Pat reads)                       â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PLAN REVIEW TRIGGER                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   When CROSS-CUTTING or ARCHITECTURAL learning is discovered:                                â”‚
â”‚                                                                                              â”‚
â”‚   Learning Discovered                                                                        â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â”œâ”€â”€ LOCAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ No action                                              â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â”œâ”€â”€ CROSS-CUTTING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Trigger Plan Review                                    â”‚
â”‚        â”‚        â”‚                                                                            â”‚
â”‚        â”‚        â–¼                                                                            â”‚
â”‚        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚        â”‚   â”‚ Review all tasks  â”‚                                                            â”‚
â”‚        â”‚   â”‚ for impact        â”‚                                                            â”‚
â”‚        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚        â”‚            â”‚                                                                        â”‚
â”‚        â”‚            â–¼                                                                        â”‚
â”‚        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚        â”‚   â”‚ Update affected   â”‚                                                            â”‚
â”‚        â”‚   â”‚ task descriptions â”‚                                                            â”‚
â”‚        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â””â”€â”€ ARCHITECTURAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Alert + Plan Review                                    â”‚
â”‚                 â”‚                                                                            â”‚
â”‚                 â–¼                                                                            â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                             â”‚
â”‚           â”‚ Pause & Alert     â”‚                                                             â”‚
â”‚           â”‚ Human review      â”‚                                                             â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                             â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. Review System Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   REVIEW SYSTEM FLOW                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NON-BLOCKING REVIEW                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   Agent completes task                                                                       â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚   â”‚ Check task review mode         â”‚                                                        â”‚
â”‚   â”‚ (from tags: review:xxx)        â”‚                                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚               â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚   â”‚           â”‚           â”‚           â”‚           â”‚                                         â”‚
â”‚   â–¼           â–¼           â–¼           â–¼           â–¼                                         â”‚
â”‚ per-task    batch     auto-approve   skip                                                   â”‚
â”‚   â”‚           â”‚           â”‚           â”‚                                                     â”‚
â”‚   â–¼           â–¼           â–¼           â–¼                                                     â”‚
â”‚ Flash      â†’ REVIEW    Check auto-   â†’ DONE                                                 â”‚
â”‚ status       status    approve rules  (merge queue)                                         â”‚
â”‚ bar          â”‚           â”‚                                                                  â”‚
â”‚   â”‚          â”‚      â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                                                             â”‚
â”‚   â”‚          â”‚      â”‚         â”‚                                                             â”‚
â”‚   â”‚          â”‚    Passes    Fails                                                           â”‚
â”‚   â”‚          â”‚      â”‚         â”‚                                                             â”‚
â”‚   â”‚          â”‚      â–¼         â–¼                                                             â”‚
â”‚   â”‚          â”‚   â†’ DONE    â†’ REVIEW                                                         â”‚
â”‚   â”‚          â”‚   (merge)    status                                                          â”‚
â”‚   â”‚          â”‚                â”‚                                                             â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                             â”‚
â”‚               â”‚                                                                              â”‚
â”‚               â–¼                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚   â”‚ Agent FREE                      â”‚                                                        â”‚
â”‚   â”‚ Takes next task immediately     â”‚                                                        â”‚
â”‚   â”‚ (non-blocking!)                 â”‚                                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚                                                                                              â”‚
â”‚                    â”‚                                                                         â”‚
â”‚   MEANWHILE...     â”‚                                                                         â”‚
â”‚                    â–¼                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚   â”‚ User reviews when ready        â”‚                                                        â”‚
â”‚   â”‚ (press R to open review)       â”‚                                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                        â”‚
â”‚               â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚   â”‚           â”‚           â”‚           â”‚                                                     â”‚
â”‚   â–¼           â–¼           â–¼           â”‚                                                     â”‚
â”‚ Approve     Redo       Reject       â”‚                                                       â”‚
â”‚   â”‚           â”‚           â”‚           â”‚                                                     â”‚
â”‚   â–¼           â–¼           â–¼           â”‚                                                     â”‚
â”‚ â†’ DONE    â†’ TODO      â†’ STUCK        â”‚                                                      â”‚
â”‚ (merge)   (feedback)  (blocked)      â”‚                                                      â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AUTO-APPROVE LOGIC                                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   Task signals COMPLETE (quality commands already passed in Ralph loop)                      â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ Auto-approve check:                                                                 â”‚    â”‚
â”‚   â”‚                                                                                     â”‚    â”‚
â”‚   â”‚   if (task has 'review:per-task' tag)        â†’ NO, require human                   â”‚    â”‚
â”‚   â”‚   if (task has 'review:skip' tag)            â†’ YES, auto-approve                   â”‚    â”‚
â”‚   â”‚   if (!config.autoApprove.enabled)           â†’ NO, require human                   â”‚    â”‚
â”‚   â”‚   if (iterations > config.maxIterations)     â†’ NO, require human                   â”‚    â”‚
â”‚   â”‚   else                                       â†’ YES, auto-approve                   â”‚    â”‚
â”‚   â”‚                                                                                     â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                              â”‚
â”‚   Low iterations + no per-task tag = straightforward = auto-approve                          â”‚
â”‚   High iterations = agent struggled = human should verify                                    â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. Intervention & Rollback

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               INTERVENTION & ROLLBACK                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HUMAN INTERVENTION POINTS                                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   Key       â”‚ Action         â”‚ Effect                                                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚   Space     â”‚ Pause/Resume   â”‚ All agents pause at next iteration boundary                  â”‚
â”‚   i         â”‚ Intervention   â”‚ Open full intervention panel                                 â”‚
â”‚   s         â”‚ Stop agent     â”‚ Stop specific agent, task â†’ todo, worktree preserved        â”‚
â”‚   r         â”‚ Redirect       â”‚ Assign different task to agent                               â”‚
â”‚   b         â”‚ Block task     â”‚ Mark task as stuck with reason                               â”‚
â”‚   x         â”‚ Kill           â”‚ Force stop agent immediately                                 â”‚
â”‚   R         â”‚ Rollback task  â”‚ Revert commits for specific task                             â”‚
â”‚   c         â”‚ Checkpoint     â”‚ Create manual checkpoint                                     â”‚
â”‚   C         â”‚ Checkpoints    â”‚ View/restore checkpoints                                     â”‚
â”‚   m         â”‚ Mode toggle    â”‚ Switch semi-auto â†” autopilot                                â”‚
â”‚   q         â”‚ Quit           â”‚ Exit Chorus (confirm if agents running)                      â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CHECKPOINT SYSTEM                                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   AUTO-CHECKPOINTS (config-driven):                                                          â”‚
â”‚   â”œâ”€â”€ Before autopilot starts                                                               â”‚
â”‚   â”œâ”€â”€ Before each merge                                                                     â”‚
â”‚   â”œâ”€â”€ Every N completed tasks (config.checkpoints.periodic)                                 â”‚
â”‚   â””â”€â”€ Before risky operations                                                               â”‚
â”‚                                                                                              â”‚
â”‚   MANUAL CHECKPOINTS:                                                                        â”‚
â”‚   â””â”€â”€ Press 'c' to create named checkpoint                                                  â”‚
â”‚                                                                                              â”‚
â”‚   STORAGE:                                                                                   â”‚
â”‚   â”œâ”€â”€ Git tags: chorus-checkpoint-{timestamp}                                               â”‚
â”‚   â”œâ”€â”€ State snapshot: .chorus/checkpoints/{timestamp}/                                      â”‚
â”‚   â””â”€â”€ Task state preserved                                                                  â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ROLLBACK OPTIONS                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   1. TASK ROLLBACK (R on task)                                                              â”‚
â”‚      â”œâ”€â”€ Revert commits made by agent for this task                                         â”‚
â”‚      â”œâ”€â”€ Task returns to todo status                                                        â”‚
â”‚      â””â”€â”€ Worktree reset to pre-work state                                                   â”‚
â”‚                                                                                              â”‚
â”‚   2. CHECKPOINT ROLLBACK (C â†’ select â†’ Enter)                                               â”‚
â”‚      â”œâ”€â”€ Return to specific checkpoint                                                      â”‚
â”‚      â”œâ”€â”€ All changes since checkpoint reverted                                              â”‚
â”‚      â””â”€â”€ Tasks re-queued as they were                                                       â”‚
â”‚                                                                                              â”‚
â”‚   3. FULL SESSION ROLLBACK (Shift+R)                                                        â”‚
â”‚      â”œâ”€â”€ Returns to state before session started                                            â”‚
â”‚      â””â”€â”€ Nuclear option, rarely needed                                                      â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CRASH RECOVERY                                                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   CRASH HAPPENS                                                                              â”‚
â”‚   â”œâ”€â”€ Task ch-xxx status: "doing"                                                           â”‚
â”‚   â”œâ”€â”€ Worktree: .worktrees/ed-001-ch-xxx/ (has changes)                                    â”‚
â”‚   â””â”€â”€ Audit log: .chorus/audit/ch-xxx.jsonl                                                â”‚
â”‚                                                                                              â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚                                                                                              â”‚
â”‚   CHORUS RESTARTS                                                                            â”‚
â”‚   1. Load snapshot from .chorus/state/snapshot.json                                         â”‚
â”‚   2. If invalid, replay events from .chorus/state/events.jsonl                              â”‚
â”‚   3. Find orphaned tasks (status = doing, no running process)                               â”‚
â”‚   4. Reset orphaned tasks to todo, increment retryCount                                     â”‚
â”‚   5. Resume from last known state                                                           â”‚
â”‚                                                                                              â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚                                                                                              â”‚
â”‚   TASK RE-CLAIMED                                                                            â”‚
â”‚   1. selectNext() picks task (or another ready task)                                        â”‚
â”‚   2. claim() checks retryCount > 0                                                          â”‚
â”‚   3. If yes, read audit log and inject into prompt                                          â”‚
â”‚   4. Agent sees: "Previous attempt crashed. Review log."                                    â”‚
â”‚                                                                                              â”‚
â”‚   WHAT'S PRESERVED:                                                                          â”‚
â”‚   â”œâ”€â”€ Task state (.chorus/tasks.jsonl)                            âœ“                         â”‚
â”‚   â”œâ”€â”€ XState snapshot (.chorus/state/snapshot.json)               âœ“                         â”‚
â”‚   â”œâ”€â”€ Event log (.chorus/state/events.jsonl)                      âœ“                         â”‚
â”‚   â”œâ”€â”€ Agent logs (.chorus/agents/*/logs/*.jsonl)                  âœ“                         â”‚
â”‚   â”œâ”€â”€ Worktrees (with uncommitted changes)                        âœ“                         â”‚
â”‚   â””â”€â”€ Learnings (.chorus/learnings.md, .chorus/agents/*/learnings.md) âœ“                    â”‚
â”‚                                                                                              â”‚
â”‚   WHAT'S LOST:                                                                               â”‚
â”‚   â”œâ”€â”€ In-memory agent state                                       âœ—                         â”‚
â”‚   â”œâ”€â”€ Uncommitted changes in memory                               âœ—                         â”‚
â”‚   â””â”€â”€ Real-time output buffer                                     âœ—                         â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 11. Agent Persona Interactions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AGENT PERSONA INTERACTIONS                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ THE CHORUS TEAM (9 Personas)                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   ROLE           â”‚ PERSONA          â”‚ EMOJI â”‚ COLOR   â”‚ WHEN ACTIVE                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚   Analyzer       â”‚ Analyzer Ace     â”‚ ğŸ”    â”‚ Indigo  â”‚ Init mode                           â”‚
â”‚   Worker         â”‚ Engineer Ed      â”‚ âš™ï¸    â”‚ Blue    â”‚ Implementation (N parallel)         â”‚
â”‚   Planner        â”‚ Planner Pat      â”‚ ğŸ“Š    â”‚ Purple  â”‚ Planning mode                       â”‚
â”‚   Resolver       â”‚ Fixer Finn       â”‚ ğŸ”§    â”‚ Orange  â”‚ Merge conflicts                     â”‚
â”‚   Task Selector  â”‚ Spotter Sam      â”‚ ğŸ¯    â”‚ Green   â”‚ Autopilot task selection            â”‚
â”‚   Learning       â”‚ Logger Lou       â”‚ ğŸ’¡    â”‚ Teal    â”‚ After task completion               â”‚
â”‚   Orchestrator   â”‚ Director Dan     â”‚ ğŸ˜    â”‚ Gold    â”‚ Always (XState + coordination)      â”‚
â”‚   Health Monitor â”‚ Watcher Will     â”‚ ğŸ‘ï¸    â”‚ Amber   â”‚ Always (background patrol)          â”‚
â”‚   Statistician   â”‚ Counter Carl     â”‚ ğŸ“ˆ    â”‚ Slate   â”‚ Always (event-driven metrics)       â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INTERACTION DIAGRAM                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚                              â”‚         ğŸ˜ DIRECTOR DAN                  â”‚                    â”‚
â”‚                              â”‚       (XState Orchestration)             â”‚                    â”‚
â”‚                              â”‚                                          â”‚                    â”‚
â”‚                              â”‚  â€¢ Coordinates all agents                â”‚                    â”‚
â”‚                              â”‚  â€¢ User interaction                      â”‚                    â”‚
â”‚                              â”‚  â€¢ Mode management                       â”‚                    â”‚
â”‚                              â”‚  â€¢ Escalation handling                   â”‚                    â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                â”‚                                             â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚        â”‚                                       â”‚                                       â”‚    â”‚
â”‚        â–¼                                       â–¼                                       â–¼    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ğŸ” ACE       â”‚                    â”‚  ğŸ“Š PAT       â”‚                    â”‚  âš™ï¸ ED (Ã—N)   â”‚â”‚
â”‚  â”‚  Analyzer     â”‚                    â”‚  Planner      â”‚                    â”‚  Workers      â”‚â”‚
â”‚  â”‚               â”‚                    â”‚               â”‚                    â”‚               â”‚â”‚
â”‚  â”‚ Init mode     â”‚                    â”‚ Planning      â”‚                    â”‚ Execute       â”‚â”‚
â”‚  â”‚ analysis      â”‚                    â”‚ dialogue      â”‚                    â”‚ tasks         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                                    â”‚        â”‚
â”‚                                                                                    â”‚        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                              SUPPORTING SYSTEMS                                â”‚    â”‚   â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤   â”‚
â”‚   â”‚                                                                                â”‚    â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚    â”‚   â”‚
â”‚   â”‚  â”‚  ğŸ¯ SAM       â”‚    â”‚  ğŸ”§ FINN      â”‚    â”‚  ğŸ’¡ LOU       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚   â”‚  â”‚  Task Select  â”‚    â”‚  Resolver     â”‚    â”‚  Learning     â”‚                       â”‚   â”‚
â”‚   â”‚  â”‚               â”‚    â”‚               â”‚    â”‚  Extractor    â”‚   TASK_COMPLETED      â”‚   â”‚
â”‚   â”‚  â”‚ Picks next    â”‚    â”‚ Merge         â”‚    â”‚               â”‚                       â”‚   â”‚
â”‚   â”‚  â”‚ optimal task  â”‚    â”‚ conflicts     â”‚    â”‚ Extracts      â”‚                       â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ learnings     â”‚                       â”‚   â”‚
â”‚   â”‚         â”‚                    â”‚              â”‚ from logs     â”‚                       â”‚   â”‚
â”‚   â”‚         â”‚                    â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â”‚
â”‚   â”‚         â”‚                    â”‚                                                      â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚   â”‚  â”‚                                                                           â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚  ğŸ‘ï¸ WILL       â”‚                        â”‚  ğŸ“ˆ CARL      â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚  Health       â”‚                        â”‚  Statistician â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚  Monitor      â”‚                        â”‚               â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚               â”‚                        â”‚ Counts:       â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ Patrols every â”‚                        â”‚ â€¢ Agent IDs   â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ 2 minutes     â”‚                        â”‚ â€¢ Tokens      â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚               â”‚                        â”‚ â€¢ Costs       â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ Actions:      â”‚                        â”‚ â€¢ Success     â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ â€¢ Nudge       â”‚                        â”‚   rates       â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ â€¢ Restart     â”‚                        â”‚               â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ â€¢ Pause all   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Tracks ALL    â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ â€¢ Escalate    â”‚    Notifies Will       â”‚ events        â”‚              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    on rate limits      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚      â”‚   â”‚
â”‚   â”‚  â”‚                                                                           â”‚      â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚   â”‚                                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AGENT ID NUMBERING                                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   ALL agents get instance numbers (lifetime counter, persists across restarts):             â”‚
â”‚                                                                                              â”‚
â”‚   Format: {persona}-{NNN}                                                                    â”‚
â”‚                                                                                              â”‚
â”‚   Examples:                                                                                  â”‚
â”‚   â€¢ ace-001, ace-002       (Ace runs each init)                                             â”‚
â”‚   â€¢ dan-001, dan-002       (Dan spawns each session)                                        â”‚
â”‚   â€¢ ed-001, ed-002, ed-003 (Multiple concurrent workers)                                    â”‚
â”‚   â€¢ will-001, will-002     (Will after restart/crash)                                       â”‚
â”‚   â€¢ carl-001               (Carl runs once per session)                                      â”‚
â”‚                                                                                              â”‚
â”‚   Counter storage: .chorus/metrics/counters.json (managed by Carl)                          â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 12. Event Flow Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   EVENT FLOW SUMMARY                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ COMPLETE SESSION FLOW                                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                              â”‚
â”‚   $ chorus                                                                                   â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 1. INIT                                                                               â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ ğŸ” Ace analyzes project                                                       â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ Creates .chorus/ directory                                                    â”‚  â”‚
â”‚   â”‚    â””â”€â”€ Saves config.json                                                             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 2. PLANNING                                                                           â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ ğŸ“Š Pat engages in dialogue                                                    â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Phase 1: UNDERSTAND (Q&A)                                                 â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Phase 2: ANALYZE (scan code)                                              â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Phase 3: PROPOSE (architecture)                                           â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Phase 4: DECOMPOSE (generate tasks)                                       â”‚  â”‚
â”‚   â”‚    â”‚   â””â”€â”€ Phase 5: VALIDATE (Ralph loop fixes)                                      â”‚  â”‚
â”‚   â”‚    â””â”€â”€ Tasks saved to tasks.jsonl                                                    â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 3. MODE SELECTION                                                                     â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ User chooses: Semi-auto or Autopilot                                          â”‚  â”‚
â”‚   â”‚    â””â”€â”€ Saved to planning-state.json                                                  â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 4. IMPLEMENTATION                                                                     â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ ğŸ˜ Dan orchestrates                                                           â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ ğŸ“ˆ Carl: AGENT_SPAWN_REQUEST â†’ returns agentId                            â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Spawns âš™ï¸ Ed workers (ed-001, ed-002, ...)                                â”‚  â”‚
â”‚   â”‚    â”‚   â””â”€â”€ Monitors progress                                                         â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ âš™ï¸ Ed executes tasks                                                          â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Creates worktree + branch                                                 â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Runs iterations (Ralph loop)                                              â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Signals: PROGRESS, COMPLETE, BLOCKED                                      â”‚  â”‚
â”‚   â”‚    â”‚   â””â”€â”€ Emits learnings: LEARNING_LOCAL, LEARNING_GLOBAL                          â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ ğŸ¯ Sam (autopilot) selects next tasks                                         â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ ğŸ‘ï¸ Will monitors health                                                       â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Patrols every 2 min                                                       â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Nudges stale agents                                                       â”‚  â”‚
â”‚   â”‚    â”‚   â””â”€â”€ Restarts stuck agents                                                     â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â””â”€â”€ ğŸ“ˆ Carl tracks metrics                                                        â”‚  â”‚
â”‚   â”‚        â”œâ”€â”€ Tokens, costs, success rates                                              â”‚  â”‚
â”‚   â”‚        â””â”€â”€ Writes to .chorus/metrics/                                                â”‚  â”‚
â”‚   â”‚                                                                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 5. COMPLETION â†’ REVIEW â†’ MERGE                                                        â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ Task COMPLETE                                                                 â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Auto-approve? â†’ DONE â†’ Merge queue                                        â”‚  â”‚
â”‚   â”‚    â”‚   â””â”€â”€ Needs review? â†’ REVIEW status                                             â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ ğŸ’¡ Lou extracts learnings                                                     â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Parses signals from logs                                                  â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ LOCAL â†’ agent learnings                                                   â”‚  â”‚
â”‚   â”‚    â”‚   â””â”€â”€ GLOBAL â†’ shared learnings                                                 â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ User reviews (press R)                                                        â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Approve â†’ Merge queue                                                     â”‚  â”‚
â”‚   â”‚    â”‚   â”œâ”€â”€ Redo â†’ TODO with feedback                                                 â”‚  â”‚
â”‚   â”‚    â”‚   â””â”€â”€ Reject â†’ STUCK                                                            â”‚  â”‚
â”‚   â”‚    â”‚                                                                                  â”‚  â”‚
â”‚   â”‚    â””â”€â”€ Merge queue (FIFO)                                                            â”‚  â”‚
â”‚   â”‚        â”œâ”€â”€ No conflict â†’ Merged to main                                              â”‚  â”‚
â”‚   â”‚        â””â”€â”€ Conflict â†’ ğŸ”§ Finn resolves (or escalate)                                 â”‚  â”‚
â”‚   â”‚                                                                                       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                                     â”‚
â”‚        â–¼                                                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ 6. SESSION COMPLETE                                                                   â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ All tasks merged to main                                                      â”‚  â”‚
â”‚   â”‚    â”œâ”€â”€ ğŸ“ˆ Carl: SESSION_END summary                                                  â”‚  â”‚
â”‚   â”‚    â””â”€â”€ User can start new planning cycle                                             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Quick Reference: Key Files

```
.chorus/
â”œâ”€â”€ config.json              # Main configuration
â”œâ”€â”€ tasks.jsonl              # Task database (TaskStore)
â”œâ”€â”€ planning-state.json      # Current planning/mode state
â”œâ”€â”€ learnings.md             # Shared project learnings (GLOBAL)
â”œâ”€â”€ sprints.jsonl            # Sprint history
â”‚
â”œâ”€â”€ state/                   # XState persistence (gitignored)
â”‚   â”œâ”€â”€ snapshot.json        # Machine snapshot
â”‚   â””â”€â”€ events.jsonl         # Event log for recovery
â”‚
â”œâ”€â”€ metrics/                 # Carl's metrics
â”‚   â”œâ”€â”€ counters.json        # Agent spawn counters
â”‚   â”œâ”€â”€ session.json         # Current session stats
â”‚   â””â”€â”€ history.jsonl        # Historical data
â”‚
â”œâ”€â”€ rules/                   # Shared rules (all agents)
â”‚   â”œâ”€â”€ signal-types.md
â”‚   â”œâ”€â”€ learning-format.md
â”‚   â”œâ”€â”€ commit-format.md
â”‚   â””â”€â”€ completion-protocol.md
â”‚
â””â”€â”€ agents/                  # Per-agent data
    â”œâ”€â”€ ace/
    â”œâ”€â”€ ed/
    â”œâ”€â”€ pat/
    â”œâ”€â”€ finn/
    â”œâ”€â”€ sam/
    â”œâ”€â”€ lou/
    â”œâ”€â”€ dan/
    â”œâ”€â”€ will/
    â””â”€â”€ carl/
        â”œâ”€â”€ prompt.md        # System prompt
        â”œâ”€â”€ rules.md         # Persona rules
        â”œâ”€â”€ skills/          # Skills
        â”œâ”€â”€ logs/            # Execution logs
        â”œâ”€â”€ learnings.md     # Agent learnings (LOCAL)
        â””â”€â”€ metrics.json     # Performance metrics
```

---

**End of Process Diagrams Appendix**
