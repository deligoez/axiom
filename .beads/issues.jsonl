{"id":"bd-41v","title":"F01: Config System - Read/write .chorus/config.json","description":"## What\nRead/write .chorus/config.json for persistent settings.\n\n## Acceptance Criteria\n- [ ] Can load config from .chorus/config.json\n- [ ] Returns default config if file doesn't exist\n- [ ] Can save config to file\n- [ ] Creates .chorus/ directory if needed\n- [ ] Validates config structure\n- [ ] 8 tests pass\n\n## Files\n- src/types/config.ts (NEW)\n- src/services/ConfigService.ts (NEW)\n- tests/services/ConfigService.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F01-config-system.md","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:23:49.453114+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:29:59.047538+03:00","labels":["critical-path","feature","m1-infrastructure"],"deleted_at":"2026-01-10T01:29:59.047538+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bd-47p","title":"F08: Signal Parser - Parse \u003cchorus\u003e signals from agent output","description":"## What\nParse \u003cchorus\u003e signals from agent output.\n\n## Acceptance Criteria\n- [ ] Parses COMPLETE, BLOCKED, PROGRESS signals\n- [ ] Returns null for no signal\n- [ ] isComplete(), isBlocked() helpers\n- [ ] getProgress() returns number\n- [ ] getReason() extracts reason text\n- [ ] 10 tests pass\n\n## Files\n- src/types/signal.ts (NEW)\n- src/services/SignalParser.ts (NEW)\n- tests/services/SignalParser.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F08-signal-parser.md","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:24:46.721297+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:29:59.047538+03:00","labels":["critical-path","feature","m2-agent-prep"],"deleted_at":"2026-01-10T01:29:59.047538+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bd-bin","title":"F02: State System - Runtime state in .chorus/state.json","description":"## What\nManage runtime state in .chorus/state.json (transient, gitignored).\n\n## Acceptance Criteria\n- [ ] Can initialize new session state\n- [ ] Can load existing state for recovery\n- [ ] Can add/update/remove agents from state\n- [ ] Can manage merge queue\n- [ ] Persists changes with debounce (100ms)\n- [ ] clear() removes state file\n- [ ] 8 tests pass\n\n## Files\n- src/types/state.ts (NEW)\n- src/services/StateService.ts (NEW)\n- tests/services/StateService.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F02-state-system.md","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:23:57.385137+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:29:59.047538+03:00","labels":["critical-path","feature","m1-infrastructure"],"deleted_at":"2026-01-10T01:29:59.047538+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bd-bxq","title":"F09: Agent-Task Linking - Associate agent with task ID","description":"## What\nAssociate spawned agents with task IDs, track in store and state.\n\n## Acceptance Criteria\n- [ ] Agent type includes taskId, agentType, worktree, branch\n- [ ] getAgentByTaskId() finds correct agent\n- [ ] getAgentsByType() filters correctly\n- [ ] incrementIteration() updates count\n- [ ] 5 tests pass\n\n## Files\n- src/types/agent.ts (extend)\n- src/stores/agentStore.ts (extend)\n- tests/stores/agentStore.test.ts (extend)\n\n## Plan\nSee: thoughts/shared/plans/features/F09-agent-task-linking.md","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:24:54.82499+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:29:59.047538+03:00","labels":["critical-path","feature","m2-agent-prep"],"deleted_at":"2026-01-10T01:29:59.047538+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bd-d7v","title":"F07: Prompt Builder - Build agent prompts with task context","description":"## What\nBuild agent prompts with task context, acceptance criteria, signal protocol.\n\n## Acceptance Criteria\n- [ ] Generates prompt with task description\n- [ ] Includes acceptance criteria (or default)\n- [ ] Includes completion protocol with signal\n- [ ] Claude: no extra injection\n- [ ] Codex/OpenCode: includes AGENTS.md + learnings\n- [ ] 8 tests pass\n\n## Files\n- src/services/PromptBuilder.ts (NEW)\n- tests/services/PromptBuilder.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F07-prompt-builder.md","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:24:46.64524+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:29:59.047538+03:00","labels":["critical-path","feature","m2-agent-prep"],"deleted_at":"2026-01-10T01:29:59.047538+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bd-hix","title":"F06: Worktree Service Complete - Full lifecycle management","description":"## What\nComplete worktree lifecycle: create, list, query, remove.\n\n## Acceptance Criteria\n- [ ] All F04 create tests pass\n- [ ] All F05 cleanup tests pass\n- [ ] list() returns all agent worktrees\n- [ ] getInfo() returns complete info\n- [ ] removeAll() cleans up everything\n- [ ] 4 additional tests (14 total)\n\n## Files\n- src/services/WorktreeService.ts (finalize)\n- tests/services/WorktreeService.test.ts (complete)\n\n## Plan\nSee: thoughts/shared/plans/features/F06-worktree-service.md","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:24:27.012325+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:29:59.047538+03:00","labels":["critical-path","feature","m1-infrastructure"],"deleted_at":"2026-01-10T01:29:59.047538+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bd-jez","title":"F05: Worktree Cleanup - git worktree remove after merge","description":"## What\nRemove git worktrees after merge.\n\n## Acceptance Criteria\n- [ ] Removes worktree directory\n- [ ] Deletes branch if merged to main\n- [ ] Keeps branch if not merged (warning)\n- [ ] Force option for uncommitted changes\n- [ ] Throws if worktree doesn't exist\n- [ ] 5 tests pass\n\n## Files\n- src/services/WorktreeService.ts (extend)\n- tests/services/WorktreeService.test.ts (extend)\n\n## Plan\nSee: thoughts/shared/plans/features/F05-worktree-cleanup.md","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:24:18.998566+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:29:59.047538+03:00","labels":["critical-path","feature","m1-infrastructure"],"deleted_at":"2026-01-10T01:29:59.047538+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bd-mdv","title":"F04: Worktree Create - git worktree add for agent isolation","description":"## What\nCreate git worktrees for agent isolation.\n\n## Acceptance Criteria\n- [ ] Creates worktree at .worktrees/{agent}-{task}\n- [ ] Creates branch agent/{agent}/{task} from main\n- [ ] Creates .worktrees/ directory if needed\n- [ ] Throws if worktree already exists\n- [ ] Returns correct WorktreeInfo\n- [ ] 5 tests pass\n\n## Files\n- src/services/WorktreeService.ts (NEW - partial)\n- tests/services/WorktreeService.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F04-worktree-create.md","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:24:04.989699+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:29:59.047538+03:00","labels":["critical-path","feature","m1-infrastructure"],"deleted_at":"2026-01-10T01:29:59.047538+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"bd-uvl","title":"F05: Worktree Remove - Cleanup after merge","description":"## What\nRemove git worktrees after task completion.\n\n## Acceptance Criteria\n- [ ] remove() runs: git worktree remove {path}\n- [ ] Deletes branch if merged to main\n- [ ] Keeps branch if not merged (logs warning)\n- [ ] force option for uncommitted changes\n- [ ] 5 tests pass\n\n## Files\n- src/services/WorktreeService.ts (extend)\n- tests/services/WorktreeService.test.ts (extend)\n\n## Test Cases\n1. remove() deletes worktree dir\n2. remove() deletes merged branch\n3. remove() keeps unmerged branch\n4. remove() with force works\n5. remove() throws if not exists","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:31:03.293979+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:31:30.582217+03:00","labels":["critical-path","feature","m1-infrastructure"],"deleted_at":"2026-01-10T01:31:30.582217+03:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"ch-001","title":"Write hello to test.txt","description":"Create test.txt and write 'Hello from Chorus!'","status":"tombstone","priority":1,"issue_type":"task","created_at":"2026-01-10T01:23:14.777764+03:00","updated_at":"2026-01-10T01:47:09.417655+03:00","deleted_at":"2026-01-10T01:47:09.417655+03:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"ch-002","title":"Count to 10","description":"Print numbers 1 to 10","status":"tombstone","priority":2,"issue_type":"task","created_at":"2026-01-10T01:23:14.777764+03:00","updated_at":"2026-01-10T01:47:09.485954+03:00","deleted_at":"2026-01-10T01:47:09.485954+03:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"ch-003","title":"Show current date","status":"tombstone","priority":3,"issue_type":"task","assignee":"agent-1","created_at":"2026-01-10T01:23:14.777764+03:00","updated_at":"2026-01-10T01:47:09.553706+03:00","deleted_at":"2026-01-10T01:47:09.553706+03:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"ch-0e7","title":"F15: Orchestrator Core - Central coordinator for task assignment","description":"## What\nCentral coordinator: task selection → worktree creation → prompt building → agent spawning → tracking → timeout handling.\n\n## Acceptance Criteria\n\n### Types (src/types/orchestration.ts)\n- [ ] AssignmentResult: success, agentId, taskId, worktree, error?\n- [ ] OrchestratorConfig: projectDir, config, agentManager, beadsService\n- [ ] TaskAssignment: taskId, agentType, modelOverride?\n\n### assignTask()\n- [ ] Creates worktree for task\n- [ ] Claims task via \\`bd update --status=in_progress\\`\n- [ ] Builds prompt with task context\n- [ ] Spawns agent in worktree directory\n- [ ] Returns AssignmentResult on success\n- [ ] Emits \"assigned\" event\n- [ ] Returns error if task not found\n- [ ] Returns error if task already assigned\n- [ ] Returns error if dependencies not met\n\n### canAssign()\n- [ ] Returns \\`{ can: true }\\` for ready open task\n- [ ] Returns \\`{ can: false }\\` for in_progress task\n- [ ] Returns \\`{ can: false }\\` for closed task\n- [ ] Returns \\`{ can: false }\\` if max agents reached\n- [ ] Checks dependencies are closed\n\n### Timeout Handling (from master plan)\n- [ ] Sets timeout timer when agent spawns (config.completion.taskTimeout, default 30min)\n- [ ] Kills agent process on timeout\n- [ ] Returns task to pending status on timeout\n- [ ] Emits \"timeout\" event with agentId, taskId\n- [ ] Clears timeout timer when agent exits normally\n\n### getAgentType()\n- [ ] Uses task custom.agent if specified\n- [ ] Falls back to config default\n\n### Helper Methods\n- [ ] \\`getTask(id)\\` returns task or undefined\n- [ ] \\`getReadyTasks()\\` returns open tasks with satisfied deps\n- [ ] \\`getAgentConfig(type)\\` returns config for agent type\n- [ ] Passes CHORUS_TASK_ID, CHORUS_BRANCH env vars\n- [ ] Applies model override if allowed\n\n### Summary\n- [ ] 23 tests pass\n\n## Files\n- src/services/Orchestrator.ts (NEW)\n- src/types/orchestration.ts (NEW)\n- tests/services/Orchestrator.test.ts (NEW)\n\n## Notes\n- Core service - everything flows through here\n- Extends EventEmitter for 'assigned', 'timeout', 'error' events\n- Agent spawn in worktree cwd\n- Completion handling is F16 (not here)\n- Timeout: Prevents runaway agents, returns task for retry","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:47:53.010882+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:27:10.861884+03:00","labels":["m4-orchestration"],"dependencies":[{"issue_id":"ch-0e7","depends_on_id":"ch-iel","type":"blocks","created_at":"2026-01-10T01:47:53.01358+03:00","created_by":"deligoez"},{"issue_id":"ch-0e7","depends_on_id":"ch-wk8","type":"blocks","created_at":"2026-01-10T01:47:53.015317+03:00","created_by":"deligoez"},{"issue_id":"ch-0e7","depends_on_id":"ch-3y0","type":"blocks","created_at":"2026-01-10T01:47:53.016714+03:00","created_by":"deligoez"},{"issue_id":"ch-0e7","depends_on_id":"ch-zqi","type":"blocks","created_at":"2026-01-10T01:47:53.01801+03:00","created_by":"deligoez"}]}
{"id":"ch-0ok","title":"F61b: ShortcutCategory Component - Grouped keyboard shortcuts","description":"## What\nComponent to display a category of keyboard shortcuts with title and key-description pairs.\n\n## Context from Master Plan\n```\n│  NAVIGATION                     │\n│  j/↓  Move down                 │\n│  k/↑  Move up                   │\n│  Tab  Switch panels             │\n│  1-9  Quick select              │\n```\n\n## API\n```typescript\n// src/components/ShortcutCategory.tsx\n\ninterface Shortcut {\n  key: string;           // e.g., \"j/↓\"\n  description: string;   // e.g., \"Move down\"\n}\n\ninterface ShortcutCategoryProps {\n  title: string;\n  shortcuts: Shortcut[];\n}\n\nfunction ShortcutCategory({ title, shortcuts }: ShortcutCategoryProps): JSX.Element\n```\n\n## Files\n- src/components/ShortcutCategory.tsx\n- src/components/ShortcutCategory.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows category title in bold\n- [ ] Lists all shortcuts with key and description\n- [ ] Key is left-aligned, fixed width\n- [ ] Description follows key\n- [ ] Uses dimColor for description\n- [ ] 5 tests pass\n\n## Tests\n1. Shows category title in bold\n2. Lists all shortcuts\n3. Key has fixed width alignment\n4. Description uses dimColor\n5. Handles empty shortcuts array","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:51:16.471906+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:02:28.03636+03:00","labels":["m12-tui"]}
{"id":"ch-0z7","title":"F03a: Init Prerequisites - Check system requirements","description":"## What\nCheck system prerequisites before initialization: git repo, Node.js version, Beads CLI, and available agent CLIs.\n\n## Acceptance Criteria\n\n### checkGitRepo() - 2 tests\n- [ ] Returns true if current directory is a git repository\n- [ ] Returns false if not a git repo\n\n### checkNodeVersion() - 2 tests\n- [ ] Returns true if Node.js \u003e= 20\n- [ ] Returns false if Node.js \u003c 20 or not installed\n\n### checkBeadsCLI() - 2 tests\n- [ ] Returns true if `bd` command is available\n- [ ] Returns false if `bd` not found\n\n### detectAgentCLIs() - 3 tests\n- [ ] Returns array of available agent types (claude, codex, opencode)\n- [ ] Returns empty array if no agents found\n- [ ] Detects all three agent CLIs when present\n\n### checkAll() - 2 tests\n- [ ] Returns PrerequisiteResult with all checks\n- [ ] Returns list of missing prerequisites with install instructions\n\n### Summary\n- [ ] 11 tests pass\n\n## Types\n```typescript\ninterface PrerequisiteResult {\n  gitRepo: boolean;\n  nodeVersion: boolean;\n  nodeVersionFound?: string;\n  beadsCLI: boolean;\n  agents: AgentType[];\n  missing: MissingPrerequisite[];\n  allPassed: boolean;\n}\n\ninterface MissingPrerequisite {\n  name: string;\n  instruction: string;\n}\n```\n\n## Files\n- src/services/InitPrerequisites.ts (NEW)\n- tests/services/InitPrerequisites.test.ts (NEW)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T11:20:00.706785+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:20:00.706785+03:00","labels":["m1-infrastructure"]}
{"id":"ch-105","title":"F58b: MergeQueueIndicator Component - Show merge queue status","description":"## What\nDisplay merge queue status showing items pending merge.\n\n## Context from Master Plan\n```\n│ Tasks: 1 done, 3 running, 1 pending, 1 blocked | Merge: 1 queued | ? help   │\n```\n\n## API\n```typescript\n// src/components/MergeQueueIndicator.tsx\n\ninterface MergeQueueIndicatorProps {\n  queued: number;\n  merging?: boolean;     // Currently merging\n  conflict?: boolean;    // Has conflict\n}\n\nfunction MergeQueueIndicator({ queued, merging, conflict }: MergeQueueIndicatorProps): JSX.Element\n```\n\n## Visual Output\n- Empty queue: `Merge: 0 queued`\n- Items queued: `Merge: 3 queued`\n- Merging: `Merge: ● merging...`\n- Conflict: `Merge: ⚠ conflict`\n\n## Files\n- src/components/MergeQueueIndicator.tsx\n- src/components/MergeQueueIndicator.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows \"Merge:\" prefix\n- [ ] Shows queued count when no activity\n- [ ] Shows \"merging...\" with spinner when merging=true\n- [ ] Shows \"conflict\" with warning icon when conflict=true\n- [ ] Uses yellow for merging state\n- [ ] Uses red for conflict state\n- [ ] 6 tests pass\n\n## Tests\n1. Shows \"Merge: 0 queued\" for empty\n2. Shows \"Merge: 3 queued\" for items\n3. Shows merging state with indicator\n4. Shows conflict state with warning\n5. Yellow color for merging\n6. Red color for conflict","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:49:02.012057+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:01:48.150054+03:00","labels":["m12-tui"]}
{"id":"ch-112","title":"F05: Worktree Remove - Cleanup after merge","description":"## What\nRemove git worktrees after task completion.\n\n## Acceptance Criteria\n- [ ] remove() runs: git worktree remove {path}\n- [ ] Deletes branch if merged to main\n- [ ] Keeps branch if not merged (logs warning)\n- [ ] force option for uncommitted changes\n- [ ] isBranchMerged() checks if branch is merged into main\n- [ ] prune() cleans up stale worktree entries\n- [ ] 6 tests pass\n\n## Files\n- src/services/WorktreeService.ts (extend)\n- tests/services/WorktreeService.test.ts (extend)\n\n## API\n```typescript\nasync remove(agentType: string, taskId: string, options?: {\n  deleteBranch?: boolean;  // default true if merged\n  force?: boolean;         // git worktree remove --force\n}): Promise\u003cvoid\u003e;\n\nasync isBranchMerged(branch: string): Promise\u003cboolean\u003e;\n\nasync prune(): Promise\u003cvoid\u003e;\n```\n\n## Test Cases\n1. remove() deletes worktree dir\n2. remove() deletes merged branch\n3. remove() keeps unmerged branch\n4. remove() with force works\n5. remove() throws if not exists\n6. isBranchMerged() returns correct boolean","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:31:10.574386+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:30:32.215624+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-112","depends_on_id":"ch-glq","type":"blocks","created_at":"2026-01-10T01:31:10.576808+03:00","created_by":"deligoez"}]}
{"id":"ch-1gi","title":"F39b: Scratchpad Manager - Read and clear agent scratchpad","description":"## What\nManage agent scratchpads - read content and clear after extraction.\n\n## API\n```typescript\n// src/services/ScratchpadManager.ts\n\nclass ScratchpadManager {\n  constructor(private worktreePath: string) {}\n\n  /**\n   * Read scratchpad content from agent's worktree\n   * @returns Scratchpad object or null if not exists\n   */\n  async read(): Promise\u003cScratchpad | null\u003e\n\n  /**\n   * Extract learnings section from scratchpad\n   * @returns Parsed learnings section or null\n   */\n  extractLearningsSection(content: string): string | null\n\n  /**\n   * Clear scratchpad after extraction\n   */\n  async clear(): Promise\u003cvoid\u003e\n\n  /**\n   * Check if scratchpad exists\n   */\n  async exists(): Promise\u003cboolean\u003e\n}\n```\n\n## Files\n- src/services/ScratchpadManager.ts\n- tests/services/ScratchpadManager.test.ts\n\n## Acceptance Criteria\n- [ ] `read()` returns Scratchpad with content when file exists\n- [ ] `read()` returns null when file doesn't exist\n- [ ] `extractLearningsSection()` parses \"## Learnings\" section\n- [ ] `extractLearningsSection()` returns null if no learnings section\n- [ ] `clear()` deletes the scratchpad file\n- [ ] `exists()` returns true/false correctly\n- [ ] 6 tests pass\n\n## Tests\n1. read() returns scratchpad when file exists\n2. read() returns null when file missing\n3. extractLearningsSection() parses learnings section\n4. extractLearningsSection() returns null without section\n5. clear() removes scratchpad file\n6. exists() returns correct boolean","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:42:31.99359+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:42:31.99359+03:00","labels":["m8-memory"],"dependencies":[{"issue_id":"ch-1gi","depends_on_id":"ch-uxk","type":"blocks","created_at":"2026-01-10T10:42:31.99564+03:00","created_by":"deligoez"}]}
{"id":"ch-26c","title":"F30: Human Escalation","description":"## What\nFinal fallback when all automated resolution fails. Pauses autopilot for human intervention.\n\n## Acceptance Criteria\n\n### escalate() - 3 tests\n- [ ] Emits 'escalated' event with request details\n- [ ] Returns Promise that waits for human action\n- [ ] Sets `pending` state with request\n\n### markResolved() - 1 test\n- [ ] Clears pending, emits 'resolved', resolves with `action: 'merged'`\n\n### markSkipped() - 1 test\n- [ ] Clears pending, emits 'skipped', resolves with `action: 'skipped'` (autopilot continues)\n\n### markCancelled() - 1 test\n- [ ] Clears pending, emits 'cancelled', resolves with `action: 'cancelled'` (autopilot stops)\n\n### hasPending() / getPending() - 1 test\n- [ ] `hasPending()` returns true when pending\n- [ ] `getPending()` returns request or null\n\n## Files\n- src/services/HumanEscalation.ts\n- tests/services/HumanEscalation.test.ts\n\n## Plan\nSee: thoughts/shared/plans/features/F30-human-escalation.md\n\n**Total: 7 tests**","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:17:01.402172+03:00","created_by":"deligoez","updated_at":"2026-01-10T08:27:34.282514+03:00","labels":["m5-merge"],"dependencies":[{"issue_id":"ch-26c","depends_on_id":"ch-9sj","type":"blocks","created_at":"2026-01-10T03:17:10.806465+03:00","created_by":"deligoez"}]}
{"id":"ch-2n6","title":"F01a: Config Types - ChorusConfig interface and defaults","description":"## What\nDefine TypeScript types for Chorus configuration.\n\n## Acceptance Criteria\n- [ ] AgentType: 'claude' | 'codex' | 'opencode'\n- [ ] AgentConfig interface with command, args, model?, allowModelOverride?\n- [ ] ChorusConfig interface with all fields\n- [ ] getDefaults() returns complete default config\n- [ ] 4 tests pass\n\n## Files\n- src/types/config.ts (NEW)\n\n## Implementation\n```typescript\nexport type AgentType = 'claude' | 'codex' | 'opencode';\n\nexport interface AgentConfig {\n  command: string;\n  args: string[];\n  model?: string;\n  allowModelOverride?: boolean;\n}\n\nexport interface ChorusConfig {\n  version: string;\n  mode: 'semi-auto' | 'autopilot';\n  agents: {\n    default: AgentType;\n    maxParallel: number;\n    available: Record\u003cAgentType, AgentConfig\u003e;\n  };\n  project: { testCommand: string; buildCommand?: string };\n  completion: { signal: string; requireTests: boolean; maxIterations: number; taskTimeout: number };\n  merge: { autoResolve: boolean; agentResolve: boolean; requireApproval: boolean };\n  tui: { agentGrid: 'auto' | string };\n}\n\nexport function getDefaultConfig(): ChorusConfig { ... }\n```\n\n## Test Cases\n1. AgentConfig interface compiles with all fields\n2. getDefaultConfig returns valid ChorusConfig\n3. Default mode is 'semi-auto'\n4. Default agent is 'claude'","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:30:10.093924+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:07:31.447487+03:00","labels":["m1-infrastructure"]}
{"id":"ch-2po","title":"F61c: HelpPanel Enhanced - All shortcuts grouped by category","description":"## What\nEnhanced HelpPanel showing all keyboard shortcuts from Section 14, grouped by category.\n\n## Context from Master Plan\n```\n┌─────────────────────────────────────────────────────────────────┐\n│                        KEYBOARD SHORTCUTS                        │\n├─────────────────────────────────────────────────────────────────┤\n│                                                                  │\n│  NAVIGATION                     AGENT CONTROL                    │\n│  j/↓  Move down                 s      Spawn agent for task      │\n│  k/↑  Move up                   x      Stop selected agent       │\n│  Tab  Switch panels             r      Redirect agent            │\n│  1-9  Quick select              Enter  Assign task to agent      │\n│                                                                  │\n│  MODE CONTROL                   TASK MANAGEMENT                  │\n│  m    Toggle mode               n      New task                  │\n│  Space Pause/resume             e      Edit task                 │\n│  a    Start autopilot           b      Block task                │\n│                                 d      Mark done (manual)        │\n│                                                                  │\n│  VIEW                           RECOVERY                         │\n│  f    Fullscreen agent          R      Rollback menu             │\n│  g    Grid settings             c      Create checkpoint         │\n│  l    View logs                 u      Undo last action          │\n│  L    View learnings                                             │\n│                                                                  │\n│  GENERAL                                                         │\n│  ?    Toggle help               i      Intervention menu         │\n│  q    Quit (confirm if agents)  M      Merge queue view          │\n│                                                                  │\n└─────────────────────────────────────────────────────────────────┘\n```\n\n## API\n```typescript\n// src/components/HelpPanel.tsx (UPDATE)\n\ninterface HelpPanelProps {\n  visible: boolean;\n}\n\n// Categories:\n// NAVIGATION: j/↓, k/↑, Tab, 1-9\n// AGENT CONTROL: s, x, r, Enter\n// MODE CONTROL: m, Space, a\n// TASK MANAGEMENT: n, e, b, d\n// VIEW: f, g, l, L\n// RECOVERY: R, c, u\n// GENERAL: ?, q, i, M\n```\n\n## Files\n- src/components/HelpPanel.tsx (UPDATE existing)\n- src/components/HelpPanel.test.tsx (UPDATE existing)\n\n## Acceptance Criteria\n- [ ] Shows all 7 categories\n- [ ] Navigation: j/↓, k/↑, Tab, 1-9\n- [ ] Agent Control: s, x, r, Enter\n- [ ] Mode Control: m, Space, a\n- [ ] Task Management: n, e, b, d\n- [ ] View: f, g, l, L\n- [ ] Recovery: R, c, u\n- [ ] General: ?, q, i, M\n- [ ] Categories arranged in two columns\n- [ ] Returns null when visible=false\n- [ ] 10 tests pass\n\n## Tests\n1. Returns null when visible=false\n2. Shows NAVIGATION category shortcuts\n3. Shows AGENT CONTROL category shortcuts\n4. Shows MODE CONTROL category shortcuts\n5. Shows TASK MANAGEMENT category shortcuts\n6. Shows VIEW category shortcuts\n7. Shows RECOVERY category shortcuts\n8. Shows GENERAL category shortcuts\n9. Categories in two-column layout\n10. Shows close hint","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:51:17.970137+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:03:30.122994+03:00","labels":["m12-tui"],"dependencies":[{"issue_id":"ch-2po","depends_on_id":"ch-0ok","type":"blocks","created_at":"2026-01-10T12:51:30.181324+03:00","created_by":"deligoez"}]}
{"id":"ch-2r5","title":"F47: Rollback Types - Rollback and checkpoint interfaces","description":"## What\nDefine TypeScript interfaces for rollback and checkpoint system.\n\n## API\n```typescript\n// src/types/rollback.ts\n\ntype RollbackLevel = \n  | 'iteration'     // Level 1: Undo last N iterations\n  | 'task'          // Level 2: Undo all commits for task\n  | 'task_chain'    // Level 3: Task + dependents\n  | 'session';      // Level 4: Reset to checkpoint\n\ninterface Checkpoint {\n  id: string;\n  tag: string;        // git tag name\n  timestamp: Date;\n  type: 'autopilot_start' | 'pre_merge' | 'periodic';\n  taskId?: string;    // For pre_merge checkpoints\n}\n\ninterface CheckpointConfig {\n  enabled: boolean;\n  beforeAutopilot: boolean;\n  beforeMerge: boolean;\n  periodic: number;   // Every N completed tasks (0 = disabled)\n}\n\ninterface RollbackResult {\n  success: boolean;\n  level: RollbackLevel;\n  revertedCommits: string[];\n  affectedTasks: string[];\n  message: string;\n}\n```\n\n## Files\n- src/types/rollback.ts\n\n## Acceptance Criteria\n- [ ] `RollbackLevel` is union of 4 levels\n- [ ] `Checkpoint` has id, tag, timestamp, type fields\n- [ ] `CheckpointConfig` has enabled, beforeAutopilot, beforeMerge, periodic\n- [ ] `RollbackResult` has success, level, revertedCommits, affectedTasks\n- [ ] 5 tests pass\n\n## Tests\n1. RollbackLevel union includes all levels\n2. Checkpoint has required fields\n3. CheckpointConfig has required fields\n4. RollbackResult has required fields\n5. Types are exported correctly","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:44:16.592124+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:44:16.592124+03:00","labels":["m10-rollback"]}
{"id":"ch-3na","title":"F55b: AgentSlotsCounter Component - Display running/max agent slots","description":"## What\nDisplay agent slot usage as \"X/Y\" format with color coding based on utilization.\n\n## Context from Master Plan\n```\nCHORUS v2.0                      semi-auto ● 3/50              ? for help\n```\n\n## API\n```typescript\n// src/components/AgentSlotsCounter.tsx\n\ninterface AgentSlotsCounterProps {\n  running: number;\n  max: number;\n}\n\nfunction AgentSlotsCounter({ running, max }: AgentSlotsCounterProps): JSX.Element\n```\n\n## Visual Output\n- \"● 0/3\" - green dot, no agents running\n- \"● 2/3\" - yellow dot, some slots used\n- \"● 3/3\" - red dot, all slots full\n\n## Files\n- src/components/AgentSlotsCounter.tsx\n- src/components/AgentSlotsCounter.test.tsx\n\n## Acceptance Criteria\n- [ ] Renders \"X/Y\" format correctly (e.g., \"2/3\")\n- [ ] Shows green dot when running === 0\n- [ ] Shows yellow dot when running \u003e 0 and running \u003c max\n- [ ] Shows red dot when running === max (full)\n- [ ] Handles undefined running (defaults to 0)\n- [ ] Handles max=0 (shows \"0/0\" with gray dot)\n- [ ] 6 tests pass\n\n## Tests\n1. Renders \"0/3\" format correctly\n2. Renders \"3/3\" format correctly\n3. Shows green dot when no agents running\n4. Shows yellow dot when partially full\n5. Shows red dot when full\n6. Handles edge cases (undefined, max=0)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:48:31.76657+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:01:25.92153+03:00","labels":["m12-tui"]}
{"id":"ch-3pa","title":"F32b: RalphLoop Processing","description":"## What\nRalphLoop task processing logic: assignment loop, completion handling, error handling, safeguards.\n\n## Acceptance Criteria\n\n### Task Processing - 6 tests\n- [ ] Assigns tasks to available slots from SlotManager\n- [ ] Respects maxParallel limit (never exceeds)\n- [ ] Picks tasks by priority order (P1 \u003e P2 \u003e P3 \u003e P4)\n- [ ] Handles task completion event from Orchestrator\n- [ ] Queues merge via MergeService on completion\n- [ ] Closes task via beads CLI on completion\n\n### Dependency Chain - 1 test\n- [ ] Only assigns tasks from `bd ready` (blocked tasks never assigned)\n\n### Completion - 2 tests\n- [ ] Emits \"allDone\" when readyTasks=0 AND activeAgents=0\n- [ ] Stops loop automatically after emitting \"allDone\"\n\n### Error Handling - 2 tests\n- [ ] Emits \"error\" event on assignment failure\n- [ ] Continues loop after error (doesn't crash)\n\n### Safeguards - 6 tests\n- [ ] Stops after maxTotalTasks processed (prevents runaway)\n- [ ] Stops if no progress for idleTimeout duration (deadlock detection)\n- [ ] Alerts \"agent may be stuck\" after 5 iterations with no git commits\n- [ ] Pauses autopilot after 3 consecutive errors\n- [ ] Emits \"stuckAgent\" event with option to continue or stop\n- [ ] Emits \"errorThreshold\" event requiring human review\n\n### Summary\n- [ ] 17 tests pass\n\n## Safeguards (from plan)\n1. MAX ITERATIONS CAP: 50 iterations (per-task, in F16b)\n2. TIMEOUT PER TASK: 30 minutes (per-task, in F16b)\n3. PROGRESS DETECTION: 5 iterations no commits → alert\n4. ERROR THRESHOLD: 3 consecutive errors → pause\n\n## Dependencies\n- F32a RalphLoop Control (ch-5tj)\n\n## Files\n- src/services/RalphLoop.ts\n- tests/services/RalphLoop.test.ts","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T08:40:25.033038+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:40:04.944364+03:00","labels":["m7-autopilot"],"dependencies":[{"issue_id":"ch-3pa","depends_on_id":"ch-5tj","type":"blocks","created_at":"2026-01-10T08:40:25.03556+03:00","created_by":"deligoez"}]}
{"id":"ch-3y0","title":"F09: Agent-Task Linking - Track agent-task association","description":"## What\nAssociate spawned agents with task IDs and track in agentStore.\n\n## Acceptance Criteria\n- [ ] Agent type includes taskId, agentType, worktree, branch\n- [ ] Agent type includes iteration, startedAt\n- [ ] getAgentByTaskId() finds correct agent\n- [ ] getAgentsByType() filters correctly\n- [ ] incrementIteration() updates count\n- [ ] 5 tests pass\n\n## Files\n- src/types/agent.ts (UPDATE - add fields)\n- src/stores/agentStore.ts (UPDATE - add actions)\n- tests/stores/agentStore.test.ts (UPDATE - add tests)\n\n## Plan\nSee: thoughts/shared/plans/features/F09-agent-task-linking.md","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:38:24.319933+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:46:57.274064+03:00","labels":["m2-agent-prep"]}
{"id":"ch-49w","title":"F59d: AgentTileOutput - Status text and test results","description":"## What\nOutput section of AgentTile showing status text and test results.\n\n## Context from Master Plan\n```\n│ Reading auth...   │\n│ $ npm test        │\n│ ✓ 47 tests passed │\n```\n\n## API\n```typescript\n// src/components/AgentTileOutput.tsx\n\ninterface AgentTileOutputProps {\n  statusText?: string;      // e.g., \"Reading auth...\"\n  lastCommand?: string;     // e.g., \"npm test\"\n  testResult?: {\n    passed: number;\n    failed: number;\n  };\n}\n\nfunction AgentTileOutput({ statusText, lastCommand, testResult }: AgentTileOutputProps): JSX.Element\n```\n\n## Visual Output\n```\nReading auth...\n$ npm test\n✓ 47 tests passed\n```\n\n## Files\n- src/components/AgentTileOutput.tsx\n- src/components/AgentTileOutput.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows status text when provided\n- [ ] Shows last command with \"$\" prefix\n- [ ] Shows test result with checkmark for all pass\n- [ ] Shows test result with X for failures\n- [ ] Green checkmark when all tests pass\n- [ ] Red X and count when tests fail\n- [ ] 6 tests pass\n\n## Tests\n1. Shows status text\n2. Shows command with $ prefix\n3. Shows green checkmark for all pass\n4. Shows red X for failures\n5. Handles missing optional props\n6. Shows \"X passed, Y failed\" format","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:49:57.208382+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:02:21.692827+03:00","labels":["m12-tui"]}
{"id":"ch-5tj","title":"F32a: RalphLoop Control","description":"## What\nRalphLoop types, constructor, and control methods (start/stop/pause/resume). Foundation for autopilot loop.\n\n## Acceptance Criteria\n\n### start() - 3 tests\n- [ ] `start()` emits \"started\" event\n- [ ] `start()` begins processing task queue (sets up loop)\n- [ ] `start()` is idempotent (calling twice doesn't restart)\n\n### stop() - 3 tests\n- [ ] `stop()` stops accepting new tasks\n- [ ] `stop()` waits for active agents to complete before returning\n- [ ] `stop()` emits \"stopped\" event\n\n### pause() / resume() - 2 tests\n- [ ] `pause()` stops new task assignment without killing agents\n- [ ] `resume()` continues task assignment\n\n### Status Methods (implicit - tested via control tests)\n- `getStatus()` returns LoopStatus object\n- `isRunning()` returns boolean\n- `isPaused()` returns boolean\n\n## Dependencies\n- F15 Orchestrator Core (ch-0e7) - for task assignment\n- F16b Completion Handler Retry (ch-lhm) - for completion detection\n- F22 Slot Manager (ch-i9i) - for slot availability\n- F31 Merge Service (ch-8ee) - for merge queueing\n\n## Files\n- src/services/RalphLoop.ts (types, constructor, control methods)\n- tests/services/RalphLoop.test.ts\n\n## Plan\nSee: thoughts/shared/plans/features/F32-ralph-loop.md (F32a section)\n\n**Total: 8 tests**","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:17:43.652411+03:00","created_by":"deligoez","updated_at":"2026-01-10T08:40:11.885317+03:00","labels":["m7-autopilot"],"dependencies":[{"issue_id":"ch-5tj","depends_on_id":"ch-lhm","type":"blocks","created_at":"2026-01-10T03:17:43.655134+03:00","created_by":"deligoez"},{"issue_id":"ch-5tj","depends_on_id":"ch-i9i","type":"blocks","created_at":"2026-01-10T03:17:43.656848+03:00","created_by":"deligoez"},{"issue_id":"ch-5tj","depends_on_id":"ch-8ee","type":"blocks","created_at":"2026-01-10T03:17:43.658246+03:00","created_by":"deligoez"},{"issue_id":"ch-5tj","depends_on_id":"ch-0e7","type":"blocks","created_at":"2026-01-10T08:30:36.673504+03:00","created_by":"deligoez"}]}
{"id":"ch-70p","title":"F60b: useAgentGrid Hook - Grid calculation logic","description":"## What\nReact hook that calculates grid configuration based on terminal width and settings.\n\n## Context from Master Plan\n```json\n{\n  \"tui\": {\n    \"agentGrid\": \"auto\"  // or \"2x2\", \"2x3\", \"1x4\", etc.\n  }\n}\n\n// Auto-fit logic:\n// terminalWidth \u003c 120: 1 column\n// terminalWidth \u003c 180: 2 columns\n// else: 3+ columns\n```\n\n## API\n```typescript\n// src/hooks/useAgentGrid.ts\n\ninterface GridConfig {\n  columns: number;\n  rows: number;\n  tileWidth: number;\n}\n\nfunction useAgentGrid(\n  terminalWidth: number,\n  agentCount: number,\n  maxAgents: number,\n  configOverride?: 'auto' | '1x1' | '2x2' | '2x3' | '1x4'\n): GridConfig\n```\n\n## Files\n- src/hooks/useAgentGrid.ts\n- src/hooks/useAgentGrid.test.ts\n\n## Acceptance Criteria\n- [ ] Returns 1 column for width \u003c 120\n- [ ] Returns 2 columns for width 120-179\n- [ ] Returns 3 columns for width \u003e= 180\n- [ ] Respects \"2x2\" override (2 cols, min 2 rows)\n- [ ] Respects \"1x4\" override (1 col, min 4 rows)\n- [ ] Calculates rows: Math.ceil(maxAgents / columns)\n- [ ] Calculates tileWidth based on terminal width and columns\n- [ ] Handles undefined terminalWidth (defaults to 1 column)\n- [ ] Returns stable reference with useMemo\n- [ ] Handles zero agentCount\n- [ ] 10 tests pass\n\n## Tests\n1. Returns 1 column for width \u003c 120\n2. Returns 2 columns for width 120-179\n3. Returns 3 columns for width \u003e= 180\n4. Respects \"2x2\" config override\n5. Respects \"1x4\" config override\n6. Calculates rows correctly\n7. Calculates tileWidth correctly\n8. Handles undefined terminalWidth\n9. Returns stable reference\n10. Handles zero agentCount","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:50:50.731402+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:03:12.026876+03:00","labels":["m12-tui"]}
{"id":"ch-73t","title":"F61a: TwoColumnLayout Component - Split pane for Tasks/Agents","description":"## What\nSplit pane layout component with configurable left/right ratio for Tasks and Agents panels.\n\n## Architecture Note\n**TwoColumnLayout is used INSIDE Layout, not as a replacement**\n\nComponent hierarchy:\n```\nLayout (outer shell)\n├── HeaderBar (top)\n├── TwoColumnLayout (content area) ← THIS COMPONENT\n│   ├── TaskPanel (left 30%)\n│   └── AgentGrid (right 70%)\n└── FooterBar (bottom)\n```\n\n- Layout = app shell (border, header, footer, content area)\n- TwoColumnLayout = content area split (Tasks/Agents)\n- Update Layout.tsx to use TwoColumnLayout as its children wrapper\n\n## Context from Master Plan\n```\n│ TASKS (4)                      │ AGENTS (Tiling View)                        │\n│─────────────────────────────── │──────────────────────────────────────────── │\n│ → bd-001 [P1] Implement auth   │ ┌───────────────────┬───────────────────┐  │\n```\n\n## API\n```typescript\n// src/components/TwoColumnLayout.tsx\n\ninterface TwoColumnLayoutProps {\n  left: React.ReactNode;\n  right: React.ReactNode;\n  leftWidth?: number;      // Percentage, default 30\n  rightWidth?: number;     // Percentage, default 70\n  separator?: boolean;     // Show vertical separator, default true\n}\n\nfunction TwoColumnLayout({ left, right, leftWidth = 30, rightWidth = 70, separator = true }: TwoColumnLayoutProps): JSX.Element\n```\n\n## Visual Layout\n```\n│ [LEFT PANE 30%]  │ [RIGHT PANE 70%]                    │\n│                  │                                      │\n│ TaskPanel        │ AgentGrid                           │\n│                  │                                      │\n```\n\n## Files\n- src/components/TwoColumnLayout.tsx\n- src/components/TwoColumnLayout.test.tsx\n\n## Acceptance Criteria\n- [ ] Renders left pane content\n- [ ] Renders right pane content\n- [ ] Applies default 30/70 width ratio\n- [ ] Respects custom ratio (e.g., 50/50)\n- [ ] Shows vertical separator when separator=true\n- [ ] Hides separator when separator=false\n- [ ] Fills available height\n- [ ] Handles missing left (shows empty pane)\n- [ ] 8 tests pass\n\n## Tests\n1. Renders left pane content\n2. Renders right pane content\n3. Applies default 30/70 ratio\n4. Respects custom ratio\n5. Shows vertical separator by default\n6. Hides separator when separator=false\n7. Fills available height\n8. Handles missing left/right gracefully","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:50:52.281328+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:04:24.118032+03:00","labels":["m12-tui"]}
{"id":"ch-7gx","title":"F17: Semi-Auto Mode - User-initiated single task execution","description":"## What\nSemi-auto mode: user selects task → agent runs → completes → STOP. User can start multiple tasks in parallel (up to maxParallel slots).\n\n## Acceptance Criteria\n\n### Types\n- [ ] SemiAutoConfig: orchestrator, completionHandler, slotManager, config\n- [ ] SemiAutoStatus: activeTaskIds[], activeAgentIds[], iteration\n\n### startTask(taskId)\n- [ ] Claims slot from SlotManager before assignment\n- [ ] Assigns task via orchestrator\n- [ ] Emits \"taskStarted\" event with taskId\n- [ ] Tracks task in activeTaskIds\n- [ ] Returns error if no slots available (not reject)\n\n### cancelTask(taskId)\n- [ ] Kills specific running agent by taskId\n- [ ] Releases slot back to SlotManager\n- [ ] Removes from activeTaskIds\n- [ ] Emits \"taskCancelled\" event\n\n### cancelAll()\n- [ ] Kills all running agents\n- [ ] Releases all slots\n- [ ] Clears activeTaskIds\n- [ ] Emits \"idle\" event\n\n### Completion Handling\n- [ ] Emits \"taskCompleted\" on success\n- [ ] Releases slot on completion\n- [ ] Respawns agent on retry (under maxIterations)\n- [ ] Emits \"taskFailed\" on max iterations\n- [ ] Emits \"idle\" only when ALL tasks complete\n\n### Helper Methods\n- [ ] `getStatus()` returns current SemiAutoStatus\n- [ ] `isIdle()` returns true when activeTaskIds is empty\n- [ ] `getActiveTaskCount()` returns number of running tasks\n\n### Summary\n- [ ] 15 tests pass\n\n## Files\n- src/services/SemiAutoController.ts (NEW)\n- tests/services/SemiAutoController.test.ts (NEW)\n\n## Notes\n- DEFAULT mode (config.mode === 'semi-auto')\n- Supports MULTIPLE parallel tasks (up to maxParallel)\n- Uses SlotManager to track available slots\n- Each task runs independently\n- Enter key on task triggers startTask(selectedTaskId)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:07:06.427237+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:17:01.291078+03:00","labels":["m4-orchestration"],"dependencies":[{"issue_id":"ch-7gx","depends_on_id":"ch-0e7","type":"blocks","created_at":"2026-01-10T02:07:06.429867+03:00","created_by":"deligoez"},{"issue_id":"ch-7gx","depends_on_id":"ch-lhm","type":"blocks","created_at":"2026-01-10T02:07:06.431531+03:00","created_by":"deligoez"},{"issue_id":"ch-7gx","depends_on_id":"ch-i9i","type":"blocks","created_at":"2026-01-10T11:17:05.604847+03:00","created_by":"deligoez"}]}
{"id":"ch-7ju","title":"F14: Dependency Resolver - Check task dependencies","description":"## What\nCheck if task dependencies are satisfied before assignment.\n\n## Acceptance Criteria\n\n### check()\n- [ ] `check(id)` returns `satisfied: true` when no dependencies\n- [ ] `check(id)` returns `satisfied: true` when all deps closed\n- [ ] `check(id)` returns `pending[]` for open deps\n- [ ] `check(id)` returns `inProgress[]` for in_progress deps\n- [ ] `check(id)` returns `failed[]` for missing deps\n\n### getDependencies()\n- [ ] `getDependencies(id)` returns empty array for no deps\n- [ ] `getDependencies(id)` returns list of dependency IDs\n\n### isDependencySatisfied()\n- [ ] `isDependencySatisfied(depId)` returns true if dep is closed\n- [ ] `isDependencySatisfied(depId)` returns false if dep is open/in_progress\n\n### getDependents()\n- [ ] `getDependents(id)` returns tasks blocked by this task\n- [ ] `getDependents(id)` returns empty array if nothing blocked\n\n### hasCircularDependency()\n- [ ] `hasCircularDependency(id)` returns false for linear deps\n- [ ] `hasCircularDependency(id)` returns true for circular deps\n\n### Summary\n- [ ] DependencyStatus interface: satisfied, pending[], inProgress[], failed[]\n- [ ] 13 tests pass\n\n## Files\n- src/services/DependencyResolver.ts (NEW)\n- tests/services/DependencyResolver.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F14-dependency-resolver.md\n\n## Notes\n- Uses BeadsCLI to query task status\n- Deps stored in task.dependencies array\n- Circular dependency check uses visited set","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:06:33.869228+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:54:32.593334+03:00","labels":["m4-orchestration"],"dependencies":[{"issue_id":"ch-7ju","depends_on_id":"ch-zqi","type":"blocks","created_at":"2026-01-10T02:06:33.87357+03:00","created_by":"deligoez"}]}
{"id":"ch-7jw","title":"F16a: Completion Handler - Success path handling","description":"## What\nHandle successful task completion: detect signal + tests pass → extract learnings → close task → emit events.\n\n## Acceptance Criteria\n\n### Types\n- [ ] CompletionHandlerConfig: completionChecker, beadsCLI, worktreeService, config, scratchpadManager, learningExtractor, learningStore\n- [ ] TaskCompletionResult: taskId, agentId, success, iteration, reason, testOutput?\n\n### handleAgentExit() - Success Path\n- [ ] Returns success when signal + tests pass\n- [ ] Closes task via `beadsCLI.closeTask()`\n- [ ] Emits \"completed\" event with taskId, agentId\n- [ ] Emits \"readyForMerge\" event with taskId, branch, worktreePath\n- [ ] Returns TaskCompletionResult with success=true\n\n### handleSuccess() - Core\n- [ ] Closes task with agent comment\n- [ ] Emits \"readyForMerge\" for merge queue\n\n### handleSuccess() - Learning Extraction\n- [ ] Reads scratchpad from agent's worktree via ScratchpadManager.read()\n- [ ] Extracts learnings if learningsSection present via LearningExtractor.parse()\n- [ ] Skips extraction gracefully when no learnings section\n- [ ] Appends learnings to shared store via LearningStore.append()\n- [ ] Commits learnings with attribution via LearningStore.commit()\n- [ ] Clears scratchpad after successful extraction via ScratchpadManager.clear()\n\n### Summary\n- [ ] 9 tests pass\n\n## Files\n- src/services/CompletionHandler.ts (NEW)\n- tests/services/CompletionHandler.test.ts (NEW)\n\n## Tests\n1. handleAgentExit() returns success when signal + tests pass\n2. handleAgentExit() closes task via beadsCLI\n3. handleAgentExit() emits \"completed\" event\n4. handleAgentExit() emits \"readyForMerge\" event\n5. handleSuccess() extracts and stores learnings when present\n6. handleSuccess() skips extraction when no learnings section\n7. handleSuccess() commits learnings with attribution\n8. handleSuccess() clears scratchpad after extraction\n9. handleSuccess() handles missing scratchpad gracefully\n\n## Notes\n- Extends EventEmitter for events\n- Does NOT respawn agent (Orchestrator's job)\n- Merge queue handled by MergeService (M5)\n- Learning extraction uses F39b, F40, F41 building blocks","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:06:42.739971+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:46:10.003503+03:00","labels":["m4-orchestration"],"dependencies":[{"issue_id":"ch-7jw","depends_on_id":"ch-uoa","type":"blocks","created_at":"2026-01-10T02:06:42.742454+03:00","created_by":"deligoez"},{"issue_id":"ch-7jw","depends_on_id":"ch-dzz","type":"blocks","created_at":"2026-01-10T02:06:42.744143+03:00","created_by":"deligoez"},{"issue_id":"ch-7jw","depends_on_id":"ch-1gi","type":"blocks","created_at":"2026-01-10T11:45:49.206763+03:00","created_by":"deligoez"},{"issue_id":"ch-7jw","depends_on_id":"ch-a6h","type":"blocks","created_at":"2026-01-10T11:45:49.335553+03:00","created_by":"deligoez"}]}
{"id":"ch-7ki","title":"F59c: AgentTileProgress - Progress bar, iteration, duration","description":"## What\nMiddle section of AgentTile showing progress bar, iteration count, and elapsed time.\n\n## Context from Master Plan\n```\n│ iter 7/50 | 12m   │\n│ ▓▓▓▓░░░░░░ 35%    │\n```\n\n## API\n```typescript\n// src/components/AgentTileProgress.tsx\n\ninterface AgentTileProgressProps {\n  iteration: number;\n  maxIterations: number;\n  startTime: number;      // Unix timestamp (ms)\n  progressPercent?: number; // If not provided, calculate from iteration/max\n}\n\nfunction AgentTileProgress({ iteration, maxIterations, startTime, progressPercent }: AgentTileProgressProps): JSX.Element\n```\n\n## Visual Output\n```\niter 7/50 | 12m\n▓▓▓▓░░░░░░ 35%\n```\n\n## Files\n- src/components/AgentTileProgress.tsx\n- src/components/AgentTileProgress.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows iteration as \"iter X/Y\" format\n- [ ] Shows duration from DurationDisplay\n- [ ] Shows ProgressBar with correct percentage\n- [ ] Uses pipe separator between iter and duration\n- [ ] Calculates progress from iteration/max if not provided\n- [ ] Uses explicit progressPercent if provided\n- [ ] 6 tests pass\n\n## Tests\n1. Shows \"iter 7/50\" format\n2. Shows duration correctly\n3. Shows progress bar with correct fill\n4. Uses pipe separator\n5. Calculates progress from iteration/max\n6. Uses explicit progressPercent when provided","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:49:56.14468+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:03:06.223711+03:00","labels":["m12-tui"],"dependencies":[{"issue_id":"ch-7ki","depends_on_id":"ch-8vk","type":"blocks","created_at":"2026-01-10T12:49:56.146891+03:00","created_by":"deligoez"},{"issue_id":"ch-7ki","depends_on_id":"ch-aap","type":"blocks","created_at":"2026-01-10T12:49:56.148801+03:00","created_by":"deligoez"}]}
{"id":"ch-7pb","title":"F26: Conflict Classifier","description":"## What\nAnalyzes merge conflicts and classifies by complexity (trivial, simple, complex, semantic).\n\n## Acceptance Criteria\n\n### classifyFile() - 5 tests\n- [ ] Whitespace-only conflicts classified as `trivial`\n- [ ] Import reordering classified as `trivial`\n- [ ] Single-region, small conflict classified as `simple`\n- [ ] Multi-region conflicts classified as `complex`\n- [ ] Breaking changes classified as `semantic`\n\n### analyze() - 2 tests\n- [ ] Analyzes all given conflict files\n- [ ] Returns overall type as worst-case (semantic \u003e complex \u003e simple \u003e trivial)\n\n### getSuggestedStrategy() - 4 tests\n- [ ] Returns 'auto' for trivial with high confidence\n- [ ] Returns 'rebase' for simple\n- [ ] Returns 'agent' for complex\n- [ ] Returns 'human' for semantic\n\n### Implicit (no dedicated tests)\n- `getOverallType()` - tested via analyze() worst-case test\n- `isAutoResolvable()` - returns true when type=trivial \u0026\u0026 confidence\u003e0.8\n\n## Files\n- src/services/ConflictClassifier.ts\n- tests/services/ConflictClassifier.test.ts\n\n## Plan\nSee: thoughts/shared/plans/features/F26-conflict-classifier.md\n\n**Total: 11 tests**","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:16:29.152626+03:00","created_by":"deligoez","updated_at":"2026-01-10T08:21:49.20015+03:00","labels":["m5-merge"],"dependencies":[{"issue_id":"ch-7pb","depends_on_id":"ch-fe5","type":"blocks","created_at":"2026-01-10T03:16:29.155521+03:00","created_by":"deligoez"}]}
{"id":"ch-81x","title":"F02b: State Init/Load - Initialize or recover session state","description":"## What\nInitialize new state or load existing for recovery.\n\n## Acceptance Criteria\n- [ ] init() creates fresh state with UUID sessionId\n- [ ] init() sets startedAt timestamp and empty agents/mergeQueue\n- [ ] load() returns existing state or null\n- [ ] load() validates state structure (rejects malformed)\n- [ ] get() returns current state\n- [ ] 5 tests pass\n\n## Files\n- src/services/StateService.ts (NEW - partial)\n- tests/services/StateService.test.ts (NEW)\n\n## Implementation\n```typescript\nexport class StateService {\n  private statePath: string;\n  private state: ChorusState | null = null;\n\n  constructor(projectDir: string) {\n    this.statePath = path.join(projectDir, '.chorus', 'state.json');\n  }\n\n  init(): ChorusState {\n    this.state = {\n      version: '1.0',\n      sessionId: crypto.randomUUID(),\n      startedAt: Date.now(),\n      mode: 'semi-auto',\n      paused: false,\n      agents: {},\n      mergeQueue: [],\n      checkpoint: null,\n      stats: { tasksCompleted: 0, tasksFailed: 0, mergesAuto: 0, mergesManual: 0, totalIterations: 0, totalRuntime: 0 }\n    };\n    return this.state;\n  }\n\n  load(): ChorusState | null {\n    if (!fs.existsSync(this.statePath)) return null;\n    const data = JSON.parse(fs.readFileSync(this.statePath, 'utf-8'));\n    if (!this.isValidState(data)) throw new Error('Invalid state structure');\n    this.state = data;\n    return this.state;\n  }\n\n  get(): ChorusState {\n    if (!this.state) throw new Error('State not initialized');\n    return this.state;\n  }\n\n  private isValidState(data: unknown): data is ChorusState {\n    if (!data || typeof data !== 'object') return false;\n    const s = data as Record\u003cstring, unknown\u003e;\n    return !!(s.sessionId \u0026\u0026 s.startedAt \u0026\u0026 s.agents \u0026\u0026 s.stats);\n  }\n}\n```\n\n## Test Cases\n1. init() generates unique sessionId (UUID format)\n2. init() sets startedAt timestamp\n3. load() returns null if no file\n4. load() parses existing state\n5. load() throws on invalid/malformed state","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:30:50.906489+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:26:31.486755+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-81x","depends_on_id":"ch-ah6","type":"blocks","created_at":"2026-01-10T01:30:50.908184+03:00","created_by":"deligoez"}]}
{"id":"ch-8ee","title":"F31: Merge Service","description":"## What\nTop-level facade that orchestrates the entire merge pipeline. Simple API for RalphLoop. Also handles worktree cleanup after successful merges.\n\n## Acceptance Criteria\n\nFacade wiring tests (mocked sub-components):\n\n### enqueue() - 1 test\n- [ ] Calls `MergeQueue.enqueue()` with correct item\n\n### start() / stop() - 2 tests\n- [ ] `start()` sets running state and begins queue processing\n- [ ] `stop()` waits for current merge, then stops\n\n### getQueueStatus() / isRunning() - 2 tests\n- [ ] `getQueueStatus()` delegates to MergeQueue.getStats()\n- [ ] `isRunning()` returns correct state\n\n### Worktree Cleanup - 2 tests\n- [ ] Cleans up worktree after successful merge (direct or via auto-resolve/rebase)\n- [ ] Cleans up worktree after human-resolved merge\n\n### Events (implicit)\n- mergeStarted, mergeCompleted, mergeFailed, conflict, escalated\n\n## Dependencies\n- F05 Worktree Remove (ch-112) - worktree cleanup\n- F24 Merge Queue (ch-glf)\n- F25 Merge Worker (ch-fe5)\n- F26 Conflict Classifier (ch-7pb)\n- F27 Auto-Resolver (ch-t31)\n- F28 Rebase-Retry (ch-xn6)\n- F29 Resolver Agent (ch-9sj)\n- F30 Human Escalation (ch-26c)\n\n## Files\n- src/services/MergeService.ts\n- tests/services/MergeService.test.ts\n\n## Plan\nSee: thoughts/shared/plans/features/F31-merge-service.md\n\n**Total: 7 tests (facade wiring + worktree cleanup)**","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:17:25.914154+03:00","created_by":"deligoez","updated_at":"2026-01-10T08:38:41.135482+03:00","labels":["m5-merge"],"dependencies":[{"issue_id":"ch-8ee","depends_on_id":"ch-glf","type":"blocks","created_at":"2026-01-10T03:17:25.916827+03:00","created_by":"deligoez"},{"issue_id":"ch-8ee","depends_on_id":"ch-fe5","type":"blocks","created_at":"2026-01-10T03:17:25.918445+03:00","created_by":"deligoez"},{"issue_id":"ch-8ee","depends_on_id":"ch-7pb","type":"blocks","created_at":"2026-01-10T03:17:25.919817+03:00","created_by":"deligoez"},{"issue_id":"ch-8ee","depends_on_id":"ch-t31","type":"blocks","created_at":"2026-01-10T03:17:25.921151+03:00","created_by":"deligoez"},{"issue_id":"ch-8ee","depends_on_id":"ch-xn6","type":"blocks","created_at":"2026-01-10T03:17:25.922525+03:00","created_by":"deligoez"},{"issue_id":"ch-8ee","depends_on_id":"ch-9sj","type":"blocks","created_at":"2026-01-10T03:17:25.923867+03:00","created_by":"deligoez"},{"issue_id":"ch-8ee","depends_on_id":"ch-26c","type":"blocks","created_at":"2026-01-10T03:17:25.925216+03:00","created_by":"deligoez"},{"issue_id":"ch-8ee","depends_on_id":"ch-112","type":"blocks","created_at":"2026-01-10T08:38:29.617668+03:00","created_by":"deligoez"}]}
{"id":"ch-8j3","title":"F19: Orchestration Store - Zustand state management","description":"## What\nZustand store for orchestration state: mode, status, current task, stats.\n\n## Acceptance Criteria\n\n### Types\n- [ ] OperatingMode: 'semi-auto' | 'autopilot'\n- [ ] OrchestrationStatus: 'idle' | 'assigning' | 'running' | 'completing' | 'error'\n- [ ] OrchestrationState interface (12 properties)\n- [ ] OrchestrationActions interface (12 actions)\n\n### Mode\n- [ ] Defaults to 'semi-auto'\n- [ ] `setMode(mode)` changes mode\n\n### Status\n- [ ] `setStatus(status, error?)` sets status and optional error\n- [ ] `setIdle()` clears error and sets idle\n- [ ] `setError(error)` sets error status\n\n### Current Task\n- [ ] `setCurrentTask(taskId, agentId, agentType)` sets task details\n- [ ] `clearCurrentTask()` resets to null\n- [ ] `incrementIteration()` increments count\n\n### Stats\n- [ ] `recordCompletion(true)` increments tasksCompleted\n- [ ] `recordCompletion(false)` increments tasksFailed\n- [ ] `resetStats()` clears all stats\n\n### Autopilot\n- [ ] `setPaused(bool)` sets pause state\n- [ ] `setActiveAgentCount(n)` tracks running agents\n\n### Reset\n- [ ] `reset()` returns to initialState\n\n### Summary\n- [ ] 12 tests pass\n\n## Files\n- src/stores/orchestrationStore.ts (NEW)\n- tests/stores/orchestrationStore.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F19-orchestration-store.md\n\n## Notes\n- No dependencies (independent state store)\n- Similar pattern to agentStore, beadsStore\n- Services update store, components read","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:07:35.161308+03:00","created_by":"deligoez","updated_at":"2026-01-10T03:03:35.366181+03:00","labels":["m4-orchestration"]}
{"id":"ch-8vk","title":"F56a: ProgressBar Component - Horizontal progress bar with blocks","description":"## What\nHorizontal progress bar using Unicode block characters to show completion percentage.\n\n## Context from Master Plan\n```\n│ ▓▓▓▓░░░░░░ 35%    │\n```\n\n## API\n```typescript\n// src/components/ProgressBar.tsx\n\ninterface ProgressBarProps {\n  percent: number;       // 0-100\n  width?: number;        // Character width, default 10\n  showPercent?: boolean; // Show percentage text, default true\n}\n\nfunction ProgressBar({ percent, width = 10, showPercent = true }: ProgressBarProps): JSX.Element\n```\n\n## Visual Output\n- 0%:   `░░░░░░░░░░ 0%`\n- 35%:  `▓▓▓▓░░░░░░ 35%`\n- 100%: `▓▓▓▓▓▓▓▓▓▓ 100%`\n\n## Files\n- src/components/ProgressBar.tsx\n- src/components/ProgressBar.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows filled blocks (▓) for completed portion\n- [ ] Shows empty blocks (░) for remaining portion\n- [ ] Calculates correct number of filled blocks\n- [ ] Respects width prop\n- [ ] Shows percentage when showPercent=true\n- [ ] Hides percentage when showPercent=false\n- [ ] Clamps percent to 0-100 range\n- [ ] Handles negative percent (treats as 0)\n- [ ] Handles percent \u003e 100 (treats as 100)\n- [ ] Uses green color for high progress (\u003e80%)\n- [ ] 10 tests pass\n\n## Tests\n1. Shows 0% with all empty blocks\n2. Shows 50% with half filled blocks\n3. Shows 100% with all filled blocks\n4. Respects custom width\n5. Shows percentage text by default\n6. Hides percentage when showPercent=false\n7. Clamps negative to 0\n8. Clamps \u003e100 to 100\n9. Uses green for \u003e80%\n10. Calculates blocks correctly for various percents","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:48:33.051708+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:01:26.201882+03:00","labels":["m12-tui"]}
{"id":"ch-8w5","title":"F58a: TaskSummaryStats Component - Count tasks by status","description":"## What\nDisplay summary counts of tasks by status (done, running, pending, blocked).\n\n## Context from Master Plan\n```\n│ Tasks: 1 done, 3 running, 1 pending, 1 blocked | Merge: 1 queued | ? help   │\n```\n\n## API\n```typescript\n// src/components/TaskSummaryStats.tsx\n\ninterface TaskSummaryStatsProps {\n  done: number;\n  running: number;\n  pending: number;\n  blocked: number;\n}\n\nfunction TaskSummaryStats({ done, running, pending, blocked }: TaskSummaryStatsProps): JSX.Element\n```\n\n## Visual Output\n```\nTasks: 1 done, 3 running, 1 pending, 1 blocked\n```\n\n## Files\n- src/components/TaskSummaryStats.tsx\n- src/components/TaskSummaryStats.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows \"Tasks:\" prefix\n- [ ] Shows done count with \"done\" label\n- [ ] Shows running count with \"running\" label\n- [ ] Shows pending count with \"pending\" label\n- [ ] Shows blocked count with \"blocked\" label\n- [ ] Uses green for done count\n- [ ] Uses blue for running count\n- [ ] Uses red for blocked count\n- [ ] 8 tests pass\n\n## Tests\n1. Shows \"Tasks:\" prefix\n2. Shows all four categories\n3. Uses comma separator\n4. Green color for done\n5. Blue color for running\n6. White/default for pending\n7. Red color for blocked\n8. Handles zero counts correctly","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:49:00.890131+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:01:47.282943+03:00","labels":["m12-tui"]}
{"id":"ch-9fq","title":"F18a: useTaskSelection Hook - Task navigation and selection","description":"## What\nReact hook for task selection: up/down navigation, selection state, assign action.\n\n## Acceptance Criteria\n\n### Interface\n- [ ] UseTaskSelectionResult: selectedTaskId, selectTask, selectNext, selectPrevious, assignSelected, canAssign\n\n### Selection\n- [ ] `selectTask(id)` sets selected task ID\n- [ ] `selectNext()` cycles through ready tasks (wraps at end)\n- [ ] `selectPrevious()` cycles backwards (wraps at start)\n- [ ] Navigation skips blocked tasks (only ready tasks)\n\n### Assignment\n- [ ] `canAssign` returns true when idle AND task selected\n- [ ] `canAssign` returns false when agent is running\n- [ ] `assignSelected()` calls semiAutoController.startTask()\n\n### Summary\n- [ ] 6 tests pass\n\n## Files\n- src/hooks/useTaskSelection.ts (NEW)\n- tests/hooks/useTaskSelection.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F18-task-selection-ui.md\n\n## Notes\n- Uses useMemo to filter ready tasks\n- Works with SemiAutoController for assignment","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:07:14.369577+03:00","created_by":"deligoez","updated_at":"2026-01-10T03:01:57.738763+03:00","labels":["m4-orchestration"],"dependencies":[{"issue_id":"ch-9fq","depends_on_id":"ch-7gx","type":"blocks","created_at":"2026-01-10T02:07:14.372007+03:00","created_by":"deligoez"}]}
{"id":"ch-9sj","title":"F29: Resolver Agent","description":"## What\nSpawns Claude agent to resolve complex merge conflicts that can't be auto-resolved.\n\n## Acceptance Criteria\n\n### resolve() - 6 tests\n- [ ] Spawns agent with conflict resolution prompt\n- [ ] Returns `{ success: true, resolved: true }` when agent resolves\n- [ ] Returns `{ needsHuman: true }` after maxAttempts failures\n- [ ] Emits 'resolving' event when agent starts\n- [ ] Emits 'resolved' event on successful resolution\n- [ ] Emits 'failed' event after maxAttempts failures\n\n### buildPrompt() - 2 tests\n- [ ] Includes all conflicting file contents\n- [ ] Includes conflict analysis for context\n\n### verifyResolution() - 1 test\n- [ ] Returns `true` when no conflict markers remain\n\n### Implicit (no dedicated tests)\n- `cancel()` - kills running agent process\n\n## Files\n- src/services/ResolverAgent.ts\n- tests/services/ResolverAgent.test.ts\n\n## Plan\nSee: thoughts/shared/plans/features/F29-resolver-agent.md\n\n**Total: 9 tests**","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:16:59.889097+03:00","created_by":"deligoez","updated_at":"2026-01-10T08:26:07.636534+03:00","labels":["m5-merge"],"dependencies":[{"issue_id":"ch-9sj","depends_on_id":"ch-xn6","type":"blocks","created_at":"2026-01-10T03:16:59.891451+03:00","created_by":"deligoez"}]}
{"id":"ch-9yl","title":"F40: Learning Extractor - Parse learnings from scratchpad content","description":"## What\nParse learnings section content into structured Learning objects.\n\n## API\n```typescript\n// src/services/LearningExtractor.ts\n\nclass LearningExtractor {\n  /**\n   * Parse markdown learnings section into Learning objects\n   * @param content Raw learnings markdown section\n   * @param taskId Source task ID\n   * @param agentType Source agent type\n   * @returns Array of parsed Learning objects\n   */\n  parse(content: string, taskId: string, agentType: AgentType): Learning[]\n\n  /**\n   * Detect category from learning content or heading\n   * @returns Category string\n   */\n  detectCategory(text: string): string\n\n  /**\n   * Format learning for appending to learnings.md\n   */\n  formatForStorage(learning: Learning): string\n}\n```\n\n## Format Expected\n```markdown\n## Learnings\n\n### Performance\n- mb_str_split() \u003e preg_split() for Unicode (3x faster)\n\n### Testing\n- Use Pest's dataset() for parameterized tests\n```\n\n## Files\n- src/services/LearningExtractor.ts\n- tests/services/LearningExtractor.test.ts\n\n## Acceptance Criteria\n- [ ] `parse()` extracts bullet points as individual learnings\n- [ ] `parse()` assigns correct category from heading\n- [ ] `parse()` sets source with taskId, agentType, timestamp\n- [ ] `detectCategory()` returns category from heading context\n- [ ] `detectCategory()` returns 'general' for unknown\n- [ ] `formatForStorage()` outputs markdown with attribution\n- [ ] 7 tests pass\n\n## Tests\n1. parse() extracts bullet points as learnings\n2. parse() assigns category from ### heading\n3. parse() sets source fields correctly\n4. parse() returns empty array for empty content\n5. detectCategory() identifies known categories\n6. detectCategory() returns 'general' for unknown\n7. formatForStorage() includes attribution comment","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:42:43.052343+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:42:43.052343+03:00","labels":["m8-memory"],"dependencies":[{"issue_id":"ch-9yl","depends_on_id":"ch-uxk","type":"blocks","created_at":"2026-01-10T10:42:43.05388+03:00","created_by":"deligoez"}]}
{"id":"ch-a6h","title":"F41: Learning Store - Append learnings to shared file","description":"## What\nAppend extracted learnings to .agent/learnings.md and commit.\n\n## API\n```typescript\n// src/services/LearningStore.ts\n\nclass LearningStore {\n  constructor(private repoPath: string = '.') {}\n\n  /**\n   * Path to learnings file\n   */\n  readonly learningsPath = '.agent/learnings.md'\n\n  /**\n   * Append learnings to shared file\n   * @param learnings Array of Learning objects to append\n   */\n  async append(learnings: Learning[]): Promise\u003cvoid\u003e\n\n  /**\n   * Commit the learnings file\n   * @param taskId Source task for commit message\n   * @param agentType Source agent for commit message\n   */\n  async commit(taskId: string, agentType: AgentType): Promise\u003cvoid\u003e\n\n  /**\n   * Read all learnings from file\n   * @returns Map of category -\u003e learnings\n   */\n  async readAll(): Promise\u003cMap\u003cstring, Learning[]\u003e\u003e\n\n  /**\n   * Get learnings by category\n   */\n  async getByCategory(category: string): Promise\u003cLearning[]\u003e\n\n  /**\n   * Ensure .agent directory and learnings.md exist\n   */\n  async ensureExists(): Promise\u003cvoid\u003e\n}\n```\n\n## Files\n- src/services/LearningStore.ts\n- tests/services/LearningStore.test.ts\n\n## Acceptance Criteria\n- [ ] `append()` adds formatted learnings to end of file\n- [ ] `append()` preserves existing content\n- [ ] `commit()` creates commit with \"learn: extract from {taskId} ({agent})\"\n- [ ] `readAll()` parses existing learnings into Map\n- [ ] `getByCategory()` filters by category\n- [ ] `ensureExists()` creates .agent/learnings.md if missing\n- [ ] 7 tests pass\n\n## Tests\n1. append() adds learnings to file\n2. append() preserves existing content\n3. commit() creates properly formatted commit\n4. readAll() returns Map of categories\n5. getByCategory() filters correctly\n6. ensureExists() creates directory and file\n7. ensureExists() is idempotent","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:42:53.486064+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:42:53.486064+03:00","labels":["m8-memory"],"dependencies":[{"issue_id":"ch-a6h","depends_on_id":"ch-9yl","type":"blocks","created_at":"2026-01-10T10:42:53.487551+03:00","created_by":"deligoez"}]}
{"id":"ch-aap","title":"F56b: DurationDisplay Component - Format elapsed time","description":"## What\nFormat and display elapsed time from a start timestamp in human-readable format.\n\n## Context from Master Plan\n```\n│ iter 7/50 | 12m   │\n```\n\n## API\n```typescript\n// src/components/DurationDisplay.tsx\n\ninterface DurationDisplayProps {\n  startTime: number;     // Unix timestamp in ms\n  now?: number;          // Current time for testing, defaults to Date.now()\n}\n\nfunction DurationDisplay({ startTime, now }: DurationDisplayProps): JSX.Element\n```\n\n## Visual Output\n- \u003c 1 minute: `\u003c 1m`\n- 1-59 minutes: `12m`\n- 60+ minutes: `1h 15m`\n- 24+ hours: `1d 2h`\n\n## Files\n- src/components/DurationDisplay.tsx\n- src/components/DurationDisplay.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows \"\u003c 1m\" for durations under 1 minute\n- [ ] Shows \"Xm\" for minutes (1-59)\n- [ ] Shows \"Xh Ym\" for hours\n- [ ] Shows \"Xd Yh\" for days\n- [ ] Uses dimColor for the unit letters\n- [ ] Handles future startTime (shows \"0m\")\n- [ ] Updates correctly with changing now prop\n- [ ] Has gray/dim color styling\n- [ ] 8 tests pass\n\n## Tests\n1. Shows \"\u003c 1m\" for 30 seconds\n2. Shows \"1m\" for 60 seconds\n3. Shows \"12m\" for 720 seconds\n4. Shows \"1h 0m\" for 3600 seconds\n5. Shows \"1h 15m\" for 4500 seconds\n6. Shows \"1d 2h\" for 93600 seconds\n7. Handles future startTime\n8. Uses dimColor styling","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:48:34.393767+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:01:26.456655+03:00","labels":["m12-tui"]}
{"id":"ch-ah6","title":"F02a: State Types - ChorusState interface and SessionStats","description":"## What\nDefine TypeScript types for runtime state.\n\n## Acceptance Criteria\n- [ ] AgentStatus: 'idle' | 'running' | 'paused' | 'error'\n- [ ] MergeQueueItemStatus: 'pending' | 'merging' | 'conflict' | 'resolving'\n- [ ] AgentState interface with all fields\n- [ ] MergeQueueItem interface with all fields\n- [ ] SessionStats interface with all fields\n- [ ] ChorusState interface combining all\n- [ ] 4 tests pass\n\n## Files\n- src/types/state.ts (NEW)\n\n## Implementation\n```typescript\nexport type AgentStatus = 'idle' | 'running' | 'paused' | 'error';\nexport type MergeQueueItemStatus = 'pending' | 'merging' | 'conflict' | 'resolving';\n\nexport interface AgentState {\n  id: string;\n  type: 'claude' | 'codex' | 'opencode';\n  pid: number;\n  taskId: string;\n  worktree: string;\n  branch: string;\n  iteration: number;\n  startedAt: number;\n  status: AgentStatus;\n}\n\nexport interface MergeQueueItem {\n  taskId: string;\n  branch: string;\n  worktree: string;\n  priority: number;\n  status: MergeQueueItemStatus;\n  retries: number;\n  enqueuedAt: number;\n}\n\nexport interface SessionStats {\n  tasksCompleted: number;\n  tasksFailed: number;\n  mergesAuto: number;\n  mergesManual: number;\n  totalIterations: number;\n  totalRuntime: number;\n}\n\nexport interface ChorusState {\n  version: string;\n  sessionId: string;\n  mode: 'semi-auto' | 'autopilot';\n  paused: boolean;\n  agents: Record\u003cstring, AgentState\u003e;\n  mergeQueue: MergeQueueItem[];\n  checkpoint: string | null;\n  stats: SessionStats;\n}\n```\n\n## Test Cases\n1. AgentState type compiles with valid object\n2. MergeQueueItem type compiles with valid object\n3. SessionStats type compiles with valid object\n4. ChorusState type compiles with complete state","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:30:38.527356+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:12:24.394616+03:00","labels":["m1-infrastructure"]}
{"id":"ch-ahq","title":"F43a: Intervention Types - Intervention interfaces and enums","description":"## What\nDefine TypeScript interfaces for human intervention system.\n\n## API\n```typescript\n// src/types/intervention.ts\n\ntype InterventionType = \n  | 'pause'\n  | 'stop_agent'\n  | 'redirect_agent'\n  | 'edit_task'\n  | 'kill_all'\n  | 'rollback'\n  | 'block_task'\n  | 'approve_merge';\n\ninterface InterventionState {\n  paused: boolean;\n  pausedAt: Date | null;\n  pendingInterventions: Intervention[];\n}\n\ninterface Intervention {\n  type: InterventionType;\n  targetAgentId?: string;\n  targetTaskId?: string;\n  timestamp: Date;\n  reason?: string;\n}\n\ninterface InterventionResult {\n  success: boolean;\n  type: InterventionType;\n  message: string;\n  affectedAgents?: string[];\n  affectedTasks?: string[];\n}\n```\n\n## Files\n- src/types/intervention.ts\n\n## Acceptance Criteria\n- [ ] `InterventionType` is union of all 8 intervention types\n- [ ] `InterventionState` has paused, pausedAt, pendingInterventions\n- [ ] `Intervention` has type, optional targets, timestamp, reason\n- [ ] `InterventionResult` has success, type, message, affected lists\n- [ ] 5 tests pass\n\n## Tests\n1. InterventionType union includes all types\n2. InterventionState has required fields\n3. Intervention has required and optional fields\n4. InterventionResult has required fields\n5. Types are exported correctly","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:43:19.149013+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:43:19.149013+03:00","labels":["m9-intervention"]}
{"id":"ch-amw","title":"F57a: HeaderBar Component - Full header with all elements","description":"## What\nComplete header bar composing title, version, ModeIndicator, AgentSlotsCounter, and help hint.\n\n## Migration Note\n**This component replaces the top portion of existing StatusBar.tsx**\n- Existing: StatusBar shows \"Chorus\" + counts + quit hint\n- New: HeaderBar shows version, mode, slots, help hint\n- After implementing HeaderBar, update Layout.tsx to use HeaderBar instead of StatusBar\n\n## Context from Master Plan\n```\n┌───────────────────────────────────────────────────────────────────────────┐\n│ CHORUS v2.0                      semi-auto ● 3/50              ? for help │\n└───────────────────────────────────────────────────────────────────────────┘\n```\n\n## API\n```typescript\n// src/components/HeaderBar.tsx\n\ninterface HeaderBarProps {\n  version?: string;         // e.g., \"2.0\"\n  mode: 'semi-auto' | 'autopilot';\n  runningAgents: number;\n  maxAgents: number;\n  showHelp?: boolean;       // default true\n}\n\nfunction HeaderBar({ version, mode, runningAgents, maxAgents, showHelp = true }: HeaderBarProps): JSX.Element\n```\n\n## Visual Layout\n```\nCHORUS v2.0                      semi-auto ● 3/50              ? for help\n[title] [version]                [ModeIndicator] [AgentSlotsCounter]        [help hint]\n```\n\n## Files\n- src/components/HeaderBar.tsx\n- src/components/HeaderBar.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows \"CHORUS\" title in bold cyan\n- [ ] Shows version (e.g., \"v2.0\") when provided\n- [ ] Shows ModeIndicator with correct mode\n- [ ] Shows AgentSlotsCounter with correct counts\n- [ ] Shows \"? for help\" hint when showHelp=true\n- [ ] All elements horizontally spaced correctly\n- [ ] Title on left, mode/slots in center, help on right\n- [ ] Handles missing version gracefully\n- [ ] Hides help hint when showHelp=false\n- [ ] Fills available width (uses space-between)\n- [ ] 10 tests pass\n\n## Tests\n1. Shows \"CHORUS\" title\n2. Shows version when provided\n3. Hides version when not provided\n4. Shows ModeIndicator with semi-auto\n5. Shows ModeIndicator with autopilot\n6. Shows AgentSlotsCounter with correct counts\n7. Shows help hint by default\n8. Hides help hint when showHelp=false\n9. Elements are horizontally aligned\n10. Fills available width","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:48:59.83796+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:04:02.077759+03:00","labels":["m12-tui"],"dependencies":[{"issue_id":"ch-amw","depends_on_id":"ch-mnd","type":"blocks","created_at":"2026-01-10T12:48:59.840343+03:00","created_by":"deligoez"},{"issue_id":"ch-amw","depends_on_id":"ch-3na","type":"blocks","created_at":"2026-01-10T12:48:59.842325+03:00","created_by":"deligoez"}]}
{"id":"ch-b5x","title":"F52: Hook Types - Hook event and handler interfaces","description":"## What\nDefine TypeScript interfaces for the Chorus hooks system.\n\n## API\n```typescript\n// src/types/hooks.ts\n\ntype HookEvent = \n  | 'pre-agent-start'\n  | 'post-agent-start'\n  | 'pre-task-claim'\n  | 'post-task-claim'\n  | 'pre-iteration'\n  | 'post-iteration'\n  | 'pre-task-complete'\n  | 'post-task-complete'\n  | 'pre-merge'\n  | 'post-merge'\n  | 'on-agent-error'\n  | 'on-agent-timeout'\n  | 'on-conflict';\n\ninterface HookInput {\n  event: HookEvent;\n  agent?: {\n    id: string;\n    type: AgentType;\n    worktree: string;\n  };\n  task?: {\n    id: string;\n    title: string;\n    status: string;\n  };\n  iteration?: {\n    number: number;\n    maxIterations: number;\n  };\n  output?: {\n    stdout: string;\n    exitCode: number;\n  };\n}\n\ninterface HookOutput {\n  result: 'continue' | 'block' | 'complete';\n  message?: string;\n}\n\ninterface HookHandler {\n  event: HookEvent;\n  command: string;\n  timeout?: number;\n}\n```\n\n## Files\n- src/types/hooks.ts\n\n## Acceptance Criteria\n- [ ] `HookEvent` is union of all 13 event types\n- [ ] `HookInput` has event, optional agent/task/iteration/output\n- [ ] `HookOutput` has result and optional message\n- [ ] `HookHandler` has event, command, optional timeout\n- [ ] Result type is union of continue/block/complete\n- [ ] 5 tests pass\n\n## Tests\n1. HookEvent union includes all events\n2. HookInput has required and optional fields\n3. HookOutput has required fields\n4. HookHandler has required fields\n5. Types are exported correctly","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:45:17.738244+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:45:17.738244+03:00","labels":["m11-hooks"]}
{"id":"ch-c2p","title":"F59e: AgentTile Composed - Complete agent tile component","description":"## What\nComplete AgentTile composing header, progress, and output sections.\n\n## Context from Master Plan\n```\n┌───────────────────┐\n│ CLAUDE (ch-001)   │\n│ iter 7/50 | 12m   │\n│ ▓▓▓▓░░░░░░ 35%    │\n│                   │\n│ Reading auth...   │\n│ $ npm test        │\n│ ✓ 47 tests passed │\n└───────────────────┘\n```\n\n## API\n```typescript\n// src/components/AgentTile.tsx\n\ninterface AgentTileProps {\n  agent: {\n    id: string;\n    type: 'claude' | 'codex' | 'opencode';\n    taskId: string;\n    status: 'running' | 'idle' | 'paused' | 'error';\n    iteration: number;\n    maxIterations: number;\n    startTime: number;\n    statusText?: string;\n    lastCommand?: string;\n    testResult?: { passed: number; failed: number; };\n  };\n  isSelected?: boolean;\n  width?: number;\n}\n\nfunction AgentTile({ agent, isSelected = false, width }: AgentTileProps): JSX.Element\n```\n\n## Files\n- src/components/AgentTile.tsx\n- src/components/AgentTile.test.tsx\n\n## Acceptance Criteria\n- [ ] Composes AgentTileHeader, AgentTileProgress, AgentTileOutput\n- [ ] Has single border by default\n- [ ] Has double border with cyan color when selected\n- [ ] Shows all sections in vertical layout\n- [ ] Handles missing optional fields gracefully\n- [ ] Shows \"starting...\" when iteration=0\n- [ ] Shows error styling when status='error'\n- [ ] Respects width prop\n- [ ] 8 tests pass\n\n## Tests\n1. Shows header with type and taskId\n2. Shows progress with iteration and duration\n3. Shows output section\n4. Has single border by default\n5. Has double cyan border when selected\n6. Shows \"starting...\" when iteration=0\n7. Shows error styling when status='error'\n8. Handles missing optional fields","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:49:58.609321+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:06:42.939172+03:00","labels":["m12-tui"],"dependencies":[{"issue_id":"ch-c2p","depends_on_id":"ch-j0z","type":"blocks","created_at":"2026-01-10T12:49:58.611565+03:00","created_by":"deligoez"},{"issue_id":"ch-c2p","depends_on_id":"ch-7ki","type":"blocks","created_at":"2026-01-10T12:50:18.171974+03:00","created_by":"deligoez"},{"issue_id":"ch-c2p","depends_on_id":"ch-49w","type":"blocks","created_at":"2026-01-10T12:50:18.263337+03:00","created_by":"deligoez"}]}
{"id":"ch-c8j","title":"F49: Iteration Rollback - Undo last N agent iterations","description":"## What\nRollback last N iterations of an agent's work (Level 1 rollback).\n\n## API\n```typescript\n// src/services/IterationRollback.ts\n\nclass IterationRollback {\n  /**\n   * Undo last N iterations for an agent\n   * Uses git reset --soft HEAD~N in agent's worktree\n   * @param worktreePath Path to agent's worktree\n   * @param iterations Number of iterations to undo\n   */\n  async rollback(worktreePath: string, iterations: number): Promise\u003cRollbackResult\u003e\n\n  /**\n   * Count commits in current iteration batch\n   * @returns Number of commits since last checkpoint\n   */\n  async getIterationCommitCount(worktreePath: string): Promise\u003cnumber\u003e\n\n  /**\n   * Find commits belonging to specific iteration\n   */\n  async findIterationCommits(worktreePath: string, iterationNumber: number): Promise\u003cstring[]\u003e\n}\n```\n\n## Files\n- src/services/IterationRollback.ts\n- tests/services/IterationRollback.test.ts\n\n## Acceptance Criteria\n- [ ] `rollback()` runs git reset --soft HEAD~N\n- [ ] `rollback()` works in worktree context\n- [ ] `rollback()` returns RollbackResult with commit list\n- [ ] `rollback()` fails gracefully if N \u003e commit count\n- [ ] `getIterationCommitCount()` counts recent commits\n- [ ] `findIterationCommits()` identifies commits by message pattern\n- [ ] 6 tests pass\n\n## Tests\n1. rollback() resets correct number of commits\n2. rollback() returns reverted commit hashes\n3. rollback() handles N \u003e commit count\n4. rollback() preserves working directory changes\n5. getIterationCommitCount() counts correctly\n6. findIterationCommits() filters by pattern","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:44:38.327782+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:44:38.327782+03:00","labels":["m10-rollback"],"dependencies":[{"issue_id":"ch-c8j","depends_on_id":"ch-2r5","type":"blocks","created_at":"2026-01-10T10:44:38.329783+03:00","created_by":"deligoez"}]}
{"id":"ch-cg0","title":"F02c: State Agent Ops - Add/update/remove agents","description":"## What\nManage agent entries in ChorusState.agents with CRUD operations and iteration tracking.\n\n## Acceptance Criteria\n\n### CRUD Operations - 4 tests\n- [ ] `addAgent(agent)` adds AgentState to state.agents\n- [ ] `updateAgent(id, partial)` modifies existing agent\n- [ ] `removeAgent(id)` deletes agent from state\n- [ ] `getAgent(id)` returns agent or undefined\n\n### Iteration Management - 2 tests\n- [ ] `incrementIteration(id)` increments agent.iteration\n- [ ] `incrementIteration(id)` returns new iteration count\n\n### Status Updates - 2 tests\n- [ ] `setStatus(id, status)` updates agent.status\n- [ ] `getRunningAgents()` returns agents with status='running'\n\n### Summary\n- [ ] 8 tests pass\n\n## Files\n- src/services/StateService.ts (UPDATE - add agent methods)\n- tests/services/StateService.test.ts (UPDATE)\n\n## API\n```typescript\nclass StateService {\n  // Agent operations\n  addAgent(agent: AgentState): void;\n  updateAgent(id: string, partial: Partial\u003cAgentState\u003e): void;\n  removeAgent(id: string): void;\n  getAgent(id: string): AgentState | undefined;\n  \n  // Iteration\n  incrementIteration(id: string): number;\n  \n  // Status\n  setStatus(id: string, status: AgentStatus): void;\n  getRunningAgents(): AgentState[];\n}\n```","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:30:50.982849+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:34:08.565188+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-cg0","depends_on_id":"ch-ah6","type":"blocks","created_at":"2026-01-10T01:30:50.984583+03:00","created_by":"deligoez"},{"issue_id":"ch-cg0","depends_on_id":"ch-81x","type":"blocks","created_at":"2026-01-10T01:37:13.386589+03:00","created_by":"deligoez"}]}
{"id":"ch-cwy","title":"F44: Agent Stop - Kill agent and stash worktree changes","description":"## What\nStop a specific agent, stash its worktree changes, return task to pending.\n\n## API\n\\`\\`\\`typescript\n// src/services/AgentStopper.ts\n\nclass AgentStopper {\n  constructor(\n    private slotManager: SlotManager,\n    private beadsCLI: BeadsCLI\n  ) {}\n\n  /**\n   * Stop specific agent by ID\n   * - Kill agent process\n   * - Stash worktree changes (git stash in worktree dir)\n   * - Return task to pending via beadsCLI.releaseTask()\n   */\n  async stopAgent(agentId: string): Promise\u003cInterventionResult\u003e\n\n  /**\n   * Stop agent working on a specific task\n   * - Find agent via slotManager.getAgentForTask()\n   * - If found, call stopAgent()\n   * - Returns null if no agent working on task\n   */\n  async stopAgentByTask(taskId: string): Promise\u003cInterventionResult | null\u003e\n\n  /**\n   * Get agent working on a task (if any)\n   */\n  getAgentForTask(taskId: string): AgentSlot | null\n\n  /**\n   * Stop all agents (emergency - KILL ALL Ctrl+C)\n   * - Kill all agent processes\n   * - Stash all worktree changes\n   * - All tasks to pending\n   * - Worktrees preserved (not deleted)\n   */\n  async stopAll(): Promise\u003cInterventionResult\u003e\n\n  /**\n   * Stash changes in agent's worktree\n   * Uses git stash in the worktree directory\n   */\n  async stashWorktreeChanges(worktreePath: string): Promise\u003cvoid\u003e\n}\n\\`\\`\\`\n\n## Files\n- src/services/AgentStopper.ts\n- tests/services/AgentStopper.test.ts\n\n## Acceptance Criteria\n- [ ] \\`stopAgent()\\` kills the agent process (process.kill or SIGTERM)\n- [ ] \\`stopAgent()\\` stashes uncommitted changes via git stash\n- [ ] \\`stopAgent()\\` calls beadsCLI.releaseTask() to return task to pending\n- [ ] \\`stopAgent()\\` releases the slot in SlotManager\n- [ ] \\`stopAgent()\\` returns error if agent not found\n- [ ] \\`stopAgentByTask()\\` returns null if no agent on task\n- [ ] \\`stopAgentByTask()\\` calls stopAgent() if agent found\n- [ ] \\`getAgentForTask()\\` queries SlotManager correctly\n- [ ] \\`stopAll()\\` stops all running agents\n- [ ] \\`stopAll()\\` returns affected agents count in result\n- [ ] \\`stashWorktreeChanges()\\` runs git stash in worktree directory\n- [ ] \\`stashWorktreeChanges()\\` handles no changes gracefully\n- [ ] 12 tests pass\n\n## Tests\n1. stopAgent() kills process\n2. stopAgent() stashes changes\n3. stopAgent() calls releaseTask()\n4. stopAgent() releases slot\n5. stopAgent() errors for unknown agent\n6. stopAgentByTask() returns null when no agent\n7. stopAgentByTask() stops agent when found\n8. getAgentForTask() returns slot when found\n9. getAgentForTask() returns null when not found\n10. stopAll() stops all agents\n11. stashWorktreeChanges() creates stash\n12. stashWorktreeChanges() handles no changes","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:43:39.672942+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:16:14.895234+03:00","labels":["m9-intervention"],"dependencies":[{"issue_id":"ch-cwy","depends_on_id":"ch-ahq","type":"blocks","created_at":"2026-01-10T10:43:39.674465+03:00","created_by":"deligoez"},{"issue_id":"ch-cwy","depends_on_id":"ch-i9i","type":"blocks","created_at":"2026-01-10T10:43:39.675677+03:00","created_by":"deligoez"},{"issue_id":"ch-cwy","depends_on_id":"ch-zqi","type":"blocks","created_at":"2026-01-10T12:14:12.921751+03:00","created_by":"deligoez"}]}
{"id":"ch-ddk","title":"F45: Agent Redirect - Reassign agent to different task","description":"## What\nRedirect a running agent to work on a different task.\n\n## Context from Master Plan\n\\`\\`\\`\n3. REDIRECT AGENT (r)\n   - Assign current agent to different task\n   - Current task goes back to pending\n   - Useful when agent stuck on wrong approach\n\\`\\`\\`\n\n## API\n\\`\\`\\`typescript\n// src/services/AgentRedirector.ts\n\nclass AgentRedirector {\n  constructor(\n    private agentStopper: AgentStopper,\n    private beadsCLI: BeadsCLI,\n    private orchestrator: Orchestrator\n  ) {}\n\n  /**\n   * Redirect agent to new task\n   * - Stop current work via AgentStopper (stash changes, release task)\n   * - Claim new task via BeadsCLI.claimTask()\n   * - Restart agent with new task via Orchestrator.spawnAgentForTask()\n   */\n  async redirect(agentId: string, newTaskId: string): Promise\u003cInterventionResult\u003e\n\n  /**\n   * Validate redirect is possible\n   * - Agent exists and running (check SlotManager via AgentStopper)\n   * - New task is available (status=open, no blocker deps)\n   */\n  async canRedirect(agentId: string, newTaskId: string): Promise\u003cboolean\u003e\n}\n\\`\\`\\`\n\n## Files\n- src/services/AgentRedirector.ts\n- tests/services/AgentRedirector.test.ts\n\n## Acceptance Criteria\n- [ ] \\`redirect()\\` calls agentStopper.stopAgent() to stop current work\n- [ ] \\`redirect()\\` verifies new task is available before proceeding\n- [ ] \\`redirect()\\` calls beadsCLI.claimTask() for new task\n- [ ] \\`redirect()\\` calls orchestrator.spawnAgentForTask() to restart\n- [ ] \\`redirect()\\` returns InterventionResult with affected task IDs\n- [ ] \\`redirect()\\` fails if new task is blocked or in_progress\n- [ ] \\`canRedirect()\\` returns false for unknown agent\n- [ ] \\`canRedirect()\\` returns false for unavailable task\n- [ ] 8 tests pass\n\n## Tests\n1. redirect() stops current work via agentStopper\n2. redirect() claims new task\n3. redirect() spawns agent for new task\n4. redirect() returns both old and new task in result\n5. redirect() fails for blocked task\n6. redirect() fails for unknown agent\n7. canRedirect() returns true when both valid\n8. canRedirect() returns false for invalid","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:43:50.867286+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:15:18.243535+03:00","labels":["m9-intervention"],"dependencies":[{"issue_id":"ch-ddk","depends_on_id":"ch-cwy","type":"blocks","created_at":"2026-01-10T10:43:50.868803+03:00","created_by":"deligoez"},{"issue_id":"ch-ddk","depends_on_id":"ch-zqi","type":"blocks","created_at":"2026-01-10T10:43:50.869973+03:00","created_by":"deligoez"},{"issue_id":"ch-ddk","depends_on_id":"ch-0e7","type":"blocks","created_at":"2026-01-10T12:08:31.917833+03:00","created_by":"deligoez"}]}
{"id":"ch-di6","title":"F46c: Intervention Panel - TUI modal for intervention actions","description":"## What\nTUI modal component that displays active agents and provides keybindings for intervention actions.\n\n## Context from Master Plan\n\\`\\`\\`\n┌─────────────────────────────────────────────────────────────────┐\n│              INTERVENTION DIALOG (Press 'i')                     │\n├─────────────────────────────────────────────────────────────────┤\n│                                                                  │\n│ Active Agents:                                                   │\n│   1. claude (bd-001) - iter 7/50 - running 12m                   │\n│   2. codex (bd-002) - iter 3/50 - running 5m                     │\n│                                                                  │\n│ Actions:                                                         │\n│   [p] Pause all      - Stop after current iterations             │\n│   [1] Focus claude   - View full output                          │\n│   [2] Focus codex    - View full output                          │\n│   [x] Stop agent     - Select which to stop                      │\n│   [r] Redirect       - Assign to different task                  │\n│   [e] Edit task      - Modify task and restart agent             │\n│   [b] Block task     - Mark task as blocked                      │\n│   [ESC] Close        - Return to main view                       │\n│                                                                  │\n└─────────────────────────────────────────────────────────────────┘\n\\`\\`\\`\n\n## API\n\\`\\`\\`typescript\n// src/components/InterventionPanel.tsx\n\ninterface InterventionPanelProps {\n  visible: boolean;\n  onClose: () =\u003e void;\n  onFocusAgent?: (agentId: string) =\u003e void;\n}\n\nfunction InterventionPanel({ visible, onClose, onFocusAgent }: InterventionPanelProps): JSX.Element | null\n\n// State:\n// - Gets agent list from OrchestrationStore (F19)\n// - Gets pause state from PauseHandler\n\n// Keybindings:\n// 'p' - Toggle pause (calls PauseHandler)\n// '1'-'9' - Focus agent by index (calls onFocusAgent)\n// 'x' - Enter stop-agent mode (select which to stop)\n// 'r' - Enter redirect mode (select agent, then task)\n// 'e' - Enter edit-task mode (select task to edit)\n// 'b' - Enter block-task mode (select task to block)\n// ESC - Close panel\n\n// Note: Rollback ('R') is deferred to M10 integration\n\\`\\`\\`\n\n## Files\n- src/components/InterventionPanel.tsx\n- tests/components/InterventionPanel.test.tsx\n\n## Acceptance Criteria\n- [ ] Panel renders when \\`visible=true\\`, returns null when false\n- [ ] Gets active agents from OrchestrationStore\n- [ ] Displays agent list with: type, taskId, iteration, duration\n- [ ] Shows action keybindings with descriptions\n- [ ] 'p' key toggles pause via PauseHandler\n- [ ] Number keys call onFocusAgent with correct agentId\n- [ ] 'x' key enters stop-agent selection mode\n- [ ] 'r' key enters redirect selection mode\n- [ ] 'e' key enters edit-task selection mode\n- [ ] 'b' key enters block-task selection mode\n- [ ] ESC key calls onClose\n- [ ] Panel styled as modal overlay (Box with border)\n- [ ] 12 tests pass\n\n## Tests\n1. Panel returns null when visible=false\n2. Panel renders agent list when visible=true\n3. Panel shows agent type and taskId\n4. Panel shows iteration count\n5. Panel shows running duration\n6. 'p' key toggles pause state\n7. Number key calls onFocusAgent\n8. 'x' key enters stop selection mode\n9. 'r' key enters redirect selection mode\n10. 'e' key enters edit selection mode\n11. 'b' key enters block selection mode\n12. ESC key calls onClose\n\n## Deferred\n- Rollback ('R') key - integrate when M10 is available","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:07:58.830452+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:18:50.573665+03:00","labels":["m9-intervention"],"dependencies":[{"issue_id":"ch-di6","depends_on_id":"ch-ahq","type":"blocks","created_at":"2026-01-10T12:07:58.832997+03:00","created_by":"deligoez"},{"issue_id":"ch-di6","depends_on_id":"ch-fna","type":"blocks","created_at":"2026-01-10T12:07:58.834828+03:00","created_by":"deligoez"},{"issue_id":"ch-di6","depends_on_id":"ch-cwy","type":"blocks","created_at":"2026-01-10T12:07:58.836384+03:00","created_by":"deligoez"},{"issue_id":"ch-di6","depends_on_id":"ch-ddk","type":"blocks","created_at":"2026-01-10T12:07:58.837878+03:00","created_by":"deligoez"},{"issue_id":"ch-di6","depends_on_id":"ch-sb7","type":"blocks","created_at":"2026-01-10T12:07:58.839363+03:00","created_by":"deligoez"},{"issue_id":"ch-di6","depends_on_id":"ch-xe8","type":"blocks","created_at":"2026-01-10T12:07:58.840874+03:00","created_by":"deligoez"},{"issue_id":"ch-di6","depends_on_id":"ch-8j3","type":"blocks","created_at":"2026-01-10T12:18:20.719693+03:00","created_by":"deligoez"}]}
{"id":"ch-dzz","title":"F13: Task Closer - Mark tasks as closed via bd CLI","description":"## What\nClose completed tasks and manage task status via bd CLI (extends BeadsCLI from F12).\n\n## Acceptance Criteria\n- [ ] `closeTask(id, comment?)` runs `bd close \u003cid\u003e`\n- [ ] `closeTask()` supports optional comment via `--comment`\n- [ ] `closeTask()` throws on bd error\n- [ ] `reopenTask(id)` changes status back to open\n- [ ] `getTaskStatus(id)` returns current status string\n- [ ] `getTaskStatus(id)` returns null for invalid task\n- [ ] `getInProgressTasks()` returns array of in_progress tasks\n- [ ] `getClosedTasks()` returns array of closed tasks\n- [ ] 8 tests pass\n\n## Files\n- src/services/BeadsCLI.ts (UPDATE - add methods)\n- tests/services/BeadsCLI.test.ts (UPDATE - add tests)\n\n## Plan\nSee: thoughts/shared/plans/features/F13-task-closer.md\n\n## Notes\n- Extends BeadsCLI from F12\n- Use `bd close` (not `bd update --status=closed`)\n- reopenTask for false completion recovery\n- Use --json flag for structured output","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:39:07.662362+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:52:17.529067+03:00","labels":["m3-task-mgmt"],"dependencies":[{"issue_id":"ch-dzz","depends_on_id":"ch-zqi","type":"blocks","created_at":"2026-01-10T01:39:40.054514+03:00","created_by":"deligoez"}]}
{"id":"ch-e7f","title":"F18b: TaskPanel Selection UI - Visual selection in TUI","description":"## What\nUpdate TaskPanel to show selection highlight, Enter key assignment, status icons.\n\n## Acceptance Criteria\n\n### Visual Selection\n- [ ] Selected task has blue background highlight\n- [ ] Arrow indicator (◀) shown on selected task\n- [ ] Shows \"Press Enter to assign\" when canAssign is true\n\n### Keyboard Handling\n- [ ] Up arrow calls selectPrevious\n- [ ] Down arrow calls selectNext\n- [ ] Enter key triggers assignSelected when canAssign\n\n### Status Display\n- [ ] Shows status icons per task (🔄 for in_progress)\n- [ ] Shows blocker count for blocked tasks\n- [ ] Shows ready/blocked counts in footer\n\n### Components\n- [ ] TaskRow component with highlight + status\n- [ ] getStatusColor() helper function\n- [ ] getStatusIcon() helper function\n\n### Summary\n- [ ] 4 tests pass\n\n## Files\n- src/components/TaskPanel.tsx (UPDATE)\n- src/components/TaskRow.tsx (NEW)\n- tests/components/TaskPanel.test.tsx (UPDATE)\n\n## Plan\nSee: thoughts/shared/plans/features/F18-task-selection-ui.md\n\n## Notes\n- Uses useInput from Ink for keyboard\n- Selection state from useTaskSelection hook","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:07:21.76659+03:00","created_by":"deligoez","updated_at":"2026-01-10T03:02:09.43101+03:00","labels":["m4-orchestration"],"dependencies":[{"issue_id":"ch-e7f","depends_on_id":"ch-9fq","type":"blocks","created_at":"2026-01-10T02:07:21.768899+03:00","created_by":"deligoez"}]}
{"id":"ch-eyd","title":"F42: Learning Injector - Inject relevant learnings into prompts","description":"## What\nInject relevant learnings into agent prompts (for non-Claude agents).\n\n## API\n```typescript\n// src/services/LearningInjector.ts\n\nclass LearningInjector {\n  constructor(private learningStore: LearningStore) {}\n\n  /**\n   * Get relevant learnings for a task based on labels/keywords\n   * @param task Task to find relevant learnings for\n   * @param limit Max number of learnings to include\n   * @returns Formatted markdown string of relevant learnings\n   */\n  async getRelevantLearnings(task: BeadsTask, limit?: number): Promise\u003cstring\u003e\n\n  /**\n   * Build prompt section with learnings\n   * @returns Markdown section \"# Relevant Learnings\\n...\"\n   */\n  async buildLearningsSection(task: BeadsTask): Promise\u003cstring\u003e\n\n  /**\n   * Check if agent needs learnings injected (non-Claude)\n   */\n  needsInjection(agentType: AgentType): boolean\n}\n```\n\n## Files\n- src/services/LearningInjector.ts\n- tests/services/LearningInjector.test.ts\n\n## Acceptance Criteria\n- [ ] `getRelevantLearnings()` returns learnings matching task labels\n- [ ] `getRelevantLearnings()` respects limit parameter\n- [ ] `getRelevantLearnings()` returns empty string if no matches\n- [ ] `buildLearningsSection()` formats as markdown section\n- [ ] `needsInjection()` returns false for 'claude'\n- [ ] `needsInjection()` returns true for 'codex', 'opencode'\n- [ ] 6 tests pass\n\n## Tests\n1. getRelevantLearnings() matches by task labels\n2. getRelevantLearnings() respects limit\n3. getRelevantLearnings() returns empty for no matches\n4. buildLearningsSection() formats correctly\n5. needsInjection() returns false for claude\n6. needsInjection() returns true for other agents","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:43:03.709956+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:43:03.709956+03:00","labels":["m8-memory"],"dependencies":[{"issue_id":"ch-eyd","depends_on_id":"ch-a6h","type":"blocks","created_at":"2026-01-10T10:43:03.711498+03:00","created_by":"deligoez"}]}
{"id":"ch-fe5","title":"F25: Merge Worker","description":"## What\nPerforms git merge operations. Dequeues from MergeQueue and attempts merge.\n\n## Acceptance Criteria\n\n### merge() - 6 tests\n- [ ] Returns `{ success: true, merged: true }` for clean merge\n- [ ] Returns `{ hasConflict: true }` when conflict detected\n- [ ] `conflictFiles` lists all files with conflicts\n- [ ] Emits 'mergeSuccess' event on success\n- [ ] Emits 'mergeConflict' event on conflict\n- [ ] Emits 'mergeError' event on git command failure\n\n### abort() - 2 tests\n- [ ] Runs `git merge --abort` successfully\n- [ ] Sets `isMerging` to false after abort\n\n### isMerging() - 1 test\n- [ ] Returns `true` while merge operation in progress\n\n### Implicit (no dedicated tests)\n- 'mergeStart' event emitted at beginning of merge()\n\n## Files\n- src/services/MergeWorker.ts\n- tests/services/MergeWorker.test.ts\n\n## Plan\nSee: thoughts/shared/plans/features/F25-merge-worker.md\n\n**Total: 9 tests**","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:16:18.292224+03:00","created_by":"deligoez","updated_at":"2026-01-10T08:19:47.981233+03:00","labels":["m5-merge"],"dependencies":[{"issue_id":"ch-fe5","depends_on_id":"ch-glf","type":"blocks","created_at":"2026-01-10T03:16:18.294889+03:00","created_by":"deligoez"}]}
{"id":"ch-fna","title":"F43b: Pause Handler - Pause and resume orchestration","description":"## What\nHandle pause/resume of orchestration - stop spawning new tasks while allowing current agents to finish.\n\n## API\n```typescript\n// src/services/PauseHandler.ts\n\nclass PauseHandler {\n  constructor(private orchestrator: Orchestrator) {}\n\n  /**\n   * Pause orchestration\n   * - Stop spawning new agents\n   * - Current agents continue to next checkpoint\n   * - Preserve all state\n   */\n  async pause(): Promise\u003cInterventionResult\u003e\n\n  /**\n   * Resume orchestration\n   * - Enable spawning new agents\n   * - Continue from paused state\n   */\n  async resume(): Promise\u003cInterventionResult\u003e\n\n  /**\n   * Check if orchestration is paused\n   */\n  isPaused(): boolean\n\n  /**\n   * Get pause duration if paused\n   */\n  getPauseDuration(): number | null\n}\n```\n\n## Files\n- src/services/PauseHandler.ts\n- tests/services/PauseHandler.test.ts\n\n## Acceptance Criteria\n- [ ] `pause()` sets paused state to true\n- [ ] `pause()` records pausedAt timestamp\n- [ ] `pause()` returns InterventionResult with success=true\n- [ ] `resume()` sets paused state to false\n- [ ] `resume()` clears pausedAt\n- [ ] `isPaused()` returns correct boolean\n- [ ] `getPauseDuration()` returns ms since pause or null\n- [ ] 7 tests pass\n\n## Tests\n1. pause() sets paused to true\n2. pause() records timestamp\n3. pause() is idempotent (double pause OK)\n4. resume() sets paused to false\n5. resume() when not paused returns success\n6. isPaused() returns correct state\n7. getPauseDuration() calculates correctly","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:43:29.087701+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:43:29.087701+03:00","labels":["m9-intervention"],"dependencies":[{"issue_id":"ch-fna","depends_on_id":"ch-ahq","type":"blocks","created_at":"2026-01-10T10:43:29.089184+03:00","created_by":"deligoez"},{"issue_id":"ch-fna","depends_on_id":"ch-0e7","type":"blocks","created_at":"2026-01-10T10:43:29.090362+03:00","created_by":"deligoez"}]}
{"id":"ch-g2h","title":"F42b: Learnings Panel - TUI component to view shared learnings","description":"## What\nTUI component to display shared learnings from .agent/learnings.md.\n\n## Keyboard\n- `L` key toggles LearningsPanel overlay\n\n## API\n```typescript\n// src/components/LearningsPanel.tsx\n\ninterface LearningsPanelProps {\n  isVisible: boolean;\n  onClose: () =\u003e void;\n}\n\nfunction LearningsPanel({ isVisible, onClose }: LearningsPanelProps): JSX.Element | null\n\n// Shows:\n// - List of learnings grouped by category\n// - Source attribution (task ID, agent, date)\n// - Category filter/navigation\n```\n\n## Files\n- src/components/LearningsPanel.tsx (NEW)\n- src/hooks/useLearningsPanel.ts (NEW)\n- tests/components/LearningsPanel.test.tsx (NEW)\n\n## Acceptance Criteria\n- [ ] Renders overlay when isVisible=true\n- [ ] Returns null when isVisible=false\n- [ ] Groups learnings by category (## headings)\n- [ ] Shows source attribution for each learning\n- [ ] Calls onClose when ESC pressed\n- [ ] Scrollable when many learnings\n- [ ] 6 tests pass\n\n## Tests\n1. Renders when isVisible=true\n2. Returns null when isVisible=false\n3. Groups learnings by category\n4. Shows source attribution\n5. ESC key calls onClose\n6. Handles empty learnings gracefully","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-10T11:46:29.619228+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:46:29.619228+03:00","labels":["m8-memory"],"dependencies":[{"issue_id":"ch-g2h","depends_on_id":"ch-a6h","type":"blocks","created_at":"2026-01-10T11:46:29.621385+03:00","created_by":"deligoez"}]}
{"id":"ch-g6z","title":"F20: useOrchestration Hook - TUI orchestration integration","description":"## What\nReact hook connecting TUI components to orchestration services and store.\n\n## Acceptance Criteria\n\n### Interface\n- [ ] UseOrchestrationResult: state + derived + actions\n- [ ] Returns 9 state properties from store\n- [ ] Returns 3 derived properties (isIdle, isRunning, canStartTask)\n- [ ] Returns 7 action functions\n\n### Initialization\n- [ ] Initializes with idle state\n- [ ] Creates services once via useMemo\n- [ ] Wires event handlers via useEffect\n- [ ] Cleans up event handlers on unmount\n\n### Actions\n- [ ] `startTask(taskId, agentType?)` starts via controller\n- [ ] `startTask` updates store status to 'assigning'\n- [ ] `startTask` sets error on failure\n- [ ] `cancelTask()` cancels and clears store\n\n### Event Handling\n- [ ] Updates store on 'taskCompleted'\n- [ ] Updates store on 'taskFailed'\n- [ ] Increments iteration on 'retry'\n\n### Derived State\n- [ ] `isIdle` = status === 'idle'\n- [ ] `canStartTask` = isIdle \u0026\u0026 mode === 'semi-auto'\n\n### Summary\n- [ ] 10 tests pass\n\n## Files\n- src/hooks/useOrchestration.ts (NEW)\n- tests/hooks/useOrchestration.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F20-use-orchestration.md\n\n## Notes\n- Similar pattern to useAgentManager\n- Autopilot actions are placeholders for M7\n- Services created once, events wired with cleanup","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:07:43.468053+03:00","created_by":"deligoez","updated_at":"2026-01-10T03:04:41.974004+03:00","labels":["m4-orchestration"],"dependencies":[{"issue_id":"ch-g6z","depends_on_id":"ch-0e7","type":"blocks","created_at":"2026-01-10T02:07:43.470457+03:00","created_by":"deligoez"},{"issue_id":"ch-g6z","depends_on_id":"ch-lhm","type":"blocks","created_at":"2026-01-10T02:07:43.47217+03:00","created_by":"deligoez"},{"issue_id":"ch-g6z","depends_on_id":"ch-7gx","type":"blocks","created_at":"2026-01-10T02:07:43.47353+03:00","created_by":"deligoez"},{"issue_id":"ch-g6z","depends_on_id":"ch-8j3","type":"blocks","created_at":"2026-01-10T02:07:43.474872+03:00","created_by":"deligoez"}]}
{"id":"ch-gk7","title":"F62b: TaskIterationDisplay Component - Show agent iteration on task","description":"## What\nComponent to display agent iteration information on a task in the task list.\n\n## Context from Master Plan\n```\n│ → ch-001 [P1] Implement auth   │\n│   ● claude | iter 7            │\n```\n\n## API\n```typescript\n// src/components/TaskIterationDisplay.tsx\n\ninterface TaskIterationDisplayProps {\n  agentType: 'claude' | 'codex' | 'opencode';\n  iteration: number;\n}\n\nfunction TaskIterationDisplay({ agentType, iteration }: TaskIterationDisplayProps): JSX.Element\n```\n\n## Visual Output\n```\n  ● claude | iter 7\n```\n\n## Files\n- src/components/TaskIterationDisplay.tsx\n- src/components/TaskIterationDisplay.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows agent type in lowercase\n- [ ] Shows iteration count with \"iter\" prefix\n- [ ] Uses pipe separator\n- [ ] Uses green dot for running indicator\n- [ ] Has proper indentation (matches task list)\n- [ ] Uses dimColor for the separator\n- [ ] 6 tests pass\n\n## Tests\n1. Shows agent type lowercase\n2. Shows \"iter X\" format\n3. Uses pipe separator\n4. Shows green dot indicator\n5. Has proper indentation\n6. Uses correct styling","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:51:47.383036+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:06:18.276085+03:00","labels":["m12-tui"]}
{"id":"ch-glf","title":"F24: Merge Queue","description":"## What\nPriority queue for pending merge operations with dependency ordering and retry tracking.\n\n## Acceptance Criteria\n\n### enqueue() - 3 tests\n- [ ] `enqueue()` adds item to queue\n- [ ] Items sorted by priority (P1 \u003e P2 \u003e P3 \u003e P4)\n- [ ] Same priority items sorted by enqueuedAt (FIFO)\n\n### dequeue() - 4 tests\n- [ ] `dequeue()` returns highest priority item\n- [ ] `dequeue()` skips items with unmerged dependencies\n- [ ] `dequeue()` returns `null` when queue empty\n- [ ] `dequeue()` sets returned item as `processing`\n\n### deferToEnd() - 2 tests\n- [ ] Moves conflicted item to end of queue\n- [ ] Increments retry count on item\n\n### markCompleted() - 1 test\n- [ ] Clears `processing`, increments `stats.completed`\n\n### markFailed() - 2 tests\n- [ ] Clears `processing`, increments `stats.failed`\n- [ ] Returns `{ needsEscalation: true }` after 3 retries\n\n### getStats() - 1 test\n- [ ] Returns accurate pending/processing/completed/failed counts\n\n### Summary\n- [ ] 13 tests pass\n\n## Merge Ordering Rules (from plan)\n1. DEPENDENCY ORDER: If B depends on A, A merges first\n2. PRIORITY BOOST: P1 \u003e P2 \u003e P3 \u003e P4\n3. FIFO within same priority\n4. CONFLICT DEFERRAL: Failed items go to end, max 3 retries\n\n## Files\n- src/services/MergeQueue.ts\n- tests/services/MergeQueue.test.ts","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:16:04.345671+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:36:36.790632+03:00","labels":["m5-merge"]}
{"id":"ch-glq","title":"F04: Worktree Create - git worktree add for isolation","description":"## What\nCreate isolated git worktrees for agent task execution.\n\n## Acceptance Criteria\n\n### create() - 6 tests\n- [ ] Runs: \\`git worktree add .worktrees/{agent}-{task} -b agent/{agent}/{task} main\\`\n- [ ] Creates .worktrees/ directory if needed\n- [ ] Copies .agent/ template into worktree\n- [ ] Template includes: empty scratchpad.md, CONVENTIONS.md with commit rules\n- [ ] Returns WorktreeInfo with path, branch, agentType, taskId\n- [ ] Throws if worktree already exists\n\n### Query Methods - 4 tests\n- [ ] \\`exists(agentType, taskId)\\` checks if worktree directory exists\n- [ ] \\`getPath(agentType, taskId)\\` returns worktree path\n- [ ] \\`getBranch(agentType, taskId)\\` returns branch name\n- [ ] \\`list()\\` returns all worktrees (via git worktree list --porcelain)\n\n### Summary\n- [ ] 10 tests pass\n\n## Files\n- src/services/WorktreeService.ts (NEW)\n- tests/services/WorktreeService.test.ts (NEW)\n\n## Interface\n\\`\\`\\`typescript\ninterface WorktreeInfo {\n  path: string;      // .worktrees/claude-ch-a1b2\n  branch: string;    // agent/claude/ch-a1b2\n  agentType: string;\n  taskId: string;\n}\n\nclass WorktreeService {\n  constructor(projectDir: string);\n  \n  async create(agentType: string, taskId: string): Promise\u003cWorktreeInfo\u003e;\n  exists(agentType: string, taskId: string): boolean;\n  getPath(agentType: string, taskId: string): string;\n  getBranch(agentType: string, taskId: string): string;\n  list(): WorktreeInfo[];\n}\n\\`\\`\\`\n\n## Worktree Setup Steps\n1. \\`git worktree add .worktrees/{agent}-{task} -b agent/{agent}/{task} main\\`\n2. Copy \\`.agent/\\` template into worktree:\n   - \\`scratchpad.md\\` - empty, for agent notes\n   - \\`CONVENTIONS.md\\` - commit rules and project conventions\n3. Ensure AGENTS.md is accessible (symlink or in git)\n\n## .agent/CONVENTIONS.md Template\n\\`\\`\\`markdown\n# Agent Conventions\n\n## Commit Messages\n\n**IMPORTANT:** Include task ID in every commit message.\n\nFormat: \\`\u003ctype\u003e: \u003cdescription\u003e [\u003ctask-id\u003e]\\`\n\nExample:\n\\`\\`\\`\nfeat: implement auth [ch-abc]\n\\`\\`\\`\n\nThis is required for task rollback to work.\n\n## Completion Signal\n\nWhen done, emit:\n\\`\\`\\`\n\u003cchorus\u003e\n  \u003cstatus\u003eCOMPLETE\u003c/status\u003e\n\u003c/chorus\u003e\n\\`\\`\\`\n\\`\\`\\`","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:31:03.217127+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:40:32.367013+03:00","labels":["m1-infrastructure"]}
{"id":"ch-hhh","title":"F60a: AgentGrid Component - Tiling grid layout for agents","description":"## What\nTiling grid layout for displaying multiple agent tiles.\n\n## Context from Master Plan\n```\n│ │ CLAUDE (ch-001)   │ CODEX (ch-002)    │  │\n│ │ iter 7/50 | 12m   │ iter 3/50 | 5m    │  │\n│ │ ▓▓▓▓░░░░░░        │ ▓▓░░░░░░░░        │  │\n│ │                   │                   │  │\n│ │ GLM (ch-003)      │ [empty slot]      │  │\n│ │ iter 1/50 | 1m    │                   │  │\n│ │ ▓░░░░░░░░░        │                   │  │\n```\n\n## API\n```typescript\n// src/components/AgentGrid.tsx\n\ninterface AgentGridProps {\n  agents: Agent[];\n  maxSlots: number;\n  selectedIndex?: number;\n  gridConfig: GridConfig;  // from useAgentGrid\n}\n\nfunction AgentGrid({ agents, maxSlots, selectedIndex, gridConfig }: AgentGridProps): JSX.Element\n```\n\n## Files\n- src/components/AgentGrid.tsx\n- src/components/AgentGrid.test.tsx\n\n## Acceptance Criteria\n- [ ] Renders agents in grid layout (rows x columns)\n- [ ] Shows EmptySlot for unused slots\n- [ ] Highlights selected agent with cyan border\n- [ ] Fills slots left-to-right, top-to-bottom\n- [ ] Respects gridConfig dimensions\n- [ ] All tiles have equal width\n- [ ] Shows correct number of empty slots\n- [ ] Grid wraps at column boundary\n- [ ] Handles zero agents (all empty slots)\n- [ ] Handles more agents than maxSlots (truncates)\n- [ ] Handles selectedIndex out of bounds\n- [ ] Scrolls vertically if more rows than visible\n- [ ] 12 tests pass\n\n## Tests\n1. Renders single agent\n2. Renders multiple agents in grid\n3. Shows EmptySlot for unused slots\n4. Highlights selected agent\n5. Fills left-to-right, top-to-bottom\n6. Respects gridConfig.columns\n7. All tiles have equal width\n8. Handles zero agents\n9. Truncates if more agents than maxSlots\n10. Handles selectedIndex out of bounds\n11. Grid wraps at column boundary\n12. Vertical scroll behavior","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:50:49.783081+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:08:13.230878+03:00","labels":["m12-tui"],"dependencies":[{"issue_id":"ch-hhh","depends_on_id":"ch-c2p","type":"blocks","created_at":"2026-01-10T12:50:49.785309+03:00","created_by":"deligoez"},{"issue_id":"ch-hhh","depends_on_id":"ch-if9","type":"blocks","created_at":"2026-01-10T12:50:49.78722+03:00","created_by":"deligoez"},{"issue_id":"ch-hhh","depends_on_id":"ch-70p","type":"blocks","created_at":"2026-01-10T12:51:52.806665+03:00","created_by":"deligoez"}]}
{"id":"ch-i9i","title":"F22: Agent Slot Manager","description":"## What\nManage available slots for parallel agent execution. Track and enforce maxParallel limits.\n\n## Acceptance Criteria\n\n### getAvailable() - 2 tests\n- [ ] `getAvailable()` returns `maxParallel` when no slots acquired\n- [ ] `getAvailable()` decreases by 1 for each acquired slot\n\n### getCapacity() / getInUse() - 2 tests\n- [ ] `getCapacity()` returns `maxParallel` (immutable)\n- [ ] `getInUse()` returns count of acquired slots\n\n### acquire() - 2 tests\n- [ ] `acquire()` returns `true` and decrements available\n- [ ] `acquire()` returns `false` when available === 0\n\n### release() - 2 tests\n- [ ] `release()` increments available count\n- [ ] `release()` throws Error when `inUse === 0`\n\n### Implicit (no dedicated tests)\n- `hasAvailable()` = `getAvailable() \u003e 0` (trivial wrapper)\n- `reset()` = sets `acquired = 0` (test/recovery utility)\n\n## Files\n- src/services/SlotManager.ts\n- tests/services/SlotManager.test.ts\n\n## Plan\nSee: thoughts/shared/plans/features/F22-slot-manager.md\n\n**Total: 8 tests**","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:16:03.109131+03:00","created_by":"deligoez","updated_at":"2026-01-10T08:13:58.790245+03:00","labels":["m6-parallelism"]}
{"id":"ch-iel","title":"F06: Worktree Query - List and get worktree info","description":"## What\nQuery worktrees and bulk operations.\n\n## Acceptance Criteria\n- [ ] getInfo() returns WorktreeInfo with head commit SHA\n- [ ] removeAll() removes all agent worktrees\n- [ ] 4 tests pass\n\n## Files\n- src/services/WorktreeService.ts (extend)\n- tests/services/WorktreeService.test.ts (extend)\n\n## API\n```typescript\nasync getInfo(agentType: string, taskId: string): Promise\u003cWorktreeInfo\u003e;\n\nasync removeAll(options?: { force?: boolean }): Promise\u003cvoid\u003e;\n```\n\n## Test Cases\n1. getInfo() returns correct WorktreeInfo with head SHA\n2. getInfo() throws if worktree not found\n3. removeAll() removes all worktrees\n4. removeAll() with force removes even dirty worktrees\n\n## Note\nThis task completes WorktreeService. Methods from F04 (create, exists, getPath, getBranch, list) and F05 (remove, isBranchMerged, prune) should already be implemented.","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:31:17.922621+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:31:20.706257+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-iel","depends_on_id":"ch-112","type":"blocks","created_at":"2026-01-10T01:31:17.924367+03:00","created_by":"deligoez"}]}
{"id":"ch-if9","title":"F59a: EmptySlot Component - Placeholder for unused agent slot","description":"## What\nPlaceholder component shown when an agent slot is unused.\n\n## Context from Master Plan\n```\n│ [empty slot]      │\n```\n\n## API\n```typescript\n// src/components/EmptySlot.tsx\n\ninterface EmptySlotProps {\n  width?: number;\n}\n\nfunction EmptySlot({ width }: EmptySlotProps): JSX.Element\n```\n\n## Visual Output\n```\n┌───────────────────┐\n│                   │\n│   [empty slot]    │\n│                   │\n└───────────────────┘\n```\n\n## Files\n- src/components/EmptySlot.tsx\n- src/components/EmptySlot.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows \"[empty slot]\" text\n- [ ] Text is centered\n- [ ] Text uses dimColor\n- [ ] Has single border style\n- [ ] Border uses gray color\n- [ ] 5 tests pass\n\n## Tests\n1. Shows \"[empty slot]\" text\n2. Text is centered\n3. Uses dimColor\n4. Has single border\n5. Respects width prop","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:49:26.136012+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:01:49.420767+03:00","labels":["m12-tui"]}
{"id":"ch-j0z","title":"F59b: AgentTileHeader - Agent type, task ID, status icon","description":"## What\nTop section of AgentTile showing agent type, task ID, and status indicator.\n\n## Context from Master Plan\n```\n│ CLAUDE (ch-001)   │\n```\n\n## API\n```typescript\n// src/components/AgentTileHeader.tsx\n\ninterface AgentTileHeaderProps {\n  agentType: 'claude' | 'codex' | 'opencode';\n  taskId: string;\n  status: 'running' | 'idle' | 'paused' | 'error';\n}\n\nfunction AgentTileHeader({ agentType, taskId, status }: AgentTileHeaderProps): JSX.Element\n```\n\n## Visual Output\n- `● CLAUDE (ch-001)` - green dot for running\n- `○ CODEX (ch-002)` - gray dot for idle\n- `⏸ OPENCODE (ch-003)` - yellow for paused\n- `✗ CLAUDE (ch-001)` - red for error\n\n## Files\n- src/components/AgentTileHeader.tsx\n- src/components/AgentTileHeader.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows agent type in UPPERCASE\n- [ ] Shows task ID in parentheses\n- [ ] Shows green ● for running status\n- [ ] Shows gray ○ for idle status\n- [ ] Shows yellow ⏸ for paused status\n- [ ] Shows red ✗ for error status\n- [ ] 6 tests pass\n\n## Tests\n1. Shows CLAUDE uppercase\n2. Shows (ch-xxx) task ID format\n3. Shows green dot for running\n4. Shows gray dot for idle\n5. Shows yellow pause for paused\n6. Shows red X for error","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:49:27.267029+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:07:38.850809+03:00","labels":["m12-tui"]}
{"id":"ch-jxp","title":"F51: Session Recovery - Recover from crash via state.json","description":"## What\nRecover Chorus state after a crash using persisted state.json.\n\n## Acceptance Criteria\n\n### needsRecovery() - 2 tests\n- [ ] Returns `true` if state.json has agents with running status\n- [ ] Returns `false` for clean/empty state\n\n### recover() - 4 tests\n- [ ] Loads persisted state from state.json\n- [ ] Kills orphan processes (checks if PID exists, kills if still running)\n- [ ] Returns crashed agent tasks to pending via `bd update --status=pending`\n- [ ] Returns RecoveryResult with restoredTasks, cleanedWorktrees, errors\n\n### resumeMergeQueue() - 2 tests\n- [ ] Re-enqueues pending items from state.mergeQueue\n- [ ] Skips items already processed\n\n### Handle Scenarios - 3 tests\n- [ ] `handleAgentCrash()` stashes worktree changes, returns task to pending\n- [ ] `handleWorktreeBroken()` removes broken worktree (force)\n- [ ] `handleOrphanedWorktree()` removes worktree not in state\n\n### Summary\n- [ ] 11 tests pass\n\n## Files\n- src/services/SessionRecovery.ts\n- tests/services/SessionRecovery.test.ts\n\n## API\n```typescript\ninterface RecoveryResult {\n  recovered: boolean;\n  restoredTasks: string[];\n  cleanedWorktrees: string[];\n  resumedMergeItems: number;\n  errors: string[];\n}\n\nclass SessionRecovery {\n  constructor(\n    private stateService: StateService,\n    private mergeService: MergeService\n  ) {}\n\n  async needsRecovery(): Promise\u003cboolean\u003e;\n  async recover(): Promise\u003cRecoveryResult\u003e;\n  async resumeMergeQueue(): Promise\u003cnumber\u003e;\n  async handleAgentCrash(agentId: string): Promise\u003cvoid\u003e;\n  async handleWorktreeBroken(worktreePath: string): Promise\u003cvoid\u003e;\n  async handleOrphanedWorktree(worktreePath: string): Promise\u003cvoid\u003e;\n}\n```\n\n## Recovery Flow (from plan)\n```typescript\nasync recover(): Promise\u003cRecoveryResult\u003e {\n  const state = await this.stateService.load();\n  \n  // 1. Kill orphan processes\n  for (const [id, agent] of Object.entries(state.agents)) {\n    if (!processExists(agent.pid)) {\n      await exec(`bd update ${agent.taskId} --status=pending`);\n      delete state.agents[id];\n    }\n  }\n  \n  // 2. Resume merge queue\n  await this.resumeMergeQueue();\n  \n  // 3. Save cleaned state\n  await this.stateService.save(state);\n  \n  return result;\n}\n```","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:45:01.661567+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:13:04.11027+03:00","labels":["m10-rollback"],"dependencies":[{"issue_id":"ch-jxp","depends_on_id":"ch-2r5","type":"blocks","created_at":"2026-01-10T10:45:01.663431+03:00","created_by":"deligoez"},{"issue_id":"ch-jxp","depends_on_id":"ch-81x","type":"blocks","created_at":"2026-01-10T10:45:01.664656+03:00","created_by":"deligoez"},{"issue_id":"ch-jxp","depends_on_id":"ch-112","type":"blocks","created_at":"2026-01-10T10:48:19.707944+03:00","created_by":"deligoez"},{"issue_id":"ch-jxp","depends_on_id":"ch-8ee","type":"blocks","created_at":"2026-01-10T11:13:15.217574+03:00","created_by":"deligoez"}]}
{"id":"ch-k3d","title":"F10: Test Runner - Run project test command","description":"## What\nRun a test command and capture result (passed/failed, output, duration).\n\n## Acceptance Criteria\n- [ ] Constructor takes projectDir and testCommand\n- [ ] `run(cwd?)` executes command via shell\n- [ ] Returns `passed: true` for exit code 0\n- [ ] Returns `passed: false` for non-zero exit code\n- [ ] Captures stdout and stderr in output\n- [ ] Tracks execution duration (ms)\n- [ ] `runWithTimeout(cwd?, timeout?)` supports timeout\n- [ ] Returns exit code 124 on timeout\n- [ ] `getCommand()` returns test command\n- [ ] 6 tests pass\n\n## Files\n- src/services/TestRunner.ts (NEW)\n- tests/services/TestRunner.test.ts (NEW)\n\n## Plan\nSee: thoughts/shared/plans/features/F10-test-runner.md\n\n## Notes\n- TestRunner is generic - receives testCommand as constructor arg\n- Caller (F15 Orchestrator) reads config and passes testCommand\n- Uses `sh -c` to run command (supports pipes)\n- Default timeout: 5 minutes (300000ms)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:38:49.692278+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:46:50.822793+03:00","labels":["m3-task-mgmt"]}
{"id":"ch-k9y","title":"F48: Checkpointer - Create and restore git tag checkpoints","description":"## What\nCreate and manage git tag checkpoints for rollback.\n\n## API\n```typescript\n// src/services/Checkpointer.ts\n\nclass Checkpointer {\n  constructor(private config: CheckpointConfig) {}\n\n  /**\n   * Create a checkpoint tag\n   * @param type Type of checkpoint\n   * @param taskId Optional task ID for pre_merge checkpoints\n   */\n  async create(type: Checkpoint['type'], taskId?: string): Promise\u003cCheckpoint\u003e\n\n  /**\n   * Restore to a checkpoint\n   * @param checkpointId Checkpoint to restore to\n   * @returns List of affected task IDs\n   */\n  async restore(checkpointId: string): Promise\u003cstring[]\u003e\n\n  /**\n   * List all checkpoints\n   */\n  async list(): Promise\u003cCheckpoint[]\u003e\n\n  /**\n   * Delete old checkpoints (keep last N)\n   */\n  async prune(keepCount: number): Promise\u003cnumber\u003e\n\n  /**\n   * Check if checkpoint should be created (based on config)\n   */\n  shouldCreate(type: Checkpoint['type']): boolean\n}\n```\n\n## Files\n- src/services/Checkpointer.ts\n- tests/services/Checkpointer.test.ts\n\n## Acceptance Criteria\n- [ ] `create()` creates git tag with format \"chorus-checkpoint-{timestamp}\"\n- [ ] `create()` stores checkpoint metadata\n- [ ] `restore()` runs git reset --hard to tag\n- [ ] `restore()` returns affected task IDs\n- [ ] `list()` returns all checkpoint objects\n- [ ] `prune()` deletes oldest checkpoints\n- [ ] `shouldCreate()` respects config settings\n- [ ] 8 tests pass\n\n## Tests\n1. create() creates git tag\n2. create() returns checkpoint object\n3. restore() resets to tag\n4. restore() returns affected tasks\n5. list() returns all checkpoints\n6. prune() deletes old checkpoints\n7. shouldCreate() returns true when enabled\n8. shouldCreate() returns false when disabled","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:44:27.200102+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:44:27.200102+03:00","labels":["m10-rollback"],"dependencies":[{"issue_id":"ch-k9y","depends_on_id":"ch-2r5","type":"blocks","created_at":"2026-01-10T10:44:27.201667+03:00","created_by":"deligoez"}]}
{"id":"ch-lhm","title":"F16b: Completion Handler - Retry and failure logic","description":"## What\nHandle retry logic, failure cases, blocked state, and agent crashes.\n\n## Acceptance Criteria\n\n### handleAgentExit() - No Signal Path - 3 tests\n- [ ] Returns failure when no completion signal\n- [ ] Returns failure when tests fail (even with signal)\n- [ ] Allows retry if iteration \u003c maxIterations\n\n### handleAgentExit() - Blocked Path - 2 tests\n- [ ] Detects BLOCKED signal from agent output\n- [ ] Sets task status to \"blocked\" via bd update\n\n### handleAgentExit() - Crash Path - 2 tests\n- [ ] Detects non-zero exit code\n- [ ] Sets task status to \"failed\", keeps worktree\n\n### handleRetry() - 3 tests\n- [ ] Emits \"retry\" event when retrying\n- [ ] Increments iteration count in agentStore\n- [ ] Respects `config.completion.maxIterations`\n\n### handleMaxReached() - 2 tests\n- [ ] Returns `{ maxReached: true }` when at limit\n- [ ] Emits \"failed\" event with taskId, iteration count\n\n### Summary\n- [ ] 12 tests pass\n\n## Files\n- src/services/CompletionHandler.ts (UPDATE)\n- tests/services/CompletionHandler.test.ts (UPDATE)\n\n## Exit Handling Matrix\n| Exit Code | Signal | Tests | Action |\n|-----------|--------|-------|--------|\n| 0 | COMPLETE | pass | → F16a success |\n| 0 | COMPLETE | fail | retry |\n| 0 | BLOCKED | - | set blocked, alert |\n| 0 | none | - | retry |\n| != 0 | - | - | set failed, keep worktree |\n\n## Notes\n- Does NOT respawn agent (Orchestrator handles retry)\n- Events allow loose coupling with Orchestrator\n- BLOCKED reason extracted from signal content","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:06:51.093896+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:32:43.773867+03:00","labels":["m4-orchestration"],"dependencies":[{"issue_id":"ch-lhm","depends_on_id":"ch-7jw","type":"blocks","created_at":"2026-01-10T02:06:51.096495+03:00","created_by":"deligoez"}]}
{"id":"ch-mdj","title":"F03b: Init Scaffold - Create directories and detect settings","description":"## What\nCreate Chorus directory structure, detect project settings, initialize Beads, and set up configuration.\n\n## Acceptance Criteria\n\n### createDirectories() - 4 tests\n- [ ] Creates .chorus/ directory\n- [ ] Creates .chorus/hooks/ directory\n- [ ] Creates .agent/ directory (with learnings.md template)\n- [ ] Creates .worktrees/ directory\n\n### detectProjectSettings() - 6 tests\n- [ ] Detects testCommand from package.json scripts.test\n- [ ] Detects testCommand from pyproject.toml (pytest)\n- [ ] Detects testCommand from go.mod (go test ./...)\n- [ ] Detects buildCommand from package.json scripts.build\n- [ ] Detects projectType: 'node' | 'python' | 'go' | 'unknown'\n- [ ] Returns defaults when no project file found\n\n### initBeads() - 2 tests\n- [ ] Calls `bd init` if .beads/ doesn't exist\n- [ ] Skips if .beads/ already exists\n\n### createAgentsMd() - 2 tests\n- [ ] Creates AGENTS.md with template if not exists\n- [ ] Skips if AGENTS.md already exists\n\n### updateGitignore() - 4 tests\n- [ ] Adds .worktrees/ to .gitignore\n- [ ] Adds .chorus/state.json to .gitignore\n- [ ] Adds .agent/scratchpad.md to .gitignore\n- [ ] Skips entries already in .gitignore\n\n### initialize() - 3 tests\n- [ ] Orchestrates all setup steps in order\n- [ ] Writes config.json via ConfigService\n- [ ] Returns InitResult with created paths and detected settings\n\n### Summary\n- [ ] 21 tests pass\n\n## Types\n```typescript\ntype ProjectType = 'node' | 'python' | 'go' | 'unknown';\n\ninterface InitOptions {\n  agents: AgentType[];\n  defaultAgent?: AgentType;\n  maxParallel?: number;\n  interactive?: boolean;\n}\n\ninterface InitResult {\n  createdPaths: string[];\n  config: ChorusConfig;\n  detectedSettings: {\n    testCommand?: string;\n    buildCommand?: string;\n    projectType: ProjectType;\n  };\n}\n```\n\n## Dependencies\n- F03a (ch-0z7) - Prerequisites check\n- F01c (ch-y43) - Config save\n\n## Files\n- src/services/InitScaffold.ts (NEW)\n- tests/services/InitScaffold.test.ts (NEW)","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T11:20:13.868585+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:23:55.410079+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-mdj","depends_on_id":"ch-0z7","type":"blocks","created_at":"2026-01-10T11:20:13.870803+03:00","created_by":"deligoez"},{"issue_id":"ch-mdj","depends_on_id":"ch-y43","type":"blocks","created_at":"2026-01-10T11:20:13.872568+03:00","created_by":"deligoez"}]}
{"id":"ch-mnd","title":"F55a: ModeIndicator Component - Display operating mode with colored dot","description":"## What\nSimple component to display the current operating mode (semi-auto/autopilot) with a colored indicator dot.\n\n## Context from Master Plan\n```\nCHORUS v2.0                      semi-auto ● 3/50              ? for help\n```\n\n## API\n```typescript\n// src/components/ModeIndicator.tsx\n\ninterface ModeIndicatorProps {\n  mode: 'semi-auto' | 'autopilot';\n}\n\nfunction ModeIndicator({ mode }: ModeIndicatorProps): JSX.Element\n```\n\n## Visual Output\n- semi-auto: `semi-auto ●` (green dot)\n- autopilot: `autopilot ●` (yellow dot)\n\n## Files\n- src/components/ModeIndicator.tsx\n- src/components/ModeIndicator.test.tsx\n\n## Acceptance Criteria\n- [ ] Renders \"semi-auto\" text when mode='semi-auto'\n- [ ] Renders \"autopilot\" text when mode='autopilot'\n- [ ] Shows green dot (●) for semi-auto mode\n- [ ] Shows yellow dot (●) for autopilot mode\n- [ ] Handles undefined mode (shows \"unknown\" with gray dot)\n- [ ] Mode text and dot have correct spacing\n- [ ] 6 tests pass\n\n## Tests\n1. Renders \"semi-auto\" text when mode='semi-auto'\n2. Renders \"autopilot\" text when mode='autopilot'\n3. Shows green dot for semi-auto\n4. Shows yellow dot for autopilot\n5. Handles undefined mode gracefully\n6. Text and dot have correct spacing","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:48:07.102964+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:00:58.247112+03:00","labels":["m12-tui"]}
{"id":"ch-mpl","title":"F08: Signal Parser - Parse \u003cchorus\u003e signals from output","description":"## What\nParse \u003cchorus\u003e signals from agent output to detect completion, blocking, and other states.\n\n## Acceptance Criteria\n- [ ] parse() returns ParseResult with first signal found\n- [ ] parseAll() returns array of all signals in output\n- [ ] hasSignal() checks for specific signal type\n- [ ] isComplete() returns true for COMPLETE signal\n- [ ] isBlocked() returns true for BLOCKED signal\n- [ ] getProgress() returns number (0-100) or null\n- [ ] getReason() extracts reason from BLOCKED/NEEDS_HELP\n- [ ] Finds signal anywhere in output (not just end)\n- [ ] 10 tests pass\n\n## Files\n- src/types/signal.ts (NEW)\n- src/services/SignalParser.ts (NEW)\n- tests/services/SignalParser.test.ts (NEW)\n\n## API\n```typescript\ntype SignalType = 'COMPLETE' | 'BLOCKED' | 'NEEDS_HELP' | 'PROGRESS' | 'RESOLVED' | 'NEEDS_HUMAN';\n\ninterface Signal {\n  type: SignalType;\n  payload: string | null;\n  raw: string;\n}\n\ninterface ParseResult {\n  signal: Signal | null;\n  hasSignal: boolean;\n}\n\nclass SignalParser {\n  parse(output: string): ParseResult;\n  parseAll(output: string): Signal[];\n  hasSignal(output: string, type: SignalType): boolean;\n  isComplete(output: string): boolean;\n  isBlocked(output: string): boolean;\n  getProgress(output: string): number | null;\n  getReason(output: string): string | null;\n}\n```\n\n## Test Cases\n1. parse() returns COMPLETE signal\n2. parse() returns BLOCKED with reason\n3. parse() returns NEEDS_HELP with question\n4. parse() returns PROGRESS with percentage\n5. parse() returns null for no signal\n6. parse() finds signal in middle of output\n7. parseAll() finds multiple signals\n8. parseAll() returns empty for no signals\n9. isComplete() returns true for COMPLETE\n10. getProgress() clamps value to 0-100","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:38:13.856983+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:34:33.427675+03:00","labels":["m2-agent-prep"]}
{"id":"ch-n6d","title":"F53: Hook Registry - Register and manage hook handlers","description":"## What\nRegistry for hook handlers - register, unregister, and list hooks per event.\n\n## API\n```typescript\n// src/services/HookRegistry.ts\n\nclass HookRegistry {\n  /**\n   * Register a hook handler for an event\n   */\n  register(handler: HookHandler): void\n\n  /**\n   * Unregister a hook handler\n   */\n  unregister(event: HookEvent, command: string): void\n\n  /**\n   * Get all handlers for an event\n   */\n  getHandlers(event: HookEvent): HookHandler[]\n\n  /**\n   * Check if event has any handlers\n   */\n  hasHandlers(event: HookEvent): boolean\n\n  /**\n   * Load handlers from .chorus/hooks/ directory\n   * Convention: filename = event name (e.g., pre-agent-start.sh)\n   * Executable files only\n   */\n  async loadFromDirectory(hooksDir: string): Promise\u003cvoid\u003e\n\n  /**\n   * Clear all handlers\n   */\n  clear(): void\n}\n```\n\n## Hook Discovery Convention\n```\n.chorus/hooks/\n├── pre-agent-start.sh      → registers for 'pre-agent-start'\n├── post-iteration.py       → registers for 'post-iteration'\n├── on-conflict.ts          → registers for 'on-conflict'\n└── custom/                 → ignored (only root-level files)\n```\n\n## Files\n- src/services/HookRegistry.ts\n- tests/services/HookRegistry.test.ts\n\n## Acceptance Criteria\n- [ ] `register()` adds handler for event\n- [ ] `register()` allows multiple handlers per event\n- [ ] `unregister()` removes specific handler\n- [ ] `getHandlers()` returns handlers for event\n- [ ] `getHandlers()` returns empty array if none\n- [ ] `hasHandlers()` returns correct boolean\n- [ ] `loadFromDirectory()` finds executable files in hooks dir\n- [ ] `loadFromDirectory()` maps filename to HookEvent\n- [ ] `loadFromDirectory()` ignores invalid event names\n- [ ] `loadFromDirectory()` ignores subdirectories\n- [ ] `clear()` removes all handlers\n- [ ] 11 tests pass\n\n## Tests\n1. register() adds handler\n2. register() allows multiple per event\n3. unregister() removes handler\n4. getHandlers() returns correct handlers\n5. getHandlers() returns empty for no handlers\n6. hasHandlers() returns true when exists\n7. loadFromDirectory() finds hook files\n8. loadFromDirectory() maps filename to event\n9. loadFromDirectory() ignores invalid names\n10. loadFromDirectory() ignores subdirs\n11. clear() removes all\n\nLabels: [m11-hooks]","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:45:28.086391+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:02:17.72218+03:00","labels":["m11-hooks"],"dependencies":[{"issue_id":"ch-n6d","depends_on_id":"ch-b5x","type":"blocks","created_at":"2026-01-10T10:45:28.087917+03:00","created_by":"deligoez"}]}
{"id":"ch-nn6","title":"F54: Hook Runner - Execute hooks and handle responses","description":"## What\nExecute hook handlers and process their JSON input/output.\n\n## API\n```typescript\n// src/services/HookRunner.ts\n\nclass HookRunner {\n  constructor(private registry: HookRegistry) {}\n\n  /**\n   * Run all handlers for an event\n   * @param event Event type\n   * @param input Input data for hooks\n   * @returns Combined result from all hooks\n   */\n  async run(event: HookEvent, input: Omit\u003cHookInput, 'event'\u003e): Promise\u003cHookOutput\u003e\n\n  /**\n   * Run a single hook handler\n   * - Sends JSON via stdin\n   * - Parses JSON from stdout\n   */\n  async runHandler(handler: HookHandler, input: HookInput): Promise\u003cHookOutput\u003e\n\n  /**\n   * Check if any hook blocked the action\n   */\n  isBlocked(outputs: HookOutput[]): boolean\n\n  /**\n   * Check if any hook signaled completion\n   */\n  isComplete(outputs: HookOutput[]): boolean\n}\n```\n\n## Files\n- src/services/HookRunner.ts\n- tests/services/HookRunner.test.ts\n\n## Acceptance Criteria\n- [ ] `run()` executes all handlers for event\n- [ ] `run()` passes HookInput as JSON via stdin\n- [ ] `run()` parses HookOutput from stdout\n- [ ] `run()` respects handler timeout\n- [ ] `runHandler()` handles process errors gracefully\n- [ ] `isBlocked()` returns true if any result is 'block'\n- [ ] `isComplete()` returns true if any result is 'complete'\n- [ ] 8 tests pass\n\n## Tests\n1. run() executes all handlers\n2. run() passes input via stdin\n3. run() parses output from stdout\n4. run() handles timeout\n5. runHandler() handles errors\n6. isBlocked() detects block result\n7. isComplete() detects complete result\n8. run() returns continue if no handlers","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:45:38.726297+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:45:38.726297+03:00","labels":["m11-hooks"],"dependencies":[{"issue_id":"ch-nn6","depends_on_id":"ch-n6d","type":"blocks","created_at":"2026-01-10T10:45:38.727874+03:00","created_by":"deligoez"}]}
{"id":"ch-nvo","title":"F57b: FooterBar Component - Bottom status line","description":"## What\nBottom status bar showing task summary stats, merge queue indicator, and help reminder.\n\n## Migration Note\n**This component replaces the bottom portion of existing StatusBar.tsx**\n- Existing: StatusBar only shows top bar (no footer)\n- New: FooterBar shows task stats + merge status + help hint\n- After implementing FooterBar, update Layout.tsx to add FooterBar at bottom\n\n## Context from Master Plan\n```\n├─────────────────────────────────────────────────────────────────────────────┤\n│ Tasks: 1 done, 3 running, 1 pending, 1 blocked | Merge: 1 queued | ? help   │\n└─────────────────────────────────────────────────────────────────────────────┘\n```\n\n## API\n```typescript\n// src/components/FooterBar.tsx\n\ninterface FooterBarProps {\n  taskStats: {\n    done: number;\n    running: number;\n    pending: number;\n    blocked: number;\n  };\n  mergeQueue: {\n    queued: number;\n    merging?: boolean;\n    conflict?: boolean;\n  };\n  showHelp?: boolean;       // default true\n}\n\nfunction FooterBar({ taskStats, mergeQueue, showHelp = true }: FooterBarProps): JSX.Element\n```\n\n## Visual Layout\n```\nTasks: 1 done, 3 running, 1 pending, 1 blocked | Merge: 1 queued | ? help\n[TaskSummaryStats]                              [MergeQueueIndicator] [help]\n```\n\n## Files\n- src/components/FooterBar.tsx\n- src/components/FooterBar.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows TaskSummaryStats on the left\n- [ ] Shows MergeQueueIndicator in the middle\n- [ ] Shows \"? help\" hint on the right (when showHelp=true)\n- [ ] Uses pipe separator between sections\n- [ ] All elements horizontally spaced correctly\n- [ ] Hides help hint when showHelp=false\n- [ ] Shows correct merge state (queued/merging/conflict)\n- [ ] Handles all zero stats gracefully\n- [ ] Fills available width\n- [ ] Has top border line\n- [ ] 10 tests pass\n\n## Tests\n1. Shows TaskSummaryStats\n2. Shows MergeQueueIndicator\n3. Shows help hint by default\n4. Hides help hint when showHelp=false\n5. Uses pipe separators\n6. Shows merging state correctly\n7. Shows conflict state correctly\n8. Handles zero stats\n9. Elements horizontally aligned\n10. Has top border","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:49:25.867317+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:04:03.407254+03:00","labels":["m12-tui"],"dependencies":[{"issue_id":"ch-nvo","depends_on_id":"ch-8w5","type":"blocks","created_at":"2026-01-10T12:49:25.869621+03:00","created_by":"deligoez"},{"issue_id":"ch-nvo","depends_on_id":"ch-105","type":"blocks","created_at":"2026-01-10T12:49:25.87148+03:00","created_by":"deligoez"}]}
{"id":"ch-ofm","title":"F50: Task Rollback - Revert all commits for a task","description":"## What\nRollback all commits associated with a task (Level 2 and Level 3 rollback).\n\n## Context from Master Plan\n\\`\\`\\`\nLevel 2: SINGLE TASK\n├── What: Undo all commits for one task\n├── How: git revert all commits with [task-id]\n└── State: Task → pending\n\nLevel 3: TASK + DEPENDENTS\n├── What: Undo task and all dependent tasks\n├── How: Identify chain, revert in order\n└── State: All affected → pending\n\\`\\`\\`\n\n## API\n\\`\\`\\`typescript\n// src/services/TaskRollback.ts\n\nclass TaskRollback {\n  constructor(private beadsCLI: BeadsCLI) {}\n\n  /**\n   * Revert all commits for a task (Level 2)\n   * Uses git revert for each commit with [task-id] in message\n   */\n  async rollback(taskId: string): Promise\u003cRollbackResult\u003e\n\n  /**\n   * Find all commits for a task\n   * Uses: git log --grep=\"[task-id]\" --format=\"%H\"\n   */\n  async findTaskCommits(taskId: string): Promise\u003cstring[]\u003e\n\n  /**\n   * Rollback task and all dependent tasks (Level 3)\n   * 1. Get dependent tasks via bd blocked-by\n   * 2. Rollback in reverse dependency order\n   */\n  async rollbackWithDependents(taskId: string): Promise\u003cRollbackResult\u003e\n}\n\\`\\`\\`\n\n## Commit Message Convention\nAgents MUST include task ID in commit messages for rollback to work:\n\\`\\`\\`\nfeat: implement user authentication [ch-abc]\n\n- Added login form\n- Added JWT validation\n\\`\\`\\`\n\nThe \\`[ch-xxx]\\` suffix is searched by \\`git log --grep\\`.\n\n## Files\n- src/services/TaskRollback.ts\n- tests/services/TaskRollback.test.ts\n\n## Acceptance Criteria\n- [ ] \\`rollback()\\` finds commits using git log --grep=\"[task-id]\"\n- [ ] \\`rollback()\\` reverts commits in reverse chronological order\n- [ ] \\`rollback()\\` returns task to pending status via beadsCLI\n- [ ] \\`rollback()\\` returns RollbackResult with revertedCommits list\n- [ ] \\`findTaskCommits()\\` returns commit hashes in order\n- [ ] \\`findTaskCommits()\\` returns empty array if no commits found\n- [ ] \\`rollbackWithDependents()\\` gets dependent tasks via bd CLI\n- [ ] \\`rollbackWithDependents()\\` reverts in correct order (dependents first)\n- [ ] \\`rollbackWithDependents()\\` returns all affected task IDs\n- [ ] 9 tests pass\n\n## Tests\n1. rollback() finds task commits\n2. rollback() reverts in correct order\n3. rollback() sets task to pending\n4. rollback() handles no commits found (returns success with empty list)\n5. findTaskCommits() returns correct commits\n6. findTaskCommits() returns empty for unknown task\n7. rollbackWithDependents() includes dependent tasks\n8. rollbackWithDependents() orders correctly (dependents first)\n9. rollbackWithDependents() sets all tasks to pending","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:44:48.050857+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:27:55.158259+03:00","labels":["m10-rollback"],"dependencies":[{"issue_id":"ch-ofm","depends_on_id":"ch-2r5","type":"blocks","created_at":"2026-01-10T10:44:48.052322+03:00","created_by":"deligoez"},{"issue_id":"ch-ofm","depends_on_id":"ch-zqi","type":"blocks","created_at":"2026-01-10T12:28:02.465646+03:00","created_by":"deligoez"}]}
{"id":"ch-r12","title":"F02d: State Persistence - Debounced save and clear","description":"## What\nPersist state to disk with debouncing.\n\n## Acceptance Criteria\n- [ ] save() writes to .chorus/state.json\n- [ ] Debounces rapid saves (100ms)\n- [ ] clear() removes state file\n- [ ] 3 tests pass\n\n## Test Cases\n1. save() creates file\n2. Multiple rapid updates debounced\n3. clear() deletes file","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:30:51.05887+03:00","created_by":"deligoez","updated_at":"2026-01-10T01:46:57.277562+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-r12","depends_on_id":"ch-ah6","type":"blocks","created_at":"2026-01-10T01:30:51.060628+03:00","created_by":"deligoez"},{"issue_id":"ch-r12","depends_on_id":"ch-81x","type":"blocks","created_at":"2026-01-10T01:37:14.840129+03:00","created_by":"deligoez"}]}
{"id":"ch-sb7","title":"F46: Task Block - Manually block task and stop agent","description":"## What\nManually mark a task as blocked, stopping any agent working on it.\n\n## Context from Master Plan\n\\`\\`\\`\n7. BLOCK TASK (b)\n   - Manually mark task as blocked\n   - Agent stops, picks different task\n\\`\\`\\`\n\n## API\n\\`\\`\\`typescript\n// src/services/TaskBlocker.ts\n\nclass TaskBlocker {\n  constructor(\n    private agentStopper: AgentStopper,\n    private beadsCLI: BeadsCLI\n  ) {}\n\n  /**\n   * Block a task manually\n   * - If agent running on task, stop it via agentStopper.stopAgentByTask()\n   * - Mark task as blocked via bd update --status=blocked\n   * - Record block reason in task notes\n   */\n  async blockTask(taskId: string, reason: string): Promise\u003cInterventionResult\u003e\n\n  /**\n   * Unblock a task\n   * - Mark task as open via bd update --status=open\n   * - Clear block reason\n   */\n  async unblockTask(taskId: string): Promise\u003cInterventionResult\u003e\n\n  /**\n   * Check if task is manually blocked\n   */\n  async isBlocked(taskId: string): Promise\u003cboolean\u003e\n}\n\\`\\`\\`\n\n## Files\n- src/services/TaskBlocker.ts\n- tests/services/TaskBlocker.test.ts\n\n## Acceptance Criteria\n- [ ] \\`blockTask()\\` calls agentStopper.stopAgentByTask() if agent running\n- [ ] \\`blockTask()\\` marks task as blocked via beadsCLI (bd update --status=blocked)\n- [ ] \\`blockTask()\\` records reason in task notes\n- [ ] \\`blockTask()\\` returns InterventionResult with stopped agent if any\n- [ ] \\`unblockTask()\\` marks task as open\n- [ ] \\`unblockTask()\\` returns success even if not blocked\n- [ ] \\`isBlocked()\\` checks task status via beadsCLI.getTask()\n- [ ] 7 tests pass\n\n## Tests\n1. blockTask() stops running agent\n2. blockTask() sets status to blocked\n3. blockTask() records reason\n4. blockTask() returns affectedAgents when agent stopped\n5. unblockTask() sets status to open\n6. unblockTask() when not blocked is OK\n7. isBlocked() returns correct state","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:44:00.289314+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:16:37.663634+03:00","labels":["m9-intervention"],"dependencies":[{"issue_id":"ch-sb7","depends_on_id":"ch-ahq","type":"blocks","created_at":"2026-01-10T10:44:00.290809+03:00","created_by":"deligoez"},{"issue_id":"ch-sb7","depends_on_id":"ch-cwy","type":"blocks","created_at":"2026-01-10T10:44:00.292179+03:00","created_by":"deligoez"},{"issue_id":"ch-sb7","depends_on_id":"ch-zqi","type":"blocks","created_at":"2026-01-10T12:16:20.871911+03:00","created_by":"deligoez"}]}
{"id":"ch-sl9","title":"F62a: BlockedTaskInfo Component - Show blocker information","description":"## What\nComponent to show blocker information for a blocked task.\n\n## Context from Master Plan\n```\n│ ⊗ ch-005 [P3] Refactor         │\n│   blocked by ch-001            │\n```\n\n## API\n```typescript\n// src/components/BlockedTaskInfo.tsx\n\ninterface BlockedTaskInfoProps {\n  blockers: Array\u003c{\n    id: string;\n    status: 'open' | 'in_progress' | 'closed';\n  }\u003e;\n}\n\nfunction BlockedTaskInfo({ blockers }: BlockedTaskInfoProps): JSX.Element\n```\n\n## Visual Output\n- Single blocker: `└─ Waiting: ch-001 (in_progress)`\n- Multiple blockers: `└─ Waiting: ch-001, ch-002`\n\n## Files\n- src/components/BlockedTaskInfo.tsx\n- src/components/BlockedTaskInfo.test.tsx\n\n## Acceptance Criteria\n- [ ] Shows \"Waiting:\" prefix\n- [ ] Shows blocker ID(s)\n- [ ] Shows blocker status in parentheses for single blocker\n- [ ] Comma-separates multiple blockers\n- [ ] Uses tree branch character (└─)\n- [ ] Uses dimColor styling\n- [ ] 6 tests pass\n\n## Tests\n1. Shows single blocker with status\n2. Shows multiple blockers comma-separated\n3. Uses \"Waiting:\" prefix\n4. Uses tree branch character\n5. Uses dimColor styling\n6. Handles empty blockers array","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:51:46.480784+03:00","created_by":"deligoez","updated_at":"2026-01-10T13:07:52.037843+03:00","labels":["m12-tui"]}
{"id":"ch-sro","title":"F01b: Config Load - Read config from .chorus/config.json","description":"## What\nLoad configuration from .chorus/config.json file.\n\n## Acceptance Criteria\n- [ ] load() reads and parses JSON file\n- [ ] Returns default config if file doesn't exist\n- [ ] Throws on invalid JSON\n- [ ] Caches loaded config\n- [ ] get() returns cached config (calls load if not cached)\n- [ ] exists() checks if config file exists\n- [ ] 5 tests pass\n\n## Files\n- src/services/ConfigService.ts (NEW - partial)\n- tests/services/ConfigService.test.ts (NEW)\n\n## Implementation\n```typescript\nexport class ConfigService {\n  private configPath: string;\n  private config: ChorusConfig | null = null;\n  \n  constructor(projectDir: string) {\n    this.configPath = path.join(projectDir, '.chorus', 'config.json');\n  }\n  \n  load(): ChorusConfig {\n    if (!fs.existsSync(this.configPath)) {\n      this.config = getDefaultConfig();\n      return this.config;\n    }\n    this.config = JSON.parse(fs.readFileSync(this.configPath, 'utf-8'));\n    return this.config;\n  }\n  \n  get(): ChorusConfig {\n    if (!this.config) return this.load();\n    return this.config;\n  }\n  \n  exists(): boolean {\n    return fs.existsSync(this.configPath);\n  }\n}\n```\n\n## Test Cases\n1. load() returns defaults when file missing\n2. load() parses existing config file\n3. load() throws on malformed JSON\n4. get() returns cached config\n5. exists() returns false when no file","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:30:22.3151+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:23:37.380881+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-sro","depends_on_id":"ch-2n6","type":"blocks","created_at":"2026-01-10T01:30:22.316939+03:00","created_by":"deligoez"}]}
{"id":"ch-t31","title":"F27: Auto-Resolver","description":"## What\nAutomatically resolve trivial conflicts: whitespace, imports, and special file types.\n\n## Acceptance Criteria\n\n### resolveWhitespace() - 2 tests\n- [ ] Resolves trailing whitespace conflicts\n- [ ] Resolves indentation-only conflicts\n\n### resolveImports() - 2 tests\n- [ ] Merges imports from both versions\n- [ ] Removes duplicate imports and sorts\n\n### resolveSpecialFile() - 4 tests\n- [ ] `.beads/issues.jsonl` → Uses Beads merge (accepts both)\n- [ ] `package-lock.json` → Regenerates via npm install\n- [ ] `.agent/learnings.md` → Appends both, deduplicates\n- [ ] Auto-generated files → Regenerates (list in config)\n\n### canResolve() - 2 tests\n- [ ] Returns `true` for trivial type conflicts\n- [ ] Returns `true` for special file types\n\n### Summary\n- [ ] 10 tests pass\n\n## Files\n- src/services/AutoResolver.ts\n- tests/services/AutoResolver.test.ts\n\n## Special Files Config\n```typescript\nconst SPECIAL_FILES = {\n  '.beads/issues.jsonl': 'beads-merge',\n  'package-lock.json': 'regenerate',\n  '.agent/learnings.md': 'append-dedup',\n};\n```","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:16:42.288688+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:36:05.172145+03:00","labels":["m5-merge"],"dependencies":[{"issue_id":"ch-t31","depends_on_id":"ch-7pb","type":"blocks","created_at":"2026-01-10T03:16:42.291207+03:00","created_by":"deligoez"}]}
{"id":"ch-tpj","title":"F02e: State Merge Queue - Manage merge queue operations","description":"## What\nManage merge queue in state for tracking branches ready to merge.\n\n## Acceptance Criteria\n- [ ] enqueueMerge(item) adds to mergeQueue array\n- [ ] dequeueMerge() returns highest priority item and removes it\n- [ ] updateMergeItem(taskId, partial) modifies existing item\n- [ ] incrementStat(key) increments SessionStats field\n- [ ] update(partial) merges partial state and triggers save\n- [ ] 5 tests pass\n\n## Files\n- src/services/StateService.ts (extend)\n- tests/services/StateService.test.ts (extend)\n\n## Implementation\n```typescript\nenqueueMerge(item: MergeQueueItem): void {\n  this.state.mergeQueue.push(item);\n  this.state.mergeQueue.sort((a, b) =\u003e b.priority - a.priority);\n  this.saveDebounced();\n}\n\ndequeueMerge(): MergeQueueItem | undefined {\n  const item = this.state.mergeQueue.shift();\n  if (item) this.saveDebounced();\n  return item;\n}\n\nupdateMergeItem(taskId: string, partial: Partial\u003cMergeQueueItem\u003e): void {\n  const item = this.state.mergeQueue.find(i =\u003e i.taskId === taskId);\n  if (item) Object.assign(item, partial);\n  this.saveDebounced();\n}\n\nincrementStat(key: keyof SessionStats): void {\n  (this.state.stats[key] as number)++;\n  this.saveDebounced();\n}\n\nupdate(partial: Partial\u003cChorusState\u003e): void {\n  Object.assign(this.state, partial);\n  this.saveDebounced();\n}\n```\n\n## Test Cases\n1. enqueueMerge adds item sorted by priority\n2. dequeueMerge returns and removes highest priority\n3. updateMergeItem modifies existing item\n4. incrementStat increases counter\n5. update merges partial state","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T02:26:18.79708+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:26:18.79708+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-tpj","depends_on_id":"ch-81x","type":"blocks","created_at":"2026-01-10T02:26:18.802044+03:00","created_by":"deligoez"},{"issue_id":"ch-tpj","depends_on_id":"ch-ah6","type":"blocks","created_at":"2026-01-10T02:26:40.031341+03:00","created_by":"deligoez"}]}
{"id":"ch-uoa","title":"F11: Completion Checker - Detect task completion (signal + tests)","description":"## What\nCheck if agent has completed task using signal detection AND test verification.\n\n## Acceptance Criteria\n- [ ] `check()` returns `complete: false` if no signal\n- [ ] `check()` returns `complete: true` if signal + tests pass\n- [ ] `check()` returns `complete: false` if signal + tests fail\n- [ ] `check()` respects `requireTests` config option (false = skip tests)\n- [ ] `check()` runs tests in worktree path\n- [ ] `hasCompletionSignal()` quick check without running tests\n- [ ] `isBlocked()` detects BLOCKED signal and extracts reason\n- [ ] `needsHelp()` detects NEEDS_HELP signal and extracts question\n- [ ] CompletionResult includes: complete, hasSignal, testsPassed, reason, testOutput\n- [ ] 9 tests pass\n\n## Files\n- src/services/CompletionChecker.ts (NEW)\n- tests/services/CompletionChecker.test.ts (NEW)\n\n## Notes\n- AND logic: signal + tests = complete\n- requireTests: true (default) = tests must pass\n- requireTests: false = skip test check, signal alone is enough\n- isBlocked/needsHelp are helpers for Orchestrator (F15)\n\n## Completion Matrix\n| Signal | Tests | requireTests | Result |\n|--------|-------|--------------|--------|\n| ✓ | ✓ | true | COMPLETE |\n| ✓ | ✗ | true | Continue |\n| ✗ | ✓ | true | Continue |\n| ✗ | ✗ | true | Continue |\n| ✓ | - | false | COMPLETE |\n| ✗ | - | false | Continue |","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:38:59.126542+03:00","created_by":"deligoez","updated_at":"2026-01-10T11:09:13.741464+03:00","labels":["m3-task-mgmt"],"dependencies":[{"issue_id":"ch-uoa","depends_on_id":"ch-mpl","type":"blocks","created_at":"2026-01-10T01:38:59.129353+03:00","created_by":"deligoez"},{"issue_id":"ch-uoa","depends_on_id":"ch-k3d","type":"blocks","created_at":"2026-01-10T01:38:59.130889+03:00","created_by":"deligoez"}]}
{"id":"ch-uxk","title":"F39a: Learning Types - Learning and Scratchpad interfaces","description":"## What\nDefine TypeScript interfaces for the memory/learning system.\n\n## API\n```typescript\n// src/types/learning.ts\n\ninterface Learning {\n  id: string;\n  content: string;\n  category: string;  // 'performance' | 'testing' | 'patterns' | 'gotchas'\n  source: {\n    taskId: string;\n    agentType: AgentType;\n    timestamp: Date;\n  };\n}\n\ninterface Scratchpad {\n  path: string;\n  content: string;\n  learningsSection: string | null;\n}\n\ninterface LearningsFile {\n  path: string;  // '.agent/learnings.md'\n  categories: Map\u003cstring, Learning[]\u003e;\n}\n```\n\n## Files\n- src/types/learning.ts\n\n## Acceptance Criteria\n- [ ] `Learning` interface has id, content, category, source fields\n- [ ] `Scratchpad` interface has path, content, learningsSection fields\n- [ ] `LearningsFile` interface has path and categories fields\n- [ ] Source includes taskId, agentType, timestamp\n- [ ] Category is union type of valid categories\n- [ ] 5 tests pass\n\n## Tests\n1. Learning interface has required fields\n2. Scratchpad interface has required fields\n3. LearningsFile interface has required fields\n4. Source type is correct\n5. Category union type works","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T10:42:22.318154+03:00","created_by":"deligoez","updated_at":"2026-01-10T10:42:22.318154+03:00","labels":["m8-memory"]}
{"id":"ch-wk8","title":"F07: Prompt Builder - Build task prompts with context","description":"## What\nBuild agent prompts with task context, acceptance criteria, commit rules, and Chorus signal protocol.\n\n## Acceptance Criteria\n\n### build() - Main Entry\n- [ ] Generates complete prompt for agent\n- [ ] Includes all sections in order: task, commit rules, completion protocol\n\n### buildTaskSection() - 2 tests\n- [ ] Generates task description from bead\n- [ ] Includes acceptance criteria\n\n### buildCommitRulesSection() - 2 tests (NEW)\n- [ ] Includes task ID requirement: \\`[ch-xxx]\\` suffix in commit messages\n- [ ] Explains format for rollback to work\n\n### buildCompletionSection() - 2 tests\n- [ ] Generates signal protocol section\n- [ ] Includes \\`\u003cchorus\u003e\\` signal format\n\n### Context Loading - 2 tests\n- [ ] \\`loadAgentsMd()\\` reads AGENTS.md if exists\n- [ ] \\`loadLearnings()\\` reads .agent/learnings.md if exists\n\n### Agent-Specific Injection - 2 tests\n- [ ] Claude: no extra injection (has project context)\n- [ ] Codex/OpenCode: includes AGENTS.md + learnings\n\n### Summary\n- [ ] 10 tests pass\n\n## Files\n- src/services/PromptBuilder.ts (NEW)\n- tests/services/PromptBuilder.test.ts (NEW)\n\n## API\n\\`\\`\\`typescript\ninterface PromptContext {\n  task: Bead;\n  agentType: 'claude' | 'codex' | 'opencode';\n  branch: string;\n  taskId: string;\n  config: ChorusConfig;\n  learnings?: string;\n}\n\nclass PromptBuilder {\n  build(context: PromptContext): string;\n  buildTaskSection(task: Bead): string;\n  buildCommitRulesSection(taskId: string): string;\n  buildCompletionSection(config: ChorusConfig): string;\n  loadAgentsMd(projectDir: string): string | null;\n  loadLearnings(projectDir: string): string | null;\n  needsContextInjection(agentType: string): boolean;\n}\n\\`\\`\\`\n\n## Commit Rules Section Template\n\\`\\`\\`markdown\n## Commit Message Rules\n\n**IMPORTANT:** Include task ID in every commit message for rollback support.\n\nFormat:\n\\`\\`\\`\n\u003ctype\u003e: \u003cdescription\u003e [\u003ctask-id\u003e]\n\n- Detail 1\n- Detail 2\n\\`\\`\\`\n\nExample:\n\\`\\`\\`\nfeat: implement user authentication [ch-abc]\n\n- Added login form\n- Added JWT validation\n\\`\\`\\`\n\nThe \\`[ch-xxx]\\` suffix is required for task rollback to work.\n\\`\\`\\`\n\n## Tests\n1. build() includes task description\n2. build() includes acceptance criteria\n3. build() includes commit rules with task ID\n4. buildCommitRulesSection() includes [ch-xxx] format\n5. build() includes completion protocol\n6. build() includes branch name\n7. needsContextInjection() returns false for claude\n8. build() injects AGENTS.md for codex\n9. build() injects learnings for non-claude\n10. buildCompletionSection() includes signal format","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:38:04.926365+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:40:03.022237+03:00","labels":["m2-agent-prep"],"dependencies":[{"issue_id":"ch-wk8","depends_on_id":"ch-2n6","type":"blocks","created_at":"2026-01-10T11:00:15.753799+03:00","created_by":"deligoez"}]}
{"id":"ch-xe8","title":"F46b: Task Editor - Handle restart after task edit","description":"## What\nHandle the \"Edit Task\" intervention - when a task is edited while an agent is working on it, restart the agent with the updated prompt.\n\n## Context from Master Plan\n\\`\\`\\`\n4. EDIT TASK (e)\n   - Modify task description/criteria\n   - If agent running: signal restart\n\\`\\`\\`\n\n## API\n\\`\\`\\`typescript\n// src/services/TaskEditor.ts\n\nclass TaskEditor {\n  constructor(\n    private agentStopper: AgentStopper,\n    private orchestrator: Orchestrator\n  ) {}\n\n  /**\n   * Notify that a task was edited\n   * - Check if agent running via agentStopper.getAgentForTask()\n   * - If agent running, stop and restart with new prompt\n   * - If no agent, just return success\n   */\n  async notifyTaskEdited(taskId: string): Promise\u003cInterventionResult\u003e\n\n  /**\n   * Edit task and restart agent if running\n   * - Stop agent if running\n   * - Open task in editor via bd edit\n   * - Wait for editor to close\n   * - Restart agent if it was running\n   */\n  async editAndRestart(taskId: string): Promise\u003cInterventionResult\u003e\n}\n\\`\\`\\`\n\n## Files\n- src/services/TaskEditor.ts\n- tests/services/TaskEditor.test.ts\n\n## Acceptance Criteria\n- [ ] \\`notifyTaskEdited()\\` checks for agent via agentStopper.getAgentForTask()\n- [ ] \\`notifyTaskEdited()\\` returns success if no agent running\n- [ ] \\`notifyTaskEdited()\\` stops agent via agentStopper.stopAgent()\n- [ ] \\`notifyTaskEdited()\\` restarts agent via orchestrator.spawnAgentForTask()\n- [ ] \\`notifyTaskEdited()\\` returns InterventionResult with affectedAgents\n- [ ] \\`editAndRestart()\\` spawns bd edit as child process\n- [ ] \\`editAndRestart()\\` waits for editor to close before restart\n- [ ] \\`editAndRestart()\\` handles no-agent case (just opens editor)\n- [ ] 8 tests pass\n\n## Tests\n1. notifyTaskEdited() with no agent returns success\n2. notifyTaskEdited() with agent stops it\n3. notifyTaskEdited() restarts agent with same task\n4. notifyTaskEdited() returns affected agent ID\n5. editAndRestart() spawns bd edit command\n6. editAndRestart() waits for process to exit\n7. editAndRestart() restarts agent after edit\n8. editAndRestart() works with no agent running","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T12:07:26.106866+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:17:18.480193+03:00","labels":["m9-intervention"],"dependencies":[{"issue_id":"ch-xe8","depends_on_id":"ch-cwy","type":"blocks","created_at":"2026-01-10T12:07:26.108815+03:00","created_by":"deligoez"},{"issue_id":"ch-xe8","depends_on_id":"ch-0e7","type":"blocks","created_at":"2026-01-10T12:08:33.027038+03:00","created_by":"deligoez"}]}
{"id":"ch-xn6","title":"F28: Rebase-Retry","description":"## What\nResolves simple conflicts by rebasing feature branch onto latest main.\n\n## Acceptance Criteria\n\n### rebase() - 3 tests\n- [ ] Successfully rebases branch onto main\n- [ ] Returns `{ success: true, rebased: true }` for clean rebase\n- [ ] Returns `{ hadConflicts: true }` when rebase has conflicts\n\n### rebaseAndRetry() - 2 tests\n- [ ] Completes rebase and returns ready state for merge retry\n- [ ] Aborts rebase and returns failure when conflicts occur\n\n### abortRebase() - 1 test\n- [ ] Runs `git rebase --abort` and resets `isRebasing` to false\n\n### Implicit (no dedicated tests)\n- `isRebasing()` - returns boolean state\n\n## Files\n- src/services/RebaseRetry.ts\n- tests/services/RebaseRetry.test.ts\n\n## Plan\nSee: thoughts/shared/plans/features/F28-rebase-retry.md\n\n**Total: 6 tests**","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T03:16:43.477781+03:00","created_by":"deligoez","updated_at":"2026-01-10T08:24:20.813139+03:00","labels":["m5-merge"],"dependencies":[{"issue_id":"ch-xn6","depends_on_id":"ch-7pb","type":"blocks","created_at":"2026-01-10T03:16:43.479618+03:00","created_by":"deligoez"}]}
{"id":"ch-y43","title":"F01c: Config Save - Write config to file with validation","description":"## What\nSave configuration to .chorus/config.json with validation.\n\n## Acceptance Criteria\n- [ ] save() writes config to file with 2-space indent\n- [ ] Creates .chorus/ directory if needed\n- [ ] update(partial) merges and saves partial config\n- [ ] validate() checks required fields\n- [ ] validate() rejects invalid mode\n- [ ] validate() rejects invalid agent config\n- [ ] validate() rejects missing required fields\n- [ ] 6 tests pass\n\n## Files\n- src/services/ConfigService.ts (extend)\n- tests/services/ConfigService.test.ts (extend)\n\n## Implementation\n```typescript\nsave(config: ChorusConfig): void {\n  const dir = path.dirname(this.configPath);\n  if (!fs.existsSync(dir)) {\n    fs.mkdirSync(dir, { recursive: true });\n  }\n  fs.writeFileSync(this.configPath, JSON.stringify(config, null, 2));\n  this.config = config;\n}\n\nupdate(partial: Partial\u003cChorusConfig\u003e): void {\n  const current = this.get();\n  const merged = { ...current, ...partial };\n  this.save(merged);\n}\n\nvalidate(config: unknown): config is ChorusConfig {\n  if (!config || typeof config !== 'object') return false;\n  const c = config as Record\u003cstring, unknown\u003e;\n  if (!c.version || !c.mode || !c.agents || !c.project || !c.completion) return false;\n  if (c.mode !== 'semi-auto' \u0026\u0026 c.mode !== 'autopilot') return false;\n  // Agent config validation...\n  return true;\n}\n```\n\n## Test Cases\n1. save() creates directory if missing\n2. save() writes formatted JSON (2-space indent)\n3. update() merges partial config\n4. validate() accepts valid config\n5. validate() rejects invalid mode\n6. validate() rejects missing required fields","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:30:30.340211+03:00","created_by":"deligoez","updated_at":"2026-01-10T02:23:38.261452+03:00","labels":["m1-infrastructure"],"dependencies":[{"issue_id":"ch-y43","depends_on_id":"ch-sro","type":"blocks","created_at":"2026-01-10T01:30:30.342251+03:00","created_by":"deligoez"}]}
{"id":"ch-zqi","title":"F12: Task Claimer - Claim tasks via bd CLI","description":"## What\nBeads CLI wrapper for task operations: claim, release, query, and create tasks.\n\n## Acceptance Criteria\n\n### claimTask() - 2 tests\n- [ ] `claimTask(id, assignee)` runs `bd update \u003cid\u003e --status=in_progress --assignee=\u003cagent\u003e`\n- [ ] `claimTask()` throws on bd error\n\n### releaseTask() - 2 tests\n- [ ] `releaseTask(id)` runs `bd update \u003cid\u003e --status=open --assignee=`\n- [ ] `releaseTask()` throws on bd error\n\n### getTask() - 3 tests\n- [ ] `getTask(id)` returns parsed task for valid ID\n- [ ] `getTask(id)` returns null for invalid ID\n- [ ] `getTask(id)` includes custom fields (model, agent, acceptance_criteria)\n\n### getReadyTasks() - 2 tests\n- [ ] `getReadyTasks()` returns array of ready tasks\n- [ ] `getReadyTasks()` returns empty array on error\n\n### createTask() - 3 tests\n- [ ] `createTask(title, options)` runs `bd create` with priority, labels, depends\n- [ ] `createTask()` supports custom fields via \\`--custom model=X\\`\n- [ ] `createTask()` returns created task ID\n\n### Utility - 2 tests\n- [ ] `isAvailable()` returns true if bd installed\n- [ ] `isInitialized()` returns true if .beads/ exists\n\n### Summary\n- [ ] 14 tests pass\n\n## Types\n\\`\\`\\`typescript\ninterface TaskOptions {\n  priority?: 1 | 2 | 3 | 4;\n  labels?: string[];\n  depends?: string[];\n  model?: string;\n  agent?: AgentType;\n  acceptanceCriteria?: string[];\n}\n\ninterface Task {\n  id: string;\n  title: string;\n  description?: string;\n  priority: number;\n  status: string;\n  labels: string[];\n  dependencies: string[];\n  custom?: {\n    model?: string;\n    agent?: string;\n    acceptance_criteria?: string[];\n  };\n}\n\\`\\`\\`\n\n## Files\n- src/services/BeadsCLI.ts (NEW)\n- tests/services/BeadsCLI.test.ts (NEW)\n\n## Notes\n- Use execa for CLI calls\n- Parse JSON output (bd show --json, bd ready --json)\n- projectDir is cwd for all bd commands","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-10T01:39:31.364679+03:00","created_by":"deligoez","updated_at":"2026-01-10T12:14:05.274733+03:00","labels":["m3-task-mgmt"]}
